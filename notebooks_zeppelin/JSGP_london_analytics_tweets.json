{"paragraphs":[{"text":"%pyspark\r\nsc.addFile(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/utils/got/\", recursive=True)\r\nimport got\r\nimport pandas as pd","user":"hduser","dateUpdated":"2019-02-02T17:04:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548964964666_-1768173587","id":"20190131-140244_122594935","dateCreated":"2019-01-31T14:02:44-0600","dateStarted":"2019-02-02T17:04:32-0600","dateFinished":"2019-02-02T17:04:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:53"},{"text":"%pyspark\n\ntweetCriteria = got.manager.TweetCriteria().setQuerySearch('#ChampionsLeague until:2014-12-31 since:2011-01-01 near:51.50009175,-0.14032122753075282 within:50km').setMaxTweets(10000)\ntweets = got.manager.TweetManager.getTweets(tweetCriteria)\n\ncolumns=[\"USER\",\"DATETIME\",\"PERMALINK\"]\ntw_df=pd.DataFrame(columns=columns)\n\nfor t in tweets:\n    tw_df.loc[tweets.index(t),\"USER\"]=t.username\n    tw_df.loc[tweets.index(t),\"PERMALINK\"]=t.permalink\n    tw_df.loc[tweets.index(t),\"DATETIME\"]=t.date","user":"hduser","dateUpdated":"2019-02-02T17:04:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548969040655_621234992","id":"20190131-151040_2133384800","dateCreated":"2019-01-31T15:10:40-0600","dateStarted":"2019-02-02T17:04:32-0600","dateFinished":"2019-02-02T17:15:57-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"text":"%pyspark\nprint (tw_df)","user":"hduser","dateUpdated":"2019-02-02T17:15:57-0600","config":{"colWidth":12,"fontSize":9,"enabled":false,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                USER                        ...                                                                  PERMALINK\n0        Sambrooks90                        ...                          https://twitter.com/Sambrooks90/status/5469669...\n1      EmmersonDavid                        ...                          https://twitter.com/EmmersonDavid/status/54634...\n2         santi20782                        ...                          https://twitter.com/santi20782/status/54492505...\n3         santi20782                        ...                          https://twitter.com/santi20782/status/54492391...\n4        radiogagger                        ...                          https://twitter.com/radiogagger/status/5448552...\n5             Doz989                        ...                          https://twitter.com/Doz989/status/544538149503...\n6             daut94                        ...                          https://twitter.com/daut94/status/544530087480...\n7        _danielcane                        ...                          https://twitter.com/_danielcane/status/5445017...\n8        remocherino                        ...                          https://twitter.com/remocherino/status/5444921...\n9       suzyquiquero                        ...                          https://twitter.com/suzyquiquero/status/544473...\n10      Fish_Furness                        ...                          https://twitter.com/Fish_Furness/status/544473...\n11      donny_harper                        ...                          https://twitter.com/donny_harper/status/544472...\n12        TomReeder1                        ...                          https://twitter.com/TomReeder1/status/54446498...\n13        amendrys77                        ...                          https://twitter.com/amendrys77/status/54446300...\n14             jjp98                        ...                          https://twitter.com/jjp98/status/5444606281661...\n15    SimpLeeArsenal                        ...                          https://twitter.com/SimpLeeArsenal/status/5444...\n16           RyanTNC                        ...                          https://twitter.com/RyanTNC/status/54445780293...\n17      RichyGotGame                        ...                          https://twitter.com/RichyGotGame/status/544456...\n18          MrBlissy                        ...                          https://twitter.com/MrBlissy/status/5444540818...\n19          DH_1991_                        ...                          https://twitter.com/DH_1991_/status/5444538424...\n20       CholoJordan                        ...                          https://twitter.com/CholoJordan/status/5444530...\n21      JonasAlderin                        ...                          https://twitter.com/JonasAlderin/status/544452...\n22         mekus2202                        ...                          https://twitter.com/mekus2202/status/544452643...\n23         Joeh_1993                        ...                          https://twitter.com/Joeh_1993/status/544452551...\n24            BAPF61                        ...                          https://twitter.com/BAPF61/status/544452096813...\n25      WillDalton01                        ...                          https://twitter.com/WillDalton01/status/544452...\n26      A_Man_Speaks                        ...                          https://twitter.com/A_Man_Speaks/status/544452...\n27     Shane_Alves88                        ...                          https://twitter.com/Shane_Alves88/status/54445...\n28           1AlexP1                        ...                          https://twitter.com/1AlexP1/status/54444954704...\n29          de9jan88                        ...                          https://twitter.com/de9jan88/status/5444481177...\n...              ...                        ...                                                                        ...\n5591        Jcerveno                        ...                          https://twitter.com/Jcerveno/status/4592087202...\n5592       MrSameer_                        ...                          https://twitter.com/MrSameer_/status/455997588...\n5593        Jcerveno                        ...                          https://twitter.com/Jcerveno/status/4559970600...\n5594       tombaters                        ...                          https://twitter.com/tombaters/status/455331259...\n5595       tombaters                        ...                          https://twitter.com/tombaters/status/455253809...\n5596       tombaters                        ...                          https://twitter.com/tombaters/status/454670579...\n5597       MrSameer_                        ...                          https://twitter.com/MrSameer_/status/453877127...\n5598         Crawtey                        ...                          https://twitter.com/Crawtey/status/45221638723...\n5599       MrSameer_                        ...                          https://twitter.com/MrSameer_/status/452209447...\n5600       MrSameer_                        ...                          https://twitter.com/MrSameer_/status/452078816...\n5601      jharcourt1                        ...                          https://twitter.com/jharcourt1/status/45182969...\n5602    _JamesKenyon                        ...                          https://twitter.com/_JamesKenyon/status/451416...\n5603       MrSameer_                        ...                          https://twitter.com/MrSameer_/status/450241052...\n5604  iDJPhotography                        ...                          https://twitter.com/iDJPhotography/status/4469...\n5605    seancalvert1                        ...                          https://twitter.com/seancalvert1/status/405239...\n5606     DrManJeremy                        ...                          https://twitter.com/DrManJeremy/status/4051747...\n5607       steve_b77                        ...                          https://twitter.com/steve_b77/status/405147552...\n5608         joewrob                        ...                          https://twitter.com/joewrob/status/40509199196...\n5609     hickstopher                        ...                          https://twitter.com/hickstopher/status/4050535...\n5610       steve_b77                        ...                          https://twitter.com/steve_b77/status/405047275...\n5611         rahim94                        ...                          https://twitter.com/rahim94/status/40504173468...\n5612       steve_b77                        ...                          https://twitter.com/steve_b77/status/405035548...\n5613         hubar20                        ...                          https://twitter.com/hubar20/status/40493653466...\n5614           Iheke                        ...                          https://twitter.com/Iheke/status/3838580433421...\n5615       1Genostar                        ...                          https://twitter.com/1Genostar/status/379605028...\n5616     SaroopChana                        ...                          https://twitter.com/SaroopChana/status/3794594...\n5617         Crawtey                        ...                          https://twitter.com/Crawtey/status/37630225550...\n5618         Crawtey                        ...                          https://twitter.com/Crawtey/status/37624800994...\n5619          bowlo7                        ...                          https://twitter.com/bowlo7/status/375970667378...\n5620     AndrewHavis                        ...                          https://twitter.com/AndrewHavis/status/3688402...\n\n[5621 rows x 3 columns]\n"}]},"apps":[],"jobName":"paragraph_1548965029142_-1592518678","id":"20190131-140349_771557437","dateCreated":"2019-01-31T14:03:49-0600","dateStarted":"2019-02-02T15:44:59-0600","dateFinished":"2019-02-02T15:49:02-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"text":"%pyspark\n#print(len(tw_df))\ntweets = spark.createDataFrame(tw_df) \n#tweets_tx = tweets.select(row_number().over(Window().orderBy(\"DATETIME\",\"USER\")).alias(\"ID\"), col(\"*\")) \n#tweets_tx.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/analytics/tweets.csv\")","user":"hduser","dateUpdated":"2019-02-02T17:15:57-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548971668073_-775818612","id":"20190131-155428_1109198266","dateCreated":"2019-01-31T15:54:28-0600","dateStarted":"2019-02-02T17:15:57-0600","dateFinished":"2019-02-02T17:15:57-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2019-02-03T16:32:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549233156692_2092307891","id":"20190203-163236_1133933005","dateCreated":"2019-02-03T16:32:36-0600","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%pyspark\ntweets_counts=tweets.withColumn(\"TIMESTAMP\",concat(date_format('DATETIME','yyyy-MM-dd'),lit(\" \"),date_format('DATETIME','HH'),lit(\":00\")))\ntweets_counts=tweets_counts.groupBy(\"TIMESTAMP\").agg(sqlFunctions.count(\"PERMALINK\").alias(\"NUM_TWEETS\")).orderBy(\"TIMESTAMP\")\ntweets_counts_tx = tweets_counts.select(row_number().over(Window().orderBy(\"TIMESTAMP\")).alias(\"ID\"), col(\"*\")) \ntweets_counts_tx.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/analytics/tweets_counts_tx.csv\")","user":"hduser","dateUpdated":"2019-02-02T17:27:38-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549142561072_1012730153","id":"20190202-152241_108580482","dateCreated":"2019-02-02T15:22:41-0600","dateStarted":"2019-02-02T17:27:38-0600","dateFinished":"2019-02-02T17:27:40-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\ntweets_counts.show()","user":"hduser","dateUpdated":"2019-02-03T16:33:57-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+----------+\n|       TIMESTAMP|NUM_TWEETS|\n+----------------+----------+\n|2011-02-13 14:00|         1|\n|2011-02-15 13:00|         1|\n|2011-02-15 15:00|         2|\n|2011-02-16 12:00|         1|\n|2011-02-16 13:00|         1|\n|2011-02-17 17:00|         1|\n|2011-02-23 13:00|         1|\n|2011-02-23 14:00|         6|\n|2011-02-23 15:00|         2|\n|2011-03-07 03:00|         1|\n|2011-03-08 01:00|         1|\n|2011-03-08 09:00|         1|\n|2011-03-08 12:00|         1|\n|2011-03-08 13:00|         1|\n|2011-03-08 14:00|         2|\n|2011-03-09 01:00|         1|\n|2011-03-09 06:00|         1|\n|2011-03-09 10:00|         1|\n|2011-03-09 11:00|         1|\n|2011-03-09 15:00|         2|\n+----------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1549154582719_1743332653","id":"20190202-184302_159974563","dateCreated":"2019-02-02T18:43:02-0600","dateStarted":"2019-02-03T16:33:57-0600","dateFinished":"2019-02-03T16:33:57-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\ntweets_counts_hour=tweets_counts.withColumn(\"DATE\",date_format('TIMESTAMP','yyyy-MM-dd'))\ntweets_counts_hour=tweets_counts_hour.groupBy(\"DATE\").agg(sqlFunctions.sum(\"NUM_TWEETS\").alias(\"NUM_TWEETS\")).orderBy(\"DATE\")\ntweets_counts_day_tx = tweets_counts_hour.select(row_number().over(Window().orderBy(\"DATE\")).alias(\"ID\"), col(\"*\")) \ntweets_counts_day_tx.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/analytics/tweets_counts_day_tx.csv\")","user":"hduser","dateUpdated":"2019-02-03T16:34:01-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549149698534_-354648729","id":"20190202-172138_305876088","dateCreated":"2019-02-02T17:21:38-0600","dateStarted":"2019-02-03T16:34:01-0600","dateFinished":"2019-02-03T16:34:04-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2019-02-02T18:44:28-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549154668079_1698986754","id":"20190202-184428_2037048019","dateCreated":"2019-02-02T18:44:28-0600","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:61"}],"name":"JSGP/london/analytics/tweets","id":"2E2GZRNHE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
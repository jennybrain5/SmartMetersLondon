{"paragraphs":[{"text":"%md\n# ![Spark Logo](https://spark.apache.org/images/spark-logo-trademark.png)\n\n# Análisis de texto con Spark: Log de un de Servidor Web\n\nEn esta práctica usaremos Apache Spark para analizar el log (o archivo de registro) de un servidor web.\n\nLos logs de servidores web, son una fuente de grandes volúmenes de datos que contienen información de gran utilidad. Las herramientas Big Data son ideales para el almacenamiento y procesamiento de esta clase de datos. Con HDFS podemos almacenar grandes volúmenes de datos de manera segura, eficiente y a bajo costo. Apache Spark nos permitirá el procesamiento de estos datos de manera eficiente y escalable. Los logs pueden provenir de múltiples fuentes, como la web, archivos, servidores, aplicaciones, contenido generado por usuarios, etc. La información generada puede ser usada para el monitoreo de servicios, mejorar la calidad de servicios, inteligencia de negocios, crear sistemas de recomendación, detección de anomalías y más.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1><img src=\"https://spark.apache.org/images/spark-logo-trademark.png\" alt=\"Spark Logo\" /></h1>\n<h1>Análisis de texto con Spark: Log de un de Servidor Web</h1>\n<p>En esta práctica usaremos Apache Spark para analizar el log (o archivo de registro) de un servidor web.</p>\n<p>Los logs de servidores web, son una fuente de grandes volúmenes de datos que contienen información de gran utilidad. Las herramientas Big Data son ideales para el almacenamiento y procesamiento de esta clase de datos. Con HDFS podemos almacenar grandes volúmenes de datos de manera segura, eficiente y a bajo costo. Apache Spark nos permitirá el procesamiento de estos datos de manera eficiente y escalable. Los logs pueden provenir de múltiples fuentes, como la web, archivos, servidores, aplicaciones, contenido generado por usuarios, etc. La información generada puede ser usada para el monitoreo de servicios, mejorar la calidad de servicios, inteligencia de negocios, crear sistemas de recomendación, detección de anomalías y más.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787609_1086302467","id":"20180709-223830_345572558","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:55"},{"text":"%md\n## Importar la librerías\n\nEn esta notebook utilizaremos PySpark. Importaremos librerías de python ([módulos](https://docs.python.org/2/tutorial/modules.html)) que usaremos durante la notebook de la manera usual, usando `import` seguido por el nombre der módulo a importar.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Importar la librerías</h2>\n<p>En esta notebook utilizaremos PySpark. Importaremos librerías de python (<a href=\"https://docs.python.org/2/tutorial/modules.html\">módulos</a>) que usaremos durante la notebook de la manera usual, usando <code>import</code> seguido por el nombre der módulo a importar.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787611_1087071965","id":"20180709-223925_911508840","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%md\nEjecuta las siguientes celdas:","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Ejecuta las siguientes celdas:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787612_1085148220","id":"20180710-212805_635944217","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%pyspark\nimport re\nimport datetime","user":"hduser","dateUpdated":"2018-08-08T10:45:27-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533570787612_1085148220","id":"20180710-121731_1169873919","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:45:27-0500","dateFinished":"2018-08-08T10:45:27-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\n# Una prueba rapida del modulo de expresiones regulares de python (re)\nm = re.search('(?<=abc)def', 'abcdef')\nm.group(0)","user":"hduser","dateUpdated":"2018-08-08T10:45:34-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'def'\n"}]},"apps":[],"jobName":"paragraph_1533570787613_1084763471","id":"20180710-121748_1140527758","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:45:34-0500","dateFinished":"2018-08-08T10:45:34-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\n# Una prueba rapida del modulo datetime de python\nprint 'Corriste esta celda el: {0}'.format(datetime.datetime.now())","user":"hduser","dateUpdated":"2018-08-08T10:45:38-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Corriste esta celda el: 2018-08-08 10:45:38.924157\n"}]},"apps":[],"jobName":"paragraph_1533570787613_1084763471","id":"20180710-121821_589478611","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:45:38-0500","dateFinished":"2018-08-08T10:45:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%md\n\n### Recordando el comando help()\n\nRecuerda que puedes usar `dir()` o `help()` para listar los atributos de cualquier objeto en python.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Recordando el comando help()</h3>\n<p>Recuerda que puedes usar <code>dir()</code> o <code>help()</code> para listar los atributos de cualquier objeto en python.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787614_1085917718","id":"20180710-121903_1472574036","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\n# el comando help para listar los atributos de la sesion de spark\nhelp(spark)\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Help on SparkSession in module pyspark.sql.session object:\n\nclass SparkSession(__builtin__.object)\n |  The entry point to programming Spark with the Dataset and DataFrame API.\n |  \n |  A SparkSession can be used create :class:`DataFrame`, register :class:`DataFrame` as\n |  tables, execute SQL over tables, cache tables, and read parquet files.\n |  To create a SparkSession, use the following builder pattern:\n |  \n |  >>> spark = SparkSession.builder \\\n |  ...     .master(\"local\") \\\n |  ...     .appName(\"Word Count\") \\\n |  ...     .config(\"spark.some.config.option\", \"some-value\") \\\n |  ...     .getOrCreate()\n |  \n |  .. autoattribute:: builder\n |     :annotation:\n |  \n |  Methods defined here:\n |  \n |  __enter__(self)\n |      Enable 'with SparkSession.builder.(...).getOrCreate() as session: app' syntax.\n |      \n |      .. versionadded:: 2.0\n |  \n |  __exit__(self, exc_type, exc_val, exc_tb)\n |      Enable 'with SparkSession.builder.(...).getOrCreate() as session: app' syntax.\n |      \n |      Specifically stop the SparkSession on exit of the with block.\n |      \n |      .. versionadded:: 2.0\n |  \n |  __init__(self, sparkContext, jsparkSession=None)\n |      Creates a new SparkSession.\n |      \n |      >>> from datetime import datetime\n |      >>> spark = SparkSession(sc)\n |      >>> allTypes = sc.parallelize([Row(i=1, s=\"string\", d=1.0, l=1,\n |      ...     b=True, list=[1, 2, 3], dict={\"s\": 0}, row=Row(a=1),\n |      ...     time=datetime(2014, 8, 1, 14, 1, 5))])\n |      >>> df = allTypes.toDF()\n |      >>> df.createOrReplaceTempView(\"allTypes\")\n |      >>> spark.sql('select i+1, d+1, not b, list[1], dict[\"s\"], time, row.a '\n |      ...            'from allTypes where b and i > 0').collect()\n |      [Row((i + CAST(1 AS BIGINT))=2, (d + CAST(1 AS DOUBLE))=2.0, (NOT b)=False, list[1]=2,             dict[s]=0, time=datetime.datetime(2014, 8, 1, 14, 1, 5), a=1)]\n |      >>> df.rdd.map(lambda x: (x.i, x.s, x.d, x.l, x.b, x.time, x.row.a, x.list)).collect()\n |      [(1, u'string', 1.0, 1, True, datetime.datetime(2014, 8, 1, 14, 1, 5), 1, [1, 2, 3])]\n |  \n |  createDataFrame(self, data, schema=None, samplingRatio=None, verifySchema=True)\n |      Creates a :class:`DataFrame` from an :class:`RDD`, a list or a :class:`pandas.DataFrame`.\n |      \n |      When ``schema`` is a list of column names, the type of each column\n |      will be inferred from ``data``.\n |      \n |      When ``schema`` is ``None``, it will try to infer the schema (column names and types)\n |      from ``data``, which should be an RDD of :class:`Row`,\n |      or :class:`namedtuple`, or :class:`dict`.\n |      \n |      When ``schema`` is :class:`pyspark.sql.types.DataType` or a datatype string, it must match\n |      the real data, or an exception will be thrown at runtime. If the given schema is not\n |      :class:`pyspark.sql.types.StructType`, it will be wrapped into a\n |      :class:`pyspark.sql.types.StructType` as its only field, and the field name will be \"value\",\n |      each record will also be wrapped into a tuple, which can be converted to row later.\n |      \n |      If schema inference is needed, ``samplingRatio`` is used to determined the ratio of\n |      rows used for schema inference. The first row will be used if ``samplingRatio`` is ``None``.\n |      \n |      :param data: an RDD of any kind of SQL data representation(e.g. row, tuple, int, boolean,\n |          etc.), or :class:`list`, or :class:`pandas.DataFrame`.\n |      :param schema: a :class:`pyspark.sql.types.DataType` or a datatype string or a list of\n |          column names, default is ``None``.  The data type string format equals to\n |          :class:`pyspark.sql.types.DataType.simpleString`, except that top level struct type can\n |          omit the ``struct<>`` and atomic types use ``typeName()`` as their format, e.g. use\n |          ``byte`` instead of ``tinyint`` for :class:`pyspark.sql.types.ByteType`. We can also use\n |          ``int`` as a short name for ``IntegerType``.\n |      :param samplingRatio: the sample ratio of rows used for inferring\n |      :param verifySchema: verify data types of every row against schema.\n |      :return: :class:`DataFrame`\n |      \n |      .. versionchanged:: 2.1\n |         Added verifySchema.\n |      \n |      .. note:: Usage with spark.sql.execution.arrow.enabled=True is experimental.\n |      \n |      >>> l = [('Alice', 1)]\n |      >>> spark.createDataFrame(l).collect()\n |      [Row(_1=u'Alice', _2=1)]\n |      >>> spark.createDataFrame(l, ['name', 'age']).collect()\n |      [Row(name=u'Alice', age=1)]\n |      \n |      >>> d = [{'name': 'Alice', 'age': 1}]\n |      >>> spark.createDataFrame(d).collect()\n |      [Row(age=1, name=u'Alice')]\n |      \n |      >>> rdd = sc.parallelize(l)\n |      >>> spark.createDataFrame(rdd).collect()\n |      [Row(_1=u'Alice', _2=1)]\n |      >>> df = spark.createDataFrame(rdd, ['name', 'age'])\n |      >>> df.collect()\n |      [Row(name=u'Alice', age=1)]\n |      \n |      >>> from pyspark.sql import Row\n |      >>> Person = Row('name', 'age')\n |      >>> person = rdd.map(lambda r: Person(*r))\n |      >>> df2 = spark.createDataFrame(person)\n |      >>> df2.collect()\n |      [Row(name=u'Alice', age=1)]\n |      \n |      >>> from pyspark.sql.types import *\n |      >>> schema = StructType([\n |      ...    StructField(\"name\", StringType(), True),\n |      ...    StructField(\"age\", IntegerType(), True)])\n |      >>> df3 = spark.createDataFrame(rdd, schema)\n |      >>> df3.collect()\n |      [Row(name=u'Alice', age=1)]\n |      \n |      >>> spark.createDataFrame(df.toPandas()).collect()  # doctest: +SKIP\n |      [Row(name=u'Alice', age=1)]\n |      >>> spark.createDataFrame(pandas.DataFrame([[1, 2]])).collect()  # doctest: +SKIP\n |      [Row(0=1, 1=2)]\n |      \n |      >>> spark.createDataFrame(rdd, \"a: string, b: int\").collect()\n |      [Row(a=u'Alice', b=1)]\n |      >>> rdd = rdd.map(lambda row: row[1])\n |      >>> spark.createDataFrame(rdd, \"int\").collect()\n |      [Row(value=1)]\n |      >>> spark.createDataFrame(rdd, \"boolean\").collect() # doctest: +IGNORE_EXCEPTION_DETAIL\n |      Traceback (most recent call last):\n |          ...\n |      Py4JJavaError: ...\n |      \n |      .. versionadded:: 2.0\n |  \n |  newSession(self)\n |      Returns a new SparkSession as new session, that has separate SQLConf,\n |      registered temporary views and UDFs, but shared SparkContext and\n |      table cache.\n |      \n |      .. versionadded:: 2.0\n |  \n |  range(self, start, end=None, step=1, numPartitions=None)\n |      Create a :class:`DataFrame` with single :class:`pyspark.sql.types.LongType` column named\n |      ``id``, containing elements in a range from ``start`` to ``end`` (exclusive) with\n |      step value ``step``.\n |      \n |      :param start: the start value\n |      :param end: the end value (exclusive)\n |      :param step: the incremental step (default: 1)\n |      :param numPartitions: the number of partitions of the DataFrame\n |      :return: :class:`DataFrame`\n |      \n |      >>> spark.range(1, 7, 2).collect()\n |      [Row(id=1), Row(id=3), Row(id=5)]\n |      \n |      If only one argument is specified, it will be used as the end value.\n |      \n |      >>> spark.range(3).collect()\n |      [Row(id=0), Row(id=1), Row(id=2)]\n |      \n |      .. versionadded:: 2.0\n |  \n |  sql(self, sqlQuery)\n |      Returns a :class:`DataFrame` representing the result of the given query.\n |      \n |      :return: :class:`DataFrame`\n |      \n |      >>> df.createOrReplaceTempView(\"table1\")\n |      >>> df2 = spark.sql(\"SELECT field1 AS f1, field2 as f2 from table1\")\n |      >>> df2.collect()\n |      [Row(f1=1, f2=u'row1'), Row(f1=2, f2=u'row2'), Row(f1=3, f2=u'row3')]\n |      \n |      .. versionadded:: 2.0\n |  \n |  stop(self)\n |      Stop the underlying :class:`SparkContext`.\n |      \n |      .. versionadded:: 2.0\n |  \n |  table(self, tableName)\n |      Returns the specified table as a :class:`DataFrame`.\n |      \n |      :return: :class:`DataFrame`\n |      \n |      >>> df.createOrReplaceTempView(\"table1\")\n |      >>> df2 = spark.table(\"table1\")\n |      >>> sorted(df.collect()) == sorted(df2.collect())\n |      True\n |      \n |      .. versionadded:: 2.0\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors defined here:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n |  \n |  catalog\n |      Interface through which the user may create, drop, alter or query underlying\n |      databases, tables, functions etc.\n |      \n |      :return: :class:`Catalog`\n |      \n |      .. versionadded:: 2.0\n |  \n |  conf\n |      Runtime configuration interface for Spark.\n |      \n |      This is the interface through which the user can get and set all Spark and Hadoop\n |      configurations that are relevant to Spark SQL. When getting the value of a config,\n |      this defaults to the value set in the underlying :class:`SparkContext`, if any.\n |      \n |      .. versionadded:: 2.0\n |  \n |  read\n |      Returns a :class:`DataFrameReader` that can be used to read data\n |      in as a :class:`DataFrame`.\n |      \n |      :return: :class:`DataFrameReader`\n |      \n |      .. versionadded:: 2.0\n |  \n |  readStream\n |      Returns a :class:`DataStreamReader` that can be used to read data streams\n |      as a streaming :class:`DataFrame`.\n |      \n |      .. note:: Evolving.\n |      \n |      :return: :class:`DataStreamReader`\n |      \n |      .. versionadded:: 2.0\n |  \n |  sparkContext\n |      Returns the underlying :class:`SparkContext`.\n |      \n |      .. versionadded:: 2.0\n |  \n |  streams\n |      Returns a :class:`StreamingQueryManager` that allows managing all the\n |      :class:`StreamingQuery` StreamingQueries active on `this` context.\n |      \n |      .. note:: Evolving.\n |      \n |      :return: :class:`StreamingQueryManager`\n |      \n |      .. versionadded:: 2.0\n |  \n |  udf\n |      Returns a :class:`UDFRegistration` for UDF registration.\n |      \n |      :return: :class:`UDFRegistration`\n |      \n |      .. versionadded:: 2.0\n |  \n |  version\n |      The version of Spark on which this application is running.\n |      \n |      .. versionadded:: 2.0\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes defined here:\n |  \n |  Builder = <class 'pyspark.sql.session.Builder'>\n |      Builder for :class:`SparkSession`.\n |  \n |  builder = <pyspark.sql.session.Builder object>\n\n"}]},"apps":[],"jobName":"paragraph_1533570787615_1085532969","id":"20180710-122035_433314987","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%md\n## Cargando, transformando y explorando los datos\n\nEl conjunto de datos que utilizaremos provienen de un servidor web del centro espacial Kennedy de la NASA. Puedes encontrar el conjunto de datos original en <http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html>. El conjunto de datos contiene todas las peticiones HTTP de un periodo de dos meses. Aquí usaremos unicamente un subconjunto que contiene peticiones de algunos días.\n\n_Nota_: _El archivo ya debe encontrarse almacenado en HDFS._","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Cargando, transformando y explorando los datos</h2>\n<p>El conjunto de datos que utilizaremos provienen de un servidor web del centro espacial Kennedy de la NASA. Puedes encontrar el conjunto de datos original en <a href=\"http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html\">http://ita.ee.lbl.gov/html/contrib/NASA-HTTP.html</a>. El conjunto de datos contiene todas las peticiones HTTP de un periodo de dos meses. Aquí usaremos unicamente un subconjunto que contiene peticiones de algunos días.</p>\n<p><em>Nota</em>: <em>El archivo ya debe encontrarse almacenado en HDFS.</em></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787615_1085532969","id":"20180710-122143_812836851","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%md\n### Cargando el archivo desde HDFS a Spark\n\nPara comenzar con nuestro análisis, debemos cargar el archivo a un DataFrame de Spark. Haremos esto usando `spark.read.text()` de Spark, que nos devolverá un DataFrame con una sola columna con nombre `value`.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/scala","editorHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Cargando el archivo desde HDFS a Spark</h3>\n<p>Para comenzar con nuestro análisis, debemos cargar el archivo a un DataFrame de Spark. Haremos esto usando <code>spark.read.text()</code> de Spark, que nos devolverá un DataFrame con una sola columna con nombre <code>value</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787616_1071297260","id":"20180710-122742_1933520813","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\nlog_file_path = \"hdfs://big0.iie.org.mx:9000/JSGP/datasets/access_log_Aug95\"\nbase_df = spark.read.text(log_file_path)\n# Visualizemos el esquema de los datos\nbase_df.printSchema()","user":"hduser","dateUpdated":"2018-08-08T10:46:00-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- value: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1533570787617_1070912511","id":"20180710-123015_1251950511","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:00-0500","dateFinished":"2018-08-08T10:46:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%md\n\nVamos a visualizar el contenido del DataFrame usando `show()`.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Vamos a visualizar el contenido del DataFrame usando <code>show()</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787617_1070912511","id":"20180710-123052_310294371","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\nbase_df.show(truncate=False)","user":"hduser","dateUpdated":"2018-08-08T10:46:08-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------------------------------------------------------------------------------------+\n|value                                                                                                                          |\n+-------------------------------------------------------------------------------------------------------------------------------+\n|in24.inetnebr.com - - [01/Aug/1995:00:00:01 -0400] \"GET /shuttle/missions/sts-68/news/sts-68-mcc-05.txt HTTP/1.0\" 200 1839     |\n|uplherc.upl.com - - [01/Aug/1995:00:00:07 -0400] \"GET / HTTP/1.0\" 304 0                                                        |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 304 0                               |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/MOSAIC-logosmall.gif HTTP/1.0\" 304 0                             |\n|uplherc.upl.com - - [01/Aug/1995:00:00:08 -0400] \"GET /images/USA-logosmall.gif HTTP/1.0\" 304 0                                |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:09 -0400] \"GET /images/launch-logo.gif HTTP/1.0\" 200 1713                   |\n|uplherc.upl.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/WORLD-logosmall.gif HTTP/1.0\" 304 0                              |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:10 -0400] \"GET /history/skylab/skylab.html HTTP/1.0\" 200 1687                      |\n|piweba4y.prodigy.com - - [01/Aug/1995:00:00:10 -0400] \"GET /images/launchmedium.gif HTTP/1.0\" 200 11853                        |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:11 -0400] \"GET /history/skylab/skylab-small.gif HTTP/1.0\" 200 9202                 |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:12 -0400] \"GET /images/ksclogosmall.gif HTTP/1.0\" 200 3635                         |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:12 -0400] \"GET /history/apollo/images/apollo-logo1.gif HTTP/1.0\" 200 1173   |\n|slppp6.intermind.net - - [01/Aug/1995:00:00:13 -0400] \"GET /history/apollo/images/apollo-logo.gif HTTP/1.0\" 200 3047           |\n|uplherc.upl.com - - [01/Aug/1995:00:00:14 -0400] \"GET /images/NASA-logosmall.gif HTTP/1.0\" 304 0                               |\n|133.43.96.45 - - [01/Aug/1995:00:00:16 -0400] \"GET /shuttle/missions/sts-69/mission-sts-69.html HTTP/1.0\" 200 10566            |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:17 -0400] \"GET / HTTP/1.0\" 200 7280                                          |\n|kgtyk4.kj.yamagata-u.ac.jp - - [01/Aug/1995:00:00:18 -0400] \"GET /images/ksclogo-medium.gif HTTP/1.0\" 200 5866                 |\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:19 -0400] \"GET /history/apollo/apollo-16/apollo-16.html HTTP/1.0\" 200 2743              |\n|ix-esc-ca2-07.ix.netcom.com - - [01/Aug/1995:00:00:19 -0400] \"GET /shuttle/resources/orbiters/discovery.html HTTP/1.0\" 200 6849|\n|d0ucr6.fnal.gov - - [01/Aug/1995:00:00:20 -0400] \"GET /history/apollo/apollo-16/apollo-16-patch-small.gif HTTP/1.0\" 200 14897  |\n+-------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787618_1072066758","id":"20180710-123049_1689363025","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:08-0500","dateFinished":"2018-08-08T10:46:08-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%md\n\n### Transformando los datos\n\nLos logs de un servidor web tienen el siguiente formato [Common Log Format](https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format). Los campos son:\n\n*remotehost rfc931 authuser [date] \"request\" status bytes*\n\n| campo         | significado                                                                |\n| ------------- | ----------------------------------------------------------------------     |\n| _remotehost_  | Remote hostname (or IP number if DNS hostname is not available).           |\n| _rfc931_      | The remote logname of the user.     |\n| _authuser_    | The username of the remote user, as authenticated by the HTTP server.      |\n| _[date]_      | The date and time of the request.                                          |\n| _\"request\"_   | The request, exactly as it came from the browser or client.                |\n| _status_      | The HTTP status code the server sent back to the client.                   |\n| _bytes_       | The number of bytes (`Content-Length`) transferred to the client.          |\n\n\nDebemos dividir cada entrada de nuestro DataFrame a columnas individuales (por campo). Usarémos la función [`regexp_extract()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.regexp_extract), que aplica una expresión regular a una columna del DataFrame para generar grupos. Usaremos una expresión regular por cada campo que buscamos extraer.\n\nNo es necesario que comprendas las expresiones regulares. Si te interesa aprender más sobre expresiones regulares, puedes visitar la [documentación de python](https://docs.python.org/2/library/re.html), la [documentación de java](https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html) o practicar visitando el siguiente sitio <html>https://regexone.com/</html>.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Transformando los datos</h3>\n<p>Los logs de un servidor web tienen el siguiente formato <a href=\"https://www.w3.org/Daemon/User/Config/Logging.html#common-logfile-format\">Common Log Format</a>. Los campos son:</p>\n<p><em>remotehost rfc931 authuser [date] &ldquo;request&rdquo; status bytes</em></p>\n<table>\n  <thead>\n    <tr>\n      <th>campo </th>\n      <th>significado </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><em>remotehost</em> </td>\n      <td>Remote hostname (or IP number if DNS hostname is not available). </td>\n    </tr>\n    <tr>\n      <td><em>rfc931</em> </td>\n      <td>The remote logname of the user. </td>\n    </tr>\n    <tr>\n      <td><em>authuser</em> </td>\n      <td>The username of the remote user, as authenticated by the HTTP server. </td>\n    </tr>\n    <tr>\n      <td><em>[date]</em> </td>\n      <td>The date and time of the request. </td>\n    </tr>\n    <tr>\n      <td><em>&ldquo;request&rdquo;</em> </td>\n      <td>The request, exactly as it came from the browser or client. </td>\n    </tr>\n    <tr>\n      <td><em>status</em> </td>\n      <td>The HTTP status code the server sent back to the client. </td>\n    </tr>\n    <tr>\n      <td><em>bytes</em> </td>\n      <td>The number of bytes (<code>Content-Length</code>) transferred to the client. </td>\n    </tr>\n  </tbody>\n</table>\n<p>Debemos dividir cada entrada de nuestro DataFrame a columnas individuales (por campo). Usarémos la función <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.regexp_extract\"><code>regexp_extract()</code></a>, que aplica una expresión regular a una columna del DataFrame para generar grupos. Usaremos una expresión regular por cada campo que buscamos extraer.</p>\n<p>No es necesario que comprendas las expresiones regulares. Si te interesa aprender más sobre expresiones regulares, puedes visitar la <a href=\"https://docs.python.org/2/library/re.html\">documentación de python</a>, la <a href=\"https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html\">documentación de java</a> o practicar visitando el siguiente sitio <html><a href=\"https://regexone.com/\">https://regexone.com/</a></html>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787618_1072066758","id":"20180710-123538_1287688997","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%pyspark\nfrom pyspark.sql.functions import split, regexp_extract\n\nsplit_df = base_df.select(regexp_extract('value', r'^([^\\s]+\\s)', 1).alias('host'),\n                          regexp_extract('value', r'^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]', 1).alias('timestamp'),\n                          regexp_extract('value', r'^.*\"\\w+\\s+([^\\s]+)\\s+HTTP.*\"', 1).alias('path'),\n                          regexp_extract('value', r'^.*\"\\s+([^\\s]+)', 1).cast('integer').alias('status'),\n                          regexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size'))\nsplit_df.show(truncate=False)\n","user":"hduser","dateUpdated":"2018-08-08T10:46:14-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|host                        |timestamp                 |path                                               |status|content_size|\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\n|in24.inetnebr.com           |01/Aug/1995:00:00:01 -0400|/shuttle/missions/sts-68/news/sts-68-mcc-05.txt    |200   |1839        |\n|uplherc.upl.com             |01/Aug/1995:00:00:07 -0400|/                                                  |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/ksclogo-medium.gif                         |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/MOSAIC-logosmall.gif                       |304   |0           |\n|uplherc.upl.com             |01/Aug/1995:00:00:08 -0400|/images/USA-logosmall.gif                          |304   |0           |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:09 -0400|/images/launch-logo.gif                            |200   |1713        |\n|uplherc.upl.com             |01/Aug/1995:00:00:10 -0400|/images/WORLD-logosmall.gif                        |304   |0           |\n|slppp6.intermind.net        |01/Aug/1995:00:00:10 -0400|/history/skylab/skylab.html                        |200   |1687        |\n|piweba4y.prodigy.com        |01/Aug/1995:00:00:10 -0400|/images/launchmedium.gif                           |200   |11853       |\n|slppp6.intermind.net        |01/Aug/1995:00:00:11 -0400|/history/skylab/skylab-small.gif                   |200   |9202        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:12 -0400|/images/ksclogosmall.gif                           |200   |3635        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:12 -0400|/history/apollo/images/apollo-logo1.gif            |200   |1173        |\n|slppp6.intermind.net        |01/Aug/1995:00:00:13 -0400|/history/apollo/images/apollo-logo.gif             |200   |3047        |\n|uplherc.upl.com             |01/Aug/1995:00:00:14 -0400|/images/NASA-logosmall.gif                         |304   |0           |\n|133.43.96.45                |01/Aug/1995:00:00:16 -0400|/shuttle/missions/sts-69/mission-sts-69.html       |200   |10566       |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:17 -0400|/                                                  |200   |7280        |\n|kgtyk4.kj.yamagata-u.ac.jp  |01/Aug/1995:00:00:18 -0400|/images/ksclogo-medium.gif                         |200   |5866        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:19 -0400|/history/apollo/apollo-16/apollo-16.html           |200   |2743        |\n|ix-esc-ca2-07.ix.netcom.com |01/Aug/1995:00:00:19 -0400|/shuttle/resources/orbiters/discovery.html         |200   |6849        |\n|d0ucr6.fnal.gov             |01/Aug/1995:00:00:20 -0400|/history/apollo/apollo-16/apollo-16-patch-small.gif|200   |14897       |\n+----------------------------+--------------------------+---------------------------------------------------+------+------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787619_1071682009","id":"20180710-124517_30210298","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:14-0500","dateFinished":"2018-08-08T10:46:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%md\n### Limpiando los datos\n\nObservemos como funcionó la extracción de los datos. Primero, verifiquemos que no tenemos datos faltantes (`null`), en el DataFrame.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533570787620_1069758264","id":"20180710-125243_95224848","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%pyspark\n# Verificando que no hay entradas null en el archivo original\nbase_df.filter(base_df['value'].isNull()).count()\n","user":"hduser","dateUpdated":"2018-08-08T10:46:19-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0\n"}]},"apps":[],"jobName":"paragraph_1533570787620_1069758264","id":"20180710-125608_2024107413","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:19-0500","dateFinished":"2018-08-08T10:46:20-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%md\nAhora, si nuestra función de extracción funciona como lo esperamos, no deberá de haber entradas nulas en ninguna columna.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Ahora, si nuestra función de extracción funciona como lo esperamos, no deberá de haber entradas nulas en ninguna columna.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787621_1069373515","id":"20180710-125821_609644105","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"text":"%pyspark\n# Contemos entradas null en todas las columnas\nbad_rows_df = split_df.filter(split_df['host'].isNull() |\n                            split_df['timestamp'].isNull() |\n                            split_df['path'].isNull() |\n                            split_df['status'].isNull() |\n                            split_df['content_size'].isNull())\nbad_rows_df.count()\n","user":"hduser","dateUpdated":"2018-08-08T10:46:22-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"14178\n"}]},"apps":[],"jobName":"paragraph_1533570787621_1069373515","id":"20180710-125921_1152595244","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:22-0500","dateFinished":"2018-08-08T10:46:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%md\nEl conteo nos indica que sí tenemos entradas con valores nulos. Usemos una función para verificar las columnas que los contienen.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>El conteo nos indica que sí tenemos entradas con valores nulos. Usemos una función para verificar las columnas que los contienen.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787622_1070527762","id":"20180710-130100_939839637","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"text":"%pyspark\nfrom pyspark.sql.functions import col, sum\n\ndef count_null(col_name):\n    return sum(col(col_name).isNull().cast('integer')).alias(col_name)\n\n# Contruir una lista de expresiones de columnas, una por cada columna\nexprs = []\nfor col_name in split_df.columns:\n    exprs.append(count_null(col_name))\n\n# Ejecutemos la funcion de agregacion.\n# *exprs convierte la lista de expresiones a argumentos de la funcion\nsplit_df.agg(*exprs).show()\n","user":"hduser","dateUpdated":"2018-08-08T10:46:26-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|       14178|\n+----+---------+----+------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1533570787622_1070527762","id":"20180710-130212_1720946246","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:26-0500","dateFinished":"2018-08-08T10:46:27-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%md\n\nPodemos observar que todos lo valores nulos en nuestro DataFrame se encuentran en la columna `content_size`. Veamos dónde está el error.\n\nLa expresión regular que utilizamos para la columna fue:\n\n```\nregexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size')\n```\n\nLa expresión `(\\d+)$`, selecciona uno o más dígitos al final del texto. ¿Es posible que tengamos líneas sin un `content_size` válido?, ¿hay algo mal con la expresión?\n\nExploremos los datos para identificar si existen entradas que no terminan en uno o más dígitos.\n\n_Nota: En la expresión de la siguiente celda, el simbolo \"`~`\" indica negación._\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Podemos observar que todos lo valores nulos en nuestro DataFrame se encuentran en la columna <code>content_size</code>. Veamos dónde está el error.</p>\n<p>La expresión regular que utilizamos para la columna fue:</p>\n<pre><code>regexp_extract(&#39;value&#39;, r&#39;^.*\\s+(\\d+)$&#39;, 1).cast(&#39;integer&#39;).alias(&#39;content_size&#39;)\n</code></pre>\n<p>La expresión <code>(\\d+)$</code>, selecciona uno o más dígitos al final del texto. ¿Es posible que tengamos líneas sin un <code>content_size</code> válido?, ¿hay algo mal con la expresión?</p>\n<p>Exploremos los datos para identificar si existen entradas que no terminan en uno o más dígitos.</p>\n<p><em>Nota: En la expresión de la siguiente celda, el simbolo &ldquo;<code>~</code>&rdquo; indica negación.</em></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787623_1070143013","id":"20180710-130502_1959235882","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"%pyspark\nbad_content_size_df = base_df.filter(~ base_df['value'].rlike(r'\\d+$'))\nbad_content_size_df.count()","user":"hduser","dateUpdated":"2018-08-08T10:46:32-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"14178\n"}]},"apps":[],"jobName":"paragraph_1533570787624_1068219269","id":"20180710-130953_756490665","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:32-0500","dateFinished":"2018-08-08T10:46:33-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%md\n\nPodemos observar que `bad_content_size_df.count()` y `bad_rows_df.count()` nos regresan el mismo resultado!\n\nEso significa que nuestra expresión regular falla en detectar algunos campos. Es posible que algunas entradas tengan espacios al final del texto. Observemos algunas entradas con errores concatenandoles el carácter `*` para facilitar la visualización de espacios.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Podemos observar que <code>bad_content_size_df.count()</code> y <code>bad_rows_df.count()</code> nos regresan el mismo resultado!</p>\n<p>Eso significa que nuestra expresión regular falla en detectar algunos campos. Es posible que algunas entradas tengan espacios al final del texto. Observemos algunas entradas con errores concatenandoles el carácter <code>*</code> para facilitar la visualización de espacios.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787624_1068219269","id":"20180710-131013_448671440","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"%pyspark\nfrom pyspark.sql.functions import lit, concat\n\nbad_content_size_df.select(concat(bad_content_size_df['value'], lit('*'))).show(truncate=False)","user":"hduser","dateUpdated":"2018-08-08T10:46:37-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------------------------------------------------------------------------------------------------------+\n|concat(value, *)                                                                                                            |\n+----------------------------------------------------------------------------------------------------------------------------+\n|gw1.att.com - - [01/Aug/1995:00:03:53 -0400] \"GET /shuttle/missions/sts-73/news HTTP/1.0\" 302 -*                            |\n|js002.cc.utsunomiya-u.ac.jp - - [01/Aug/1995:00:07:33 -0400] \"GET /shuttle/resources/orbiters/discovery.gif HTTP/1.0\" 404 -*|\n|tia1.eskimo.com - - [01/Aug/1995:00:28:41 -0400] \"GET /pub/winvn/release.txt HTTP/1.0\" 404 -*                               |\n|itws.info.eng.niigata-u.ac.jp - - [01/Aug/1995:00:38:01 -0400] \"GET /ksc.html/facts/about_ksc.html HTTP/1.0\" 403 -*         |\n|grimnet23.idirect.com - - [01/Aug/1995:00:50:12 -0400] \"GET /www/software/winvn/winvn.html HTTP/1.0\" 404 -*                 |\n|miriworld.its.unimelb.edu.au - - [01/Aug/1995:01:04:54 -0400] \"GET /history/history.htm HTTP/1.0\" 404 -*                    |\n|ras38.srv.net - - [01/Aug/1995:01:05:14 -0400] \"GET /elv/DELTA/uncons.htm HTTP/1.0\" 404 -*                                  |\n|cs1-06.leh.ptd.net - - [01/Aug/1995:01:17:38 -0400] \"GET /sts-71/launch/\" 404 -*                                            |\n|www-b2.proxy.aol.com - - [01/Aug/1995:01:22:07 -0400] \"GET /shuttle/countdown HTTP/1.0\" 302 -*                              |\n|maui56.maui.net - - [01/Aug/1995:01:31:56 -0400] \"GET /shuttle HTTP/1.0\" 302 -*                                             |\n|dialip-24.athenet.net - - [01/Aug/1995:01:33:02 -0400] \"GET /history/apollo/apollo-13.html HTTP/1.0\" 404 -*                 |\n|h96-158.ccnet.com - - [01/Aug/1995:01:35:50 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -*        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:23 -0400] \"GET /history/apollo/a-001/movies/ HTTP/1.0\" 404 -*                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:30 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -*        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:38 -0400] \"GET /history/apollo/a-001/movies/ HTTP/1.0\" 404 -*                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:42 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -*        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:44 -0400] \"GET /history/apollo/a-001/images/ HTTP/1.0\" 404 -*                      |\n|h96-158.ccnet.com - - [01/Aug/1995:01:36:47 -0400] \"GET /history/apollo/a-001/a-001-patch-small.gif HTTP/1.0\" 404 -*        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:37:04 -0400] \"GET /history/apollo/a-004/a-004-patch-small.gif HTTP/1.0\" 404 -*        |\n|h96-158.ccnet.com - - [01/Aug/1995:01:37:05 -0400] \"GET /history/apollo/a-004/movies/ HTTP/1.0\" 404 -*                      |\n+----------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787625_1067834520","id":"20180710-133636_414784949","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:38-0500","dateFinished":"2018-08-08T10:46:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"%md\nLas entradas con errores corresponden a entradas donde se generó un error por parte del servidor y no devolvió contenido, así que el campo `content_size` tiene un carácter \"`-`\" asignado. \n\nNo queremos eliminar tales entradas de nuestro análisis, así que rellenaremos esos espacio con el dígito `0`.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Las entradas con errores corresponden a entradas donde se generó un error por parte del servidor y no devolvió contenido, así que el campo <code>content_size</code> tiene un carácter &ldquo;<code>-</code>&rdquo; asignado. </p>\n<p>No queremos eliminar tales entradas de nuestro análisis, así que rellenaremos esos espacio con el dígito <code>0</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787625_1067834520","id":"20180710-133711_161929459","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%md\n\n### Arreglando entradas con valores nulos\n\nLa solución más sencilla será rellenar entradas nulas en `split_df` con el número `0`.\n\nSparkSQL provee funciones para tratar con valores nulos en DataFrames, algunas de éstas son:\n\n* [`fillna()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.fillna), rellena entradas nulas con un valor no nulo.\n* [`na`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.na), devuelve un objeto [DataFrameNaFunctions](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrameNaFunctions) al que le puedes aplicar distintas funciones para trabajar con valores nulos.\n\nPara nuestro caso, utilizaremos la función `fillna()`. Pasaremos como argumentos de la función un diccionario de python `{nombre_columna, valor}` para especificar la columna donde reemplazaremos valores nulos y el valor con el que reemplazaremos.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Arreglando entradas con valores nulos</h3>\n<p>La solución más sencilla será rellenar entradas nulas en <code>split_df</code> con el número <code>0</code>.</p>\n<p>SparkSQL provee funciones para tratar con valores nulos en DataFrames, algunas de éstas son:</p>\n<ul>\n  <li><a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.fillna\"><code>fillna()</code></a>, rellena entradas nulas con un valor no nulo.</li>\n  <li><a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.na\"><code>na</code></a>, devuelve un objeto <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrameNaFunctions\">DataFrameNaFunctions</a> al que le puedes aplicar distintas funciones para trabajar con valores nulos.</li>\n</ul>\n<p>Para nuestro caso, utilizaremos la función <code>fillna()</code>. Pasaremos como argumentos de la función un diccionario de python <code>{nombre_columna, valor}</code> para especificar la columna donde reemplazaremos valores nulos y el valor con el que reemplazaremos.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787626_1068988767","id":"20180710-133945_1904779557","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"%pyspark\n# Reemplaza todos los nulos en content_size con el valor 0\ncleaned_df = split_df.na.fill({'content_size': 0})","user":"hduser","dateUpdated":"2018-08-08T10:46:50-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533570787627_1068604018","id":"20180710-134532_1145831314","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:51-0500","dateFinished":"2018-08-08T10:46:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"%pyspark\n# Veamos que no hay mas valores nulos\nexprs = []\nfor col_name in cleaned_df.columns:\n    exprs.append(count_null(col_name))\n\ncleaned_df.agg(*exprs).show()","user":"hduser","dateUpdated":"2018-08-08T10:46:53-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|           0|\n+----+---------+----+------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1533570787627_1068604018","id":"20180710-134711_478213548","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:53-0500","dateFinished":"2018-08-08T10:46:54-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83"},{"text":"%md\n\n### Transformando el formato de fechas\n\nYa que tenemos un DataFrame con nuestros datos dividos en columnas sin valores nulos, procederemos a transformar el campo `timestamp` a un formato de fecha que podamos utilizar con PySpark.\n\nUsáremos una función definida por el usuario (UDF) para llevar a cabo la transformación.\n\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Transformando el formato de fechas</h3>\n<p>Ya que tenemos un DataFrame con nuestros datos dividos en columnas sin valores nulos, procederemos a transformar el campo <code>timestamp</code> a un formato de fecha que podamos utilizar con PySpark.</p>\n<p>Usáremos una función definida por el usuario (UDF) para llevar a cabo la transformación.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787628_1066680273","id":"20180710-134748_400522037","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf\n\nmonth_map = {\n  'Jan': 1, 'Feb': 2, 'Mar':3, 'Apr':4, 'May':5, 'Jun':6, 'Jul':7,\n  'Aug':8,  'Sep': 9, 'Oct':10, 'Nov': 11, 'Dec': 12\n}\n\ndef parse_clf_time(s):\n    \"\"\" Convierte el formato de tiempo de un Log a un objeto datetime de python\n    Args:\n        s (str): Fecha y tiempo en formato del servidor Apache [dd/mmm/yyyy:hh:mm:ss (+/-)zzzz]\n    Returns:\n        una cadena que pueda ser usada por la funcion CAST\n    \"\"\"\n    return \"{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}\".format(\n      int(s[7:11]),\n      month_map[s[3:6]],\n      int(s[0:2]),\n      int(s[12:14]),\n      int(s[15:17]),\n      int(s[18:20])\n    )\n\nu_parse_time = udf(parse_clf_time)\n\nlogs_df = cleaned_df.select('*', u_parse_time(cleaned_df['timestamp']).cast('timestamp').alias('time')).drop('timestamp')\ntotal_log_entries = logs_df.count()\nprint total_log_entries\n","user":"hduser","dateUpdated":"2018-08-08T10:46:58-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1569898\n"}]},"apps":[],"jobName":"paragraph_1533570787628_1066680273","id":"20180710-135106_1370565723","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:46:58-0500","dateFinished":"2018-08-08T10:46:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"text":"%pyspark\nlogs_df.printSchema()","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- host: string (nullable = true)\n |-- path: string (nullable = true)\n |-- status: integer (nullable = true)\n |-- content_size: integer (nullable = false)\n |-- time: timestamp (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1533570787629_1066295524","id":"20180710-135405_261339801","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"%pyspark\nlogs_df.show()","user":"hduser","dateUpdated":"2018-08-08T10:47:01-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+------+------------+--------------------+\n|                host|                path|status|content_size|                time|\n+--------------------+--------------------+------+------------+--------------------+\n|  in24.inetnebr.com |/shuttle/missions...|   200|        1839|1995-08-01 00:00:...|\n|    uplherc.upl.com |                   /|   304|           0|1995-08-01 00:00:...|\n|    uplherc.upl.com |/images/ksclogo-m...|   304|           0|1995-08-01 00:00:...|\n|    uplherc.upl.com |/images/MOSAIC-lo...|   304|           0|1995-08-01 00:00:...|\n|    uplherc.upl.com |/images/USA-logos...|   304|           0|1995-08-01 00:00:...|\n|ix-esc-ca2-07.ix....|/images/launch-lo...|   200|        1713|1995-08-01 00:00:...|\n|    uplherc.upl.com |/images/WORLD-log...|   304|           0|1995-08-01 00:00:...|\n|slppp6.intermind....|/history/skylab/s...|   200|        1687|1995-08-01 00:00:...|\n|piweba4y.prodigy....|/images/launchmed...|   200|       11853|1995-08-01 00:00:...|\n|slppp6.intermind....|/history/skylab/s...|   200|        9202|1995-08-01 00:00:...|\n|slppp6.intermind....|/images/ksclogosm...|   200|        3635|1995-08-01 00:00:...|\n|ix-esc-ca2-07.ix....|/history/apollo/i...|   200|        1173|1995-08-01 00:00:...|\n|slppp6.intermind....|/history/apollo/i...|   200|        3047|1995-08-01 00:00:...|\n|    uplherc.upl.com |/images/NASA-logo...|   304|           0|1995-08-01 00:00:...|\n|       133.43.96.45 |/shuttle/missions...|   200|       10566|1995-08-01 00:00:...|\n|kgtyk4.kj.yamagat...|                   /|   200|        7280|1995-08-01 00:00:...|\n|kgtyk4.kj.yamagat...|/images/ksclogo-m...|   200|        5866|1995-08-01 00:00:...|\n|    d0ucr6.fnal.gov |/history/apollo/a...|   200|        2743|1995-08-01 00:00:...|\n|ix-esc-ca2-07.ix....|/shuttle/resource...|   200|        6849|1995-08-01 00:00:...|\n|    d0ucr6.fnal.gov |/history/apollo/a...|   200|       14897|1995-08-01 00:00:...|\n+--------------------+--------------------+------+------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787630_1067449771","id":"20180710-135410_584496912","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:02-0500","dateFinished":"2018-08-08T10:47:02-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"%md\nPongamos el DataFrame en cache, ya que lo reutilizaremos.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Pongamos el DataFrame en cache, ya que lo reutilizaremos.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787630_1067449771","id":"20180710-135420_541872120","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"%pyspark\nlogs_df.cache()","user":"hduser","dateUpdated":"2018-08-08T10:47:07-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[host: string, path: string, status: int, content_size: int, time: timestamp]\n"}]},"apps":[],"jobName":"paragraph_1533570787631_1067065022","id":"20180710-135421_1526654544","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:07-0500","dateFinished":"2018-08-08T10:47:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"%md\n### Analizando el Log del servidor web\n\nDespués de aplicar un conjunto de transformaciones a nuestro DataFrame, podemos realizar varios tipos de análisis del Log.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Analizando el Log del servidor web</h3>\n<p>Después de aplicar un conjunto de transformaciones a nuestro DataFrame, podemos realizar varios tipos de análisis del Log.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787631_1067065022","id":"20180710-135515_1467693714","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"%md\n## Estadísticos del tamaño del contenido\n\nVamos a computar varias estadísticas sobre el tamaño del contenido retornado por el servidor web. En particular, queremos calcular promedio, mínimo y máximo tamaño del contenido.\n\nPodemos computar tales estadísticas usando [`describe()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe) en la columna `content_size` del DataFrame `logs_df`. [`describe()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe) retorna el conteo, promedio, desviación estándar, mínimo y máximo de una columna especificada.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Estadísticos del tamaño del contenido</h2>\n<p>Vamos a computar varias estadísticas sobre el tamaño del contenido retornado por el servidor web. En particular, queremos calcular promedio, mínimo y máximo tamaño del contenido.</p>\n<p>Podemos computar tales estadísticas usando <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe\"><code>describe()</code></a> en la columna <code>content_size</code> del DataFrame <code>logs_df</code>. <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe\"><code>describe()</code></a> retorna el conteo, promedio, desviación estándar, mínimo y máximo de una columna especificada.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787632_1077453242","id":"20180710-215924_1604384111","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"%pyspark\n# Calcular algunas estadisticas basicas de la columna content_size.\ncontent_size_summary_df = logs_df.describe(['content_size'])\ncontent_size_summary_df.show()","user":"hduser","dateUpdated":"2018-08-08T10:47:10-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+\n|summary|      content_size|\n+-------+------------------+\n|  count|           1569898|\n|   mean|17089.225812122826|\n| stddev| 67954.76392157076|\n|    min|                 0|\n|    max|           3421948|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1533570787633_1077068493","id":"20180710-140103_1388274660","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:10-0500","dateFinished":"2018-08-08T10:47:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"text":"%md\n\nAlternativamente, podemos usar funciones de SparkSQL para computar las estadísticas. Existen múltiples funciones útiles en el módulo [`pyspark.sql.functions`](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.functions) de SparkSQL para llevar a cabo esta tarea.\n\nUsáremos las siguientes funciones:\n\n* [`avg()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.avg)\n* [`min()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.min)\n* [`max()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.max)\n\nDespués de aplicar una función de agregación `.agg()`, llamamos a `.first()` para extraer el primer valor del DataFrame.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":true,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Alternativamente, podemos usar funciones de SparkSQL para computar las estadísticas. Existen múltiples funciones útiles en el módulo <a href=\"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#module-pyspark.sql.functions\"><code>pyspark.sql.functions</code></a> de SparkSQL para llevar a cabo esta tarea.</p>\n<p>Usáremos las siguientes funciones:</p>\n<ul>\n  <li><a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.avg\"><code>avg()</code></a></li>\n  <li><a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.min\"><code>min()</code></a></li>\n  <li><a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.max\"><code>max()</code></a></li>\n</ul>\n<p>Después de aplicar una función de agregación <code>.agg()</code>, llamamos a <code>.first()</code> para extraer el primer valor del DataFrame.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787633_1077068493","id":"20180710-140227_835570364","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"%pyspark\nfrom pyspark.sql import functions as sqlFunctions\n\ncontent_size_stats =  (logs_df\n                       .agg(sqlFunctions.min(logs_df['content_size']),\n                            sqlFunctions.avg(logs_df['content_size']),\n                            sqlFunctions.max(logs_df['content_size']))\n                       .first())\n\nprint 'Usando funciones de  SparkSQL:'\nprint 'Tamaño del contenido Promedio: {1:,.2f}; Minimo: {0:.2f}; Maximo: {2:,.0f}'.format(*content_size_stats)","user":"hduser","dateUpdated":"2018-08-08T10:47:16-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Usando funciones de  SparkSQL:\nTamaño del contenido Promedio: 17,089.23; Minimo: 0.00; Maximo: 3,421,948\n"}]},"apps":[],"jobName":"paragraph_1533570787634_1078222740","id":"20180710-140515_96701835","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:16-0500","dateFinished":"2018-08-08T10:47:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"%md\n### Análisis de estados HTTP\n\nVeamos algunos de los códigos de respuesta que aparecen en el Log. Queremos conocer qué códigos aparecen en los datos y cuántas veces aparecen. Usaremos el DataFrame `logs_df` nuevamente, agruparemos por la columna `status` y aplicaremos la función de agregación `count()`. Finalmente ordenaremos por la columna `status`.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Análisis de estados HTTP</h3>\n<p>Veamos algunos de los códigos de respuesta que aparecen en el Log. Queremos conocer qué códigos aparecen en los datos y cuántas veces aparecen. Usaremos el DataFrame <code>logs_df</code> nuevamente, agruparemos por la columna <code>status</code> y aplicaremos la función de agregación <code>count()</code>. Finalmente ordenaremos por la columna <code>status</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787635_1077837991","id":"20180710-140907_1987005848","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"text":"%pyspark\nstatus_to_count_df =(logs_df\n                     .groupBy('status')\n                     .count()\n                     .sort('status')\n                     .cache())\n\nstatus_to_count_length = status_to_count_df.count()\nprint 'Se encontraron %d codigos de estado' % status_to_count_length\nstatus_to_count_df.show()\n","user":"hduser","dateUpdated":"2018-08-08T10:47:20-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Se encontraron 8 codigos de estado\n+------+-------+\n|status|  count|\n+------+-------+\n|   200|1398988|\n|   302|  26497|\n|   304| 134146|\n|   400|     10|\n|   403|    171|\n|   404|  10056|\n|   500|      3|\n|   501|     27|\n+------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1533570787635_1077837991","id":"20180710-141121_1454497874","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:20-0500","dateFinished":"2018-08-08T10:47:21-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"%md\n\n### Graficando resultados con Zeppelin\n\nUsemos los resultados del ejemplo anterior para visualizar mediante una gráfica de barras, el número de veces que aparece cada código de respuesta. Después de correr la celda, selecciona la opción de gráfica de barras de Zeppelin y configura seleccionando las columnas correctas.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Graficando resultados con Zeppelin</h3>\n<p>Usemos los resultados del ejemplo anterior para visualizar mediante una gráfica de barras, el número de veces que aparece cada código de respuesta. Después de correr la celda, selecciona la opción de gráfica de barras de Zeppelin y configura seleccionando las columnas correctas.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787636_1075914247","id":"20180710-141216_1793984043","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"text":"%pyspark\nz.show(status_to_count_df)","user":"hduser","dateUpdated":"2019-02-13T16:56:02-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"status":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"status","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"status\tcount\n200\t1398988\n302\t26497\n304\t134146\n400\t10\n403\t171\n404\t10056\n500\t3\n501\t27\n"}]},"apps":[],"jobName":"paragraph_1533570787636_1075914247","id":"20180710-141217_1455627829","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:23-0500","dateFinished":"2018-08-08T10:47:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"text":"%md\nPuedes observar que la gráfica anterior no es muy efectiva. El número de códigos de estados '200' supera por gran cantidad a otros códigos de estado.\n\nPodemos intentar mejorar nuestra gráfica usando una escala logarítmica añadiendo una columna al DataFrame.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Puedes observar que la gráfica anterior no es muy efectiva. El número de códigos de estados &lsquo;200&rsquo; supera por gran cantidad a otros códigos de estado.</p>\n<p>Podemos intentar mejorar nuestra gráfica usando una escala logarítmica añadiendo una columna al DataFrame.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787637_1075529498","id":"20180710-141714_88965941","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"%pyspark\nlog_status_to_count_df = status_to_count_df.withColumn('log(count)', sqlFunctions.log(status_to_count_df['count']))\n\nz.show(log_status_to_count_df.select(\"status\", \"log(count)\"))","user":"hduser","dateUpdated":"2019-02-13T16:56:02-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"status":"string","log(count)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"status","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"log(count)","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"status\tlog(count)\n200\t14.151259676055433\n302\t10.184786798018687\n304\t11.806684038040606\n400\t2.302585092994046\n403\t5.14166355650266\n404\t9.215924750270084\n500\t1.0986122886681098\n501\t3.295836866004329\n"}]},"apps":[],"jobName":"paragraph_1533570787638_1076683745","id":"20180710-141746_786701140","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:38-0500","dateFinished":"2018-08-08T10:47:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"text":"%md\nAunque la gráfica mejoró, quizá deberíamos hacer algunos ajustes. La librería [`matplotlib`](http://matplotlib.org/) de python puede darnos más libertad para ajustar nuestras gráficas.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Aunque la gráfica mejoró, quizá deberíamos hacer algunos ajustes. La librería <a href=\"http://matplotlib.org/\"><code>matplotlib</code></a> de python puede darnos más libertad para ajustar nuestras gráficas.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787638_1076683745","id":"20180710-141956_1664998561","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"text":"%pyspark\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\nimport numpy as np\n\ndata = log_status_to_count_df.drop('count').collect()\n\nx, y = zip(*data)\nindex = np.arange(len(x))\nbar_width = 0.7\n\n\nfig, ax = plt.subplots()\nax.set_xticks(index + bar_width)\nplt.bar(index + bar_width, y, width=bar_width)\nplt.xticks(index + bar_width, x)\nz.show(plt)\nprint index\n","user":"hduser","dateUpdated":"2018-08-08T10:47:42-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<module 'matplotlib.pyplot' from '/usr/local/lib/python2.7/dist-packages/matplotlib/pyplot.pyc'>\n[0 1 2 3 4 5 6 7]\n"},{"type":"HTML","data":"<div style='width:auto;height:auto'><img src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQCAYAAAByNR6YAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAGZxJREFUeJzt3X1sVfX9wPHPqfjDGXxAnb2KaKfhsZa2IEic2ZAhbGagcbgYNjCI8Q/N5oiJOv8REsfDCC64pz9cppPEMbclg00UmXo1Y5voRGHOhymC1gVUZCrCpsj5/QE2RcHR8pXT2/N6JTfBy23z+dxzbN+ceylZnud5AACQTF3RAwAA9DQCCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgsVIF1owZM6K+vj6GDRu21/0//OEPY8iQIdHU1BQ33HBDQdMBAD1Fr6IHOJSmT58e3/rWt2LatGnt91Wr1fj9738f69ati169esUbb7xR4IQAQE9QqitY5557bvTt23ev+37605/GDTfcEL167W7NE044oYjRAIAepFSBtS/PP/98PPLIIzF69Og477zz4vHHHy96JACgxpXqJcJ92blzZ2zdujX++te/xmOPPRZf//rXY/369UWPBQDUsNIHVv/+/ePiiy+OiIiRI0dGXV1dbNmyJY4//viPPTbLskM9HgD0GHmeFz3CIVO6lwjzPN/rAF900UXx4IMPRsTulwvff//9fcbVRz++DLebbrqp8BnsbF8729e+PWPnsinVFawpU6ZEtVqNLVu2xKmnnhqzZ8+Oyy+/PKZPnx5NTU3Ru3fvuPPOO4seEwCocaUKrLvuumuf9y9evPgQTwIA9GSle4mQAzdmzJiiRzjkyrZz2faNKN/O9u35yrhzLcjyMr4w2kVZlpXydWQAOFhl+x7qChYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkJrAAABITWAAAiQksAIDEBBYAQGICCwAgMYEFAJCYwAIASExgAQAkVqrAmjFjRtTX18ewYcM+9nsLFy6Murq6ePPNNwuYDADoSUoVWNOnT48VK1Z87P62trZYuXJlnHbaaQVMBQD0NKUKrHPPPTf69u37sftnzpwZCxYsOKDPkWVZt79VKg2JnzkAoDN6FT1A0ZYtWxb9+/ePpqamA/yI/FOdJ4XNm7OiRwCAUit1YO3YsSPmzJkTK1eubL8vz7t/QAEA3VupA+vFF1+MDRs2RHNzc+R5Hm1tbTFixIhYvXp1nHjiifv5qFkdfj1mzw0A6KharUa1Wi16jMJkecku2WzYsCEmTpwY69at+9jvfe5zn4snnnhin+/Titj9/qtaeIkwInMlDoBuJcvK9b2pVG9ynzJlSpxzzjnx/PPPx6mnnhq33377Xr9ftoMPAHw6SncF62C4ggUAXVO2ixiluoIFAHAoCCwAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACRWqsCaMWNG1NfXx7Bhw9rvu+6662LIkCHR0tISX/va1+Ltt98ucEIAoCcoVWBNnz49VqxYsdd948ePj6effjqefPLJGDBgQMydO7eg6QCAnqJUgXXuuedG375997pv3LhxUVe3+2kYPXp0tLW1FTEaANCDlCqw/pef//zn8ZWvfKXoMQCAGiew9vje974Xhx9+eEyZMqXoUQCAGter6AG6gzvuuCOWL18eDz744AE8elaHX4/ZcwMAOqpWq1GtVoseozBZnud50UMcShs2bIiJEyfGunXrIiLivvvui2uvvTYeeeSROP744z/xY7Msi4haeLqyKNlhBaCby7JyfW8qVWBNmTIlqtVqbNmyJerr62P27NkxZ86ceO+999rjavTo0fGTn/xknx8vsACgawQW+yWwAKBryhZY3uQOHVQqDZFlWbe/VSoNRT9VAHwCV7A6wRWsns8xBvh0uIIFAMBBEVgAAIkJLACAxAQWAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAILFSBdaMGTOivr4+hg0b1n7f1q1bY/z48TFo0KCYMGFCvPXWWwVOCAD0BKUKrOnTp8eKFSv2um/evHkxbty4eO6552Ls2LExd+7cgqbrfiqVhsiyrCZulUpD0U8XALTL8jzPix7iUNq4cWNMnDgx1q5dGxERgwcPjocffjjq6+tj06ZNMWbMmHj22Wf3+bFZlkVELTxdWaQ4rLWzb0T5dk6zL8ChkmXl+rpVqitY+/Laa69FfX19RERUKpV47bXXCp4IAKh1pQ+sj9p9BQMAoOt6FT1A0err62Pz5s3tLxGeeOKJ/+MjZnX49Zg9NwCgo2q1GtVqtegxClO692Bt2LAhJk6cGOvWrYuIiOuvvz6OO+64uP7662P+/PmxdevWmDdv3j4/tmzvz6mdfSPKt3O53ssA1L6yvQerVIE1ZcqUqFarsWXLlqivr4/Zs2fHRRddFJdcckm88sorcdppp8Xdd98dxx577D4/vmzffGtn34jy7VyuL1RA7RNY7FfZvvnWzr4R5du5XF+ogNpXtsDyJncAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgQUAkJjAAujBKpWGyLKs298qlYainypIKsvL9E9bH6QsyyKiFp6uNP9iee3sG1G+ncv1r9LTdc5puossK9cxdgULACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgQUAkJjAAgBITGABACQmsAAAEhNYAACJCSwAgMQEFgBAYgILACAxgbXH3Llzo7GxMYYNGxbf+MY34r333it6JACgRgmsiNi4cWPcdtttsWbNmli7dm3s3LkzlixZUvRYAECN6lX0AN3B0UcfHf/3f/8X7777btTV1cX27dvj5JNPLnosAKBGuYIVEX379o1rr702Tj311OjXr18ce+yxMW7cuKLHAgBqlMCKiPXr18cPfvCD2LhxY/zrX/+Kbdu2xV133VX0WABAjfISYUQ8/vjj8fnPfz6OO+64iIi4+OKL489//nNMmTJlH4+e1eHXY/bcAICOqtVqVKvVoscoTJbneV70EEV76qmn4pvf/GY89thj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ABITWAAAiQmsPe67774YPHhwDBw4MObPn1/0OABADcvyPM+LHqJou3btioEDB8YDDzwQJ598cowcOTKWLFkSgwcP3utxWZZFRC08XVmkOKy1s29E+Xa2b5c/U8l2tm93Vrad0/1/XAtcwYqI1atXx4ABA+K0006Lww8/PC699NJYunRp0WMBADVKYEXEq6++Gv3792//71NOOSVeffXVAicCAGqZwAIASKxX0QN0B/369YuXX365/b/b2tqiX79++3l0dmiGOki7X5NP8pkSfZ5PX9l2tu9BfbaEn+vT4xh3+TMl+jyfvjLuXBbe5B4RH3zwQQwaNCgeeOCBOOmkk2LUqFHxy1/+MoYMGVL0aABADXIFKyIOO+yw+NGPfhTjx4+PXbt2xYwZM8QVANBlrmABACTmTe57tLW1xdixY6OxsTGampri1ltvjYiIrVu3xvjx42PQoEExYcKEeOutt9o/Zu7cuTFgwIAYMmRI3H///UWN3mX//e9/4+yzz47W1tZobGyMG2+8MSL2v/Mf//jHOOuss6K5uTlGjhwZDz30UJHjd1pn9/3Qyy+/HEcddVTccsstRYx90Hbt2hXDhw+PSZMmRUTPPqcjDnzfxx57LFpbW6O1tTWam5vjV7/6VZFjH5TOHOOI2j+nGxoaorm5OVpbW2PUqFER0bPP687s++abb8bYsWPjqKOOim9/+9tFjl16AmuPXr16xS233BJPP/10/OUvf4kf//jH8eyzz8a8efNi3Lhx8dxzz8XYsWNj7ty5ERHxj3/8I+6+++545pln4t57742rrrqq5n6AWu/eveOhhx6KNWvWxNq1a+PBBx+MVatW7Xfnz372s/GHP/whnnrqqbjjjjti6tSpBW/QOZ3d90PXXnttXHDBBQVNffAWLVoUQ4cObf/vnnxORxz4vk1NTfG3v/0t1qxZEytWrIirr746Pvjgg6LGPigHuvOHav2crquri2q1GmvWrInVq1dHRM8+rzuz7xFHHBE333xzLFy4sMiRCYHVrlKpREtLS0RE9OnTJ4YMGRJtbW2xdOnSuOyyyyIi4rLLLovf/e53ERGxbNmyuPTSS6NXr17R0NAQAwYMaD/xa8mRRx4ZEbuv7uzatSv69u27352bm5ujUqlERERjY2P85z//iffff7+YwbuoM/tGRCxdujROP/30aGxsLGTeg9XW1hbLly+PK664ov2+nnxOd2bfI444Iurqdn8J3LFjRxxzzDFx2GGHHfqhD1Jndv7w92r5nI6IyPM8du3atdd9Pfm87sy+Rx55ZJxzzjnRu3fvQz4nexNY+7Bhw4Z48sknY/To0bF58+aor6+PiN0R9tprr0XEx384ab9+/Wryh5Pu2rUrWltbo1KpxJgxY2Lo0KH73bmj3/zmNzF8+PA4/PDDD/XIB+VA9t28eXNERGzbti2+//3vx0033VRzf+L90MyZM2PBggV7/VXwnnxOd2bfiN3/isOZZ54ZZ555Zs2+XHYgO/ekczpi9482OP/882PkyJHxs5/9LCJ69nndmX3pPvwtwo/Ytm1bTJ48ORYtWhR9+vT52M8oSfuzeIpXV1cXa9asibfffjsmTJgQ1Wr1f+789NNPx3e/+91YuXLloRw1iQPZ98OrGrNnz46ZM2e2X/WqtW9I99xzT9TX10dLS0tUq9X9Pq6nnNNd2XfUqFHx97//PZ577rmYMGFCnHfeeXH00UcfgmnTONCde8o5/aFVq1bFSSedFK+//nr7+5B68tfqsu3bUwisDnbu3BmTJ0+OqVOnxoUXXhgREfX19e1/Uti0aVOceOKJEbH7T0GvvPJK+8d+8g8n7f6OPvrouOCCC+Lxxx/f784Ru/e8+OKLY/HixdHQ0FDcwAfpQPZ99NFH47e//W1cd911sXXr1jjssMPiM5/5TFx11VUFT39gVq1aFcuWLYvly5fHjh074p133ompU6e2X9Hoaed0Z/ftaNCgQXHGGWfEP//5zxgxYkQB03dNZ3eu9XP6QyeddFJE7H5f6EUXXRSrV6/u0V+rO7Mv3YeXCDu4/PLLY+jQoXHNNde03zdp0qS44447IiLiF7/4RXt4TZo0KZYsWRLvvfdevPTSS/HCCy+0/+2OWvHGG2+0/82THTt2xMqVK6O1tXW/O//73/+Or371qzF//vwYPXp0UWN3WWf3feSRR2L9+vWxfv36+M53vhM33nhjTX0jmjNnTrz88suxfv36WLJkSYwdOzYWL14cEydO7JHndGf33bBhQ/ub2jdu3BgvvPBCDBgwoKjxu6SzO9f6OR0RsX379ti2bVtERLz77rtx//33R1NTU4/9Wt3ZfTuq1SuUPUZOnud5/qc//Smvq6vLm5ub85aWlry1tTW/99578y1btuRf+tKX8oEDB+bnn39+vnXr1vaPmTNnTn7GGWfkgwcPzlesWFHg9F2zdu3avLW1NW9pacmHDRuWL1iwIM/zfL8733zzzXmfPn3aP6a1tTV//fXXi1yhUzq7b0ezZs3KFy5ceKhHTqZareYTJ07M8/yT9631c/pDB7Lv4sWL88bGxry1tTUfNWpUft999xU58kE70GP8oVo9p9evX9/+dfrMM8/M586dm+d5zz2vu7JvQ0NDfvzxx+dHHXVU3r9///yZZ54pavxS84NGAQAS8xIhAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAIDGBBQCQmMACAEhMYAEAJCawAAASE1gAAIkJLACAxAQWAEBiAgsAIDGBBQCQ2P8Dg1IgMpVLCaIAAAAASUVORK5CYII= style='width=auto;height:auto'><div>\n"}]},"apps":[],"jobName":"paragraph_1533570787639_1076298996","id":"20180710-142110_1444739481","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:42-0500","dateFinished":"2018-08-08T10:47:42-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"text":"%md\n### Accesos frecuentes\n\nVeamos que \"`hosts`\" han visitado frecuentemente al servidor (ej., más de 10 veces). Similar a los códigos de respuesta, crearemos un DataFrame agrupando `logs_df` por la columna `hosts`, y usáremos la función de agregación `count()`.\n\nDespués, filtraremos los resultados basado en el número de veces que el cliente visitó el servidor. Por último, se imprimen 20 elementos con `show()`.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Accesos frecuentes</h3>\n<p>Veamos que &ldquo;<code>hosts</code>&rdquo; han visitado frecuentemente al servidor (ej., más de 10 veces). Similar a los códigos de respuesta, crearemos un DataFrame agrupando <code>logs_df</code> por la columna <code>hosts</code>, y usáremos la función de agregación <code>count()</code>.</p>\n<p>Después, filtraremos los resultados basado en el número de veces que el cliente visitó el servidor. Por último, se imprimen 20 elementos con <code>show()</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787639_1076298996","id":"20180710-143013_276671011","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"text":"%pyspark\n# Clientes que han visitado el sitio mas de 10 ocaciones\nhost_sum_df =(logs_df\n              .groupBy('host')\n              .count())\n\nhost_more_than_10_df = (host_sum_df\n                        .filter(host_sum_df['count'] > 10)\n                        .select(host_sum_df['host']))\n\nprint '20 clientes que han visitado mas de 10 ocaciones el servidor:\\n'\nhost_more_than_10_df.show(truncate=False)","user":"hduser","dateUpdated":"2018-08-08T10:47:47-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"20 clientes que han visitado mas de 10 ocaciones el servidor:\n\n+-----------------------------------+\n|host                               |\n+-----------------------------------+\n|n1377004.ksc.nasa.gov              |\n|150.216.42.43                      |\n|mailgate.isd.state.in.us           |\n|163.205.44.27                      |\n|164.117.225.145                    |\n|128.159.177.122                    |\n|prufrock.gsfc.nasa.gov             |\n|ip11.iac.net                       |\n|ak087.du.pipex.com                 |\n|162.127.2.237                      |\n|zip.eit.com                        |\n|wildcard.amat.com                  |\n|irpud1.raumplanung.uni-dortmund.de |\n|sitec08.crpht.lu                   |\n|huge.oso.chalmers.se               |\n|199.126.10.4                       |\n|prakinf2.prakinf.tu-ilmenau.de     |\n|rherman.grt.ch.etn.com             |\n|pricepc.sct.ucarb.com              |\n|pm1-orl7.iag.net                   |\n+-----------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787640_1074375251","id":"20180710-143419_1774119060","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:47-0500","dateFinished":"2018-08-08T10:47:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"text":"%md\n### Visualizando direcciones\n\nAhora hagamos un análisis del número de visitas a cada dirección del sitio en el log (URLs). Nuevamente usaremos `logs_df` para agrupar por la columna `path`, para después usar la función de agregación `count()`. Al final ordenaremos el DataFrame de forma descendente.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Visualizando direcciones</h3>\n<p>Ahora hagamos un análisis del número de visitas a cada dirección del sitio en el log (URLs). Nuevamente usaremos <code>logs_df</code> para agrupar por la columna <code>path</code>, para después usar la función de agregación <code>count()</code>. Al final ordenaremos el DataFrame de forma descendente.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787641_1073990502","id":"20180710-143720_295023836","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"text":"%pyspark\n\npaths_df = (logs_df\n            .groupBy('path')\n            .count()\n            .sort('count', ascending=False))\n\npaths_counts = (paths_df\n                .select('path', 'count')\n                .collect())\n\npaths, counts = zip(*paths_counts)\n\nfig, ax = plt.subplots()\nplt.xlabel('Paths')\nplt.ylabel('Number of Hits')\nindex= np.arange(1000)\nplt.plot(index, counts[:1000], linewidth=3)\nplt.axhline(linewidth=2, color='#999999')\nz.show(plt)","user":"hduser","dateUpdated":"2018-08-08T10:47:52-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<module 'matplotlib.pyplot' from '/usr/local/lib/python2.7/dist-packages/matplotlib/pyplot.pyc'>\n"},{"type":"HTML","data":"<div style='width:auto;height:auto'><img src=data:image/png;base64,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TU2KiYnhmlvs29/+toYOHXrRNn+vcW1trRobG5WWliZJmjNnjnufno6A5cOVbkLqdDptrKh3OnDggHbu3KkpU6bo6NGjioqKkuQKYceOHZN0+b9FTEwM/xYB+PnPf67f/va3F912hGvedfbv36/rr79e8+bN04QJE7RgwQKdOXOGa96Fhg4dqkcffVQ33nijYmJiFBERoRkzZnDNu8GxY8f8usZOp1OxsbHu7b3pbywBC7Y7deqUsrOztWLFCg0cOPCy+41x/zHrvPnmm4qKitK4ceO83o+Ga26d1tZWVVZW6mc/+5kqKys1YMAA9732PHHNrfPFF1/o6aef1sGDB3XkyBGdPn1aL7/8MtfcBn35GhOwfIiJidGhQ4fc6zU1NYqJibGxot6ltbVV2dnZysvL0z333CNJioqK0tGjRyVJtbW1Gj58uCTXv8Xhw4fd+/Jv4b8PPvhAZWVlGj16tH74wx9q69atysvLU3R0NNe8i8TGxmrkyJGaNGmSJOn+++9XZWUlv+dd6JNPPtGtt96qyMhIhYSE6L777tOHH37INe8G/l7j3nztCVg+pKWlad++fTp48KBaWlpUWlrq/uQVOu/HP/6xkpKS9Mgjj7i33X333Xr++eclSS+88II7eN19990qLS1VS0uL9u/fr3379mny5Ml2lN1jPfXUUzp06JC++OILlZaWKj09XS+99JJmzZrFNe8iUVFRGjlypKq+/oLHLVu2KDk5md/zLpSQkKCPPvpIzc3NMk1TW7ZsUVJSEte8C5imeVE33N9rHB0drYiICFVUVMg0Tb344ovufXo8W6fY9xAbN2404+PjzZtvvtksLCy0u5xe4/333zf79etnjh071hw3bpw5fvx4c+PGjebx48fN22+/3YyPjzfvuOMOs66uzr3PU089Zd50003mmDFjzE2bNtlYfc9XXl7u/hQh17xr7dy505w0aZI5duxY87777jNPnjzJNe9i//7v/24mJSWZKSkp5pw5c8yWlhauucV++MMfmjfccIPZv39/c+TIkebq1avNEydO+H2NP/nkE/OWW24xb775ZnPRokV2vJUuwY1GAQAALMYQIQAAgMUIWAAAABYjYAEAAFiMgAUAAGAxAhYAAIDFCFgAAAAWI2ABCEohISGaMGGCUlJS9IMf/EDNzc1eX19YWOhePnjwoFJSUrq6RADoEAELQFAaMGCAKisr9dlnnyksLEz/+Z//6fX1Tz311EXrffk70ADYj4AFIOh95zvf0b59+yRJ9913n9LS0pSSkqLnnntOkvT444+rqalJEyZMUF5eniTX91wuWLBAt9xyi7KysnT27FlJ0sqVK5WcnKxx48bpwQcftOcNAej1uJM7gKA0aNAgNTY2ur8Q/M4779RPf/pTnTx5UkOGDFFzc7PS0tK0bds2DR06VIMHD1ZDQ4Mk1xDhzTffrMrKSvcQ4z333KMHH3xQMTExOnDggMLCwtTQ0KDBgwfb/E4B9EZ0sAAEpQsdqcmTJysuLk7z58+XJP3hD3/QuHHjNGXKFNXU1Ki6uvqK+48ePdo9D2vixIk6cOCAJGns2LF68MEH9fLLLyskJKRb3guAvifU7gIA4Equu+46VVZWXrTt3Xff1datW7V9+3aFh4frtttuc09+v7QZHx4e7l4OCQlxv+7NN9/Utm3bVFZWpt/85jfatWuX+vXj/zUBWIv/qgAISleavVBfX6+hQ4cqPDxcf/vb3/TRRx+5n+vfv7/a2tq87i9Jhw4d0rRp01RUVKSGhgadOnXK+uIB9HkELABB6UqfAszKytK5c+eUnJysX/ziF5o6dar7uQULFiglJcU9yf1K+7e2tupHP/qRxo4dq4kTJ+qRRx5hDhaALsEkdwAAAIvRwQIAALAYAQsAAMBiBCwAAACLEbAAAAAsRsACAACwGAELAADAYgQsAAAAixGwAAAALEbAAgAAsBgBCwAAwGIELAAAAIsRsAAAACz2/wF2nPsdbd1CWwAAAABJRU5ErkJggg== style='width=auto;height:auto'><div>\n"}]},"apps":[],"jobName":"paragraph_1533570787641_1073990502","id":"20180710-144016_908727155","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:52-0500","dateFinished":"2018-08-08T10:47:54-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"text":"%md\nTambién puedes llevar a cabo la visualización usando Zeppelin.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":true,"results":{},"editorMode":"ace/mode/markdown","editorHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>También puedes llevar a cabo la visualización usando Zeppelin.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787642_1075144749","id":"20180710-144144_1657863861","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"text":"%pyspark\nz.show(paths_df.limit(1000))","user":"hduser","dateUpdated":"2019-02-13T16:56:02-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"path":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"path","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"path\tcount\n/images/NASA-logosmall.gif\t97275\n/images/KSC-logosmall.gif\t75283\n/images/MOSAIC-logosmall.gif\t67356\n/images/USA-logosmall.gif\t66975\n/images/WORLD-logosmall.gif\t66351\n/images/ksclogo-medium.gif\t62670\n/ksc.html\t43618\n/history/apollo/images/apollo-logo1.gif\t37806\n/images/launch-logo.gif\t35119\n/\t30105\n/images/ksclogosmall.gif\t27789\n/shuttle/missions/sts-69/mission-sts-69.html\t24592\n/shuttle/countdown/\t24444\n/shuttle/missions/sts-69/count69.gif\t24363\n/shuttle/missions/sts-69/sts-69-patch-small.gif\t23391\n/shuttle/missions/missions.html\t22429\n/images/launchmedium.gif\t19863\n/htbin/cdt_main.pl\t17238\n/shuttle/countdown/images/countclock.gif\t12154\n/icons/menu.xbm\t12128\n/icons/blank.xbm\t12047\n/software/winvn/winvn.html\t10343\n/icons/image.xbm\t10300\n/history/apollo/images/footprint-logo.gif\t10119\n/history/history.html\t10111\n/history/apollo/images/apollo-small.gif\t9427\n/history/apollo/images/footprint-small.gif\t9225\n/software/winvn/winvn.gif\t9033\n/history/apollo/apollo.html\t8973\n/software/winvn/wvsmall.gif\t8659\n/software/winvn/bluemarb.gif\t8607\n/htbin/cdt_clock.pl\t8549\n/shuttle/countdown/liftoff.html\t7858\n/shuttle/resources/orbiters/orbiters-logo.gif\t7384\n/images/shuttle-patch-logo.gif\t7259\n/history/apollo/apollo-13/apollo-13.html\t7160\n/images/\t7039\n/shuttle/countdown/video/livevideo2.gif\t7025\n/images/kscmap-tiny.gif\t6613\n/shuttle/technology/sts-newsref/stsref-toc.html\t6506\n/history/apollo/apollo-13/apollo-13-patch-small.gif\t6302\n/shuttle/missions/sts-71/sts-71-patch-small.gif\t5607\n/shuttle/missions/sts-69/images/images.html\t5260\n/icons/text.xbm\t5245\n/images/construct.gif\t5091\n/images/shuttle-patch-small.gif\t4864\n/shuttle/missions/sts-69/movies/movies.html\t4841\n/shuttle/missions/sts-70/sts-70-patch-small.gif\t4789\n/icons/unknown.xbm\t4782\n/shuttle/missions/sts-69/liftoff.html\t4558\n/facilities/lc39a.html\t4462\n/shuttle/resources/orbiters/endeavour.html\t4429\n/history/apollo/images/apollo-logo.gif\t4363\n/shuttle/missions/sts-70/mission-sts-70.html\t4065\n/images/lc39a-logo.gif\t4018\n/shuttle/resources/orbiters/endeavour-logo.gif\t3813\n/shuttle/technology/sts-newsref/sts_asm.html\t3704\n/shuttle/countdown/countdown.html\t3515\n/shuttle/missions/sts-71/movies/movies.html\t3505\n/shuttle/countdown/video/livevideo.jpeg\t3374\n/history/apollo/apollo-11/apollo-11.html\t3135\n/shuttle/missions/sts-71/mission-sts-71.html\t3124\n/shuttle/missions/sts-70/images/images.html\t3086\n/shuttle/missions/sts-71/images/images.html\t2942\n/shuttle/missions/sts-73/mission-sts-73.html\t2938\n/images/faq.gif\t2863\n/shuttle/technology/images/srb_mod_compare_1-small.gif\t2862\n/shuttle/technology/images/srb_mod_compare_3-small.gif\t2815\n/shuttle/technology/images/srb_mod_compare_6-small.gif\t2714\n/history/apollo/apollo-11/apollo-11-patch-small.gif\t2700\n/elv/elvpage.htm\t2585\n/shuttle/missions/sts-73/sts-73-patch-small.gif\t2543\n/shuttle/countdown/video/sts-69-prelaunch-pad.gif\t2384\n/shuttle/missions/51-l/mission-51-l.html\t2341\n/images/launch-small.gif\t2291\n/facilities/tour.html\t2254\n/shuttle/missions/51-l/51-l-patch-small.gif\t2201\n/shuttle/resources/orbiters/challenger.html\t2170\n/images/kscmap-small.gif\t2170\n/shuttle/missions/sts-71/movies/sts-71-launch.mpg\t2158\n/shuttle/technology/sts-newsref/sts-lcc.html\t2146\n/htbin/wais.pl\t2131\n/facts/about_ksc.html\t2117\n/history/mercury/mercury.html\t2104\n/images/mercury-logo.gif\t2040\n\t2029\n/elv/elvhead3.gif\t1991\n/images/launchpalms-small.gif\t1978\n/images/whatsnew.gif\t1936\n/history/apollo/apollo-spacecraft.txt\t1927\n/facilities/vab.html\t1915\n/shuttle/resources/orbiters/columbia.html\t1912\n/shuttle/countdown/lps/fr.html\t1905\n/shuttle/resources/orbiters/challenger-logo.gif\t1904\n/whats-new.html\t1891\n/images/ksclogo.gif\t1889\n/elv/endball.gif\t1874\n/shuttle/missions/sts-74/mission-sts-74.html\t1867\n/history/apollo/apollo-13/apollo-13-info.html\t1864\n/elv/PEGASUS/minpeg1.gif\t1845\n/elv/SCOUT/scout.gif\t1835\n/elv/DELTA/delta.gif\t1827\n/images/vab-small.gif\t1827\n/elv/TITAN/titan.gif\t1816\n/elv/ATLAS_CENTAUR/atlas.gif\t1814\n/shuttle/missions/sts-70/movies/movies.html\t1808\n/elv/struct.gif\t1788\n/elv/updated.gif\t1698\n/shuttle/resources/orbiters/columbia-logo.gif\t1686\n/elv/new01.gif\t1675\n/shuttle/countdown/lps/fr.gif\t1641\n/shuttle/missions/sts-1/mission-sts-1.html\t1619\n/shuttle/countdown/lps/back.gif\t1613\n/shuttle/missions/sts-70/o-ring-problem.gif\t1609\n/facts/faq04.html\t1586\n/shuttle/missions/sts-68/mission-sts-68.html\t1586\n/history/skylab/skylab.html\t1580\n/shuttle/missions/sts-68/ksc-srl-image.html\t1569\n/shuttle/resources/orbiters/discovery.html\t1559\n/shuttle/missions/sts-69/endeavour-pad-prelaunch-8-31-95.gif\t1547\n/shuttle/resources/orbiters/orbiters.html\t1539\n/shuttle/missions/sts-74/sts-74-patch-small.gif\t1538\n/elv/elvhead2.gif\t1537\n/history/skylab/skylab-small.gif\t1533\n/shuttle/missions/sts-68/images/ksc.gif\t1517\n/history/gemini/gemini.html\t1506\n/images/launch.gif\t1500\n/shuttle/missions/sts-78/mission-sts-78.html\t1481\n/images/landing-small.gif\t1464\n/shuttle/missions/sts-1/sts-1-patch-small.gif\t1457\n/history/apollo/apollo-1/apollo-1.html\t1435\n/shuttle/missions/sts-69/movies/ws-animation-deploy.mpg\t1391\n/shuttle/missions/sts-68/images/ksc-upclose.gif\t1391\n/shuttle/technology/images/mission_profile_2-small.gif\t1372\n/images/rss.gif\t1366\n/shuttle/resources/orbiters/discovery-logo.gif\t1355\n/history/apollo/apollo-1/apollo-1-patch-small.gif\t1352\n/facilities/mlp.html\t1350\n/pub/winvn/readme.txt\t1337\n/shuttle/missions/sts-68/sts-68-patch-small.gif\t1336\n/images/gemini-logo.gif\t1326\n/shuttle/missions/sts-72/mission-sts-72.html\t1313\n/shuttle/technology/sts-newsref/sts_overview.html\t1308\n/shuttle/missions/sts-78/sts-78-patch-small.gif\t1286\n/history/rocket-history.txt\t1286\n/shuttle/resources/orbiters/atlantis.html\t1277\n/shuttle/missions/sts-69/images/KSC-95EC-0694.jpg\t1275\n/shuttle/missions/sts-69/images/KSC-95EC-0694.gif\t1265\n/images/mlp-logo.gif\t1259\n/shuttle/missions/rollbacks.html\t1252\n/shuttle/missions/sts-66/mission-sts-66.html\t1251\n/facilities/lcc.html\t1229\n/history/apollo/apollo-13/\t1220\n/history/apollo/apollo-13/images/\t1217\n/shuttle/missions/sts-69/images/KSC-95EC-1032.jpg\t1203\n/images/rollback.gif\t1199\n/pub/winvn/release.txt\t1185\n/shuttle/missions/sts-69/movies/ws-animation-retrieval.mpg\t1174\n/shuttle/technology/sts-newsref/srb.html\t1171\n/images/KSC-94EC-412-small.gif\t1156\n/history/apollo/flight-summary.txt\t1155\n/shuttle/missions/sts-69/sts-69-press-kit.txt\t1148\n/images/lcc-small2.gif\t1132\n/shuttle/resources/orbiters/atlantis-logo.gif\t1121\n/shuttle/missions/sts-72/sts-72-patch-small.gif\t1116\n/facts/facts.html\t1115\n/mdss/MDSS.html\t1115\n/history/apollo/images/APOLLO-logosmall.gif\t1101\n/shuttle/missions/sts-69/news/\t1099\n/shuttle/missions/sts-69/images/index69.gif\t1094\n/icons/movie.xbm\t1084\n/history/apollo/apollo-17/apollo-17.html\t1073\n/shuttle/technology/images/srb_16-small.gif\t1065\n/shuttle/technology/images/sts_spec_6-small.gif\t1062\n/shuttle/countdown/tour.html\t1060\n/shuttle/missions/51-l/\t1052\n/shuttle/missions/\t1041\n/shuttle/technology/sts-newsref/sts_coord.html\t1041\n/shuttle/missions/sts-65/mission-sts-65.html\t1035\n/history/mercury/mr-3/mr-3-patch-small.gif\t1030\n/shuttle/missions/sts-63/mission-sts-63.html\t1022\n/mdss/s_md-2.gif\t1005\n/history/apollo/apollo-17/apollo-17-patch-small.gif\t1002\n/shuttle/missions/51-l/51-l-info.html\t977\n/icon/constr.gif\t967\n/shuttle/missions/sts-67/sts-67-patch-small.gif\t965\n/history/apollo/apollo-13/movies/\t960\n/history/early-astronauts.txt\t957\n/shuttle/missions/sts-67/mission-sts-67.html\t956\n/history/gemini/images/gemini-logo.gif\t950\n/shuttle/technology/images/launch_sites_8-small.gif\t950\n/finance/main.htm\t948\n/shuttle/missions/sts-69/sts-69-patch.jpg\t944\n/shuttle/missions/sts-66/sts-66-patch-small.gif\t937\n/history/apollo/images/apollo.gif\t934\n/shuttle/missions/sts-70/movies/woodpecker.mpg\t931\n/shuttle/technology/images/sts_body_2-small.gif\t928\n/shuttle/missions/sts-69/countdown.html\t920\n/shuttle/missions/sts-63/sts-63-patch-small.gif\t913\n/finance/collsm1.gif\t913\n/shuttle/missions/sts-69/\t910\n/images/op-logo-small.gif\t902\n/shuttle/missions/sts-69/images/KSC-95EC-1032.gif\t882\n/shuttle/technology/images/crew_compartment_13-small.gif\t882\n/procurement/procurement.html\t865\n/software/winvn/wvlarge.gif\t858\n/shuttle/missions/sts-69/news\t854\n/finance/suit.gif\t853\n/finance/links.gif\t852\n/finance/ref_btn.gif\t848\n/shuttle/technology/sts-newsref/sts-mps.html\t847\n/finance/webserch.gif\t845\n/history/apollo/\t840\n/finance/book.gif\t840\n/finance/toairpla.gif\t837\n/finance/tour.gif\t837\n/software/winvn/faq/WINVNFAQ-Contents.html\t833\n/finance/brrow_1t.gif\t830\n/history/mercury/mr-3/mr-3.html\t824\n/shuttle/missions/sts-71/movies/sts-71-launch-3.mpg\t808\n/shuttle/countdown/count.html\t775\n/shuttle/missions/sts-69/images/KSC-95EC-0760.jpg\t768\n/shuttle/missions/sts-69/erin.gif\t759\n/shuttle/missions/61-c/mission-61-c.html\t750\n/shuttle/missions/sts-65/sts-65-patch-small.gif\t743\n/history/apollo/apollo-13/sounds/\t740\n/software/winvn/userguide/wvnguide.html\t736\n/shuttle/missions/sts-69/movies/sts-69-rollback.mpg\t728\n/shuttle/missions/61-c/61-c-patch-small.gif\t727\n/shuttle/missions/sts-75/mission-sts-75.html\t725\n/history/astp/astp.html\t724\n/icons/sound.xbm\t721\n/shuttle/missions/sts-62/mission-sts-62.html\t710\n/history/astp/astp-patch-small.gif\t700\n/history/apollo/apollo-goals.txt\t699\n/shuttle/missions/sts-49/mission-sts-49.html\t697\n/shuttle/missions/STS-69/mission-STS-69.html\t682\n/shuttle/missions/sts-59/mission-sts-59.html\t674\n/shuttle/missions/51-l/images/\t672\n/shuttle/missions/sts-69/sts-69-info.html\t667\n/shuttle/technology/sts-newsref/sts_mes.html\t666\n/shuttle/resources/orbiters/enterprise.html\t665\n/history/skylab/skylab-logo.gif\t665\n/shuttle/technology/images/aft_fuselage_2-small.gif\t663\n/facilities/opf.html\t659\n/software/winvn/userguide/winvnsm.gif\t657\n/shuttle/missions/sts-71/movies/crew-arrival-t38.mpg\t652\n/shuttle/technology/sts-newsref/sts-cron.html\t651\n/shuttle/missions/sts-64/mission-sts-64.html\t634\n/shuttle/missions/sts-49/sts-49-patch-small.gif\t632\n/shuttle/resources/orbiters/enterprise-logo.gif\t630\n/images/crawler-logo.gif\t628\n/shuttle/technology/images/et-intertank_1-small.gif\t626\n/images/lc39a.gif\t623\n/shuttle/technology/images/tal_abort_2-small.gif\t621\n/history/apollo/apollo-sa.html\t620\n/software/winvn/userguide/wvnguide.gif\t615\n/images/landing-logo.gif\t614\n/shuttle/technology/sts-newsref/et.html\t611\n/images/opf-logo.gif\t608\n/history/gemini/movies/gemini-launch.mpg\t604\n/shuttle/missions/sts-75/sts-75-patch-small.gif\t602\n/shuttle/technology/images/et_1-small.gif\t599\n/shuttle/missions/51-l/movies/\t598\n/history/apollo/apollo-13/apollo-13-patch.jpg\t598\n/images/dual-pad.gif\t597\n/shuttle/technology/sts-newsref/spacelab.html\t597\n/shuttle/technology/images/et-lox_1-small.gif\t596\n/history/apollo/apollo-13/images/index.gif\t595\n/shuttle/missions/sts-71/sts-71-press-kit.txt\t594\n/shuttle/missions/sts-62/sts-62-patch-small.gif\t592\n/history/apollo/apollo-8/apollo-8.html\t583\n/history/apollo/apollo-10/apollo-10.html\t580\n/history/apollo/images/little-joe.gif\t577\n/history/apollo/apollo-7/apollo-7.html\t573\n/shuttle/technology/sts-newsref/mission_profile.html\t571\n/facilities/crawler.html\t566\n/history/mercury/mercury-spacecraft.txt\t561\n/shuttle/missions/sts-76/mission-sts-76.html\t558\n/history/apollo/apollo-1/apollo-1-info.html\t556\n/history/apollo/apollo-8/apollo-8-patch-small.gif\t551\n/shuttle/technology/sts-newsref/stsover-launch.html\t545\n/history/apollo/apollo-14/apollo-14.html\t544\n/history/apollo/apollo-10/apollo-10-patch-small.gif\t532\n/persons/nasa-cm/jmd.html\t532\n/shuttle/missions/sts-70/images/DSC-95EC-0001.gif\t532\n/shuttle/missions/sts-77/mission-sts-77.html\t532\n/history/apollo/apollo-13/docs/\t531\n/elv/DELTA/delta.htm\t529\n/history/apollo/apollo-1/\t529\n/history/apollo/apollo-13/movies/apo13damage.mpg\t529\n/history/apollo/apollo-15/apollo-15.html\t528\n/history/apollo/apollo-7/apollo-7-patch-small.gif\t527\n/shuttle/technology/sts-newsref/sts_egress.html\t523\n/shuttle/technology/sts-newsref/sts-eps.html\t521\n/history/apollo/apollo-12/apollo-12.html\t520\n/shuttle/technology/sts-newsref/stsover.html\t515\n/elv/vidpicp.htm\t511\n/shuttle/missions/sts-69/images/KSC-95EC-0760.gif\t509\n/shuttle/missions/sts-59/sts-59-patch-small.gif\t508\n/shuttle/technology/sts-newsref/centers.html\t508\n/history/apollo/images/footprint.gif\t504\n/facilities/spaceport.html\t504\n/history/apollo/apollo-11/apollo-11-info.html\t503\n/elv/DELTA/delta_lo.gif\t501\n/facts/faq12.html\t499\n/mdss/station.gif\t498\n/shuttle/missions/61-b/61-b-patch-small.gif\t496\n/shuttle/technology/sts-newsref/sts-av.html\t495\n/history/apollo/apollo-14/apollo-14-patch-small.gif\t493\n/history/apollo/apollo-12/apollo-12-patch-small.gif\t493\n/shuttle/missions/sts-69/images/KSC-95EC-0969.jpg\t492\n/history/apollo/apollo-13/images/70HC314.GIF\t492\n/mdss/s_delta2.gif\t491\n/shuttle/missions/sts-53/movies/sts-53-launch.mpg\t490\n/statistics/statistics.html\t488\n/shuttle/\t487\n/shuttle/missions/sts-64/sts-64-patch-small.gif\t487\n/shuttle/missions/61-b/mission-61-b.html\t485\n/history/apollo/apollo-13/sounds/a13_002.wav\t478\n/history/apollo/apollo-15/apollo-15-patch-small.gif\t476\n/shuttle/missions/sts-73/sts-73-info.html\t476\n/mdss/dcy2.gif\t475\n/shuttle/missions/sts-76/sts-76-patch-small.gif\t471\n/facilities/spaceport-logo-small.gif\t469\n/shuttle/missions/sts-71/images/KSC-95EC-0911.jpg\t468\n/history/apollo/images/apollo-insignia.gif\t464\n/elv/DELTA/del181s.gif\t464\n/shuttle/missions/sts-73/news/\t462\n/history/apollo/apollo-13/news/\t461\n/images/kscarea-small.gif\t461\n/shuttle/countdown/count70.gif\t460\n/elv/TITAN/mars1s.jpg\t455\n/msfc/astro_home3.gif\t454\n/shuttle/countdown/images/countclock.jpeg\t453\n/persons/nasa-cm/jmd.gif\t452\n/icon/new01.gif\t452\n/elv/TITAN/mars2s.jpg\t451\n/shuttle/missions/sts-26/mission-sts-26.html\t449\n/shuttle/missions/sts-77/sts-77-patch-small.gif\t449\n/elv/TITAN/mars3s.jpg\t449\n/msfc/astro_home.html\t448\n/shuttle/technology/sts-newsref/sts-jsc-comm.html\t446\n/elv/ATLAS_CENTAUR/acsuns.jpg\t444\n/elv/DELTA/dsolidss.jpg\t444\n/elv/ATLAS_CENTAUR/atc69s.jpg\t442\n/history/apollo/apollo-4/apollo-4.html\t441\n/shuttle/missions/sts-67/images/images.html\t440\n/history/apollo/apollo-11/images/\t440\n/elv/ATLAS_CENTAUR/goess.jpg\t438\n/history/apollo/apollo-5/apollo-5.html\t438\n/shuttle/missions/sts-71/movies/sts-71-tcdt-crew-walkout.mpg\t437\n/shuttle/countdown\t435\n/elv/uncons.htm\t433\n/images/slf-logo.gif\t433\n/finance//brrow_1t.gif\t432\n/shuttle/missions/sts-70/images/DSC-95EC-0001.jpg\t430\n/elv/DELTA/rosats.jpg\t429\n/history/apollo/apollo-11/\t428\n/elv/DELTA/euves.jpg\t427\n/shuttle/missions/sts-71/movies/sts-71-mir-dock.mpg\t426\n/elv/SCOUT/radcals.jpg\t426\n/facilities/slf.html\t425\n/history/apollo/apollo-9/apollo-9.html\t425\n/shuttle/missions/sts-70/movies/sts-70-launch.mpg\t425\n/history/mercury/ma-6/ma-6.html\t421\n/history/mercury/mr-4/mr-4.html\t416\n/elv/SCOUT/s_216s.jpg\t413\n/shuttle/missions/51-l/sounds/\t412\n/shuttle/missions/sts-71/images/KSC-95EC-0912.jpg\t411\n/history/mercury/flight-summary.txt\t410\n/shuttle/missions/sts-69/movies/ws-animation-onorbit.mpg\t410\n/history/apollo/apollo-5/apollo-5-patch-small.gif\t410\n/elv/SCOUT/sampexs.jpg\t410\n/shuttle/technology/sts-newsref/stsover-missions.html\t409\n/shuttle/missions/sts-70/woodpecker.html\t407\n/history/apollo/as-201/as-201.html\t406\n/history/apollo/apollo-4/apollo-4-patch-small.gif\t406\n/history/apollo/apollo-9/apollo-9-patch-small.gif\t404\n/shuttle/technology/sts-newsref/sts-gnnc.html\t402\n/shuttle/missions/sts-2/mission-sts-2.html\t401\n/history/gemini/gemini-spacecraft.txt\t401\n/shuttle/missions/sts-69/movies/sts-69-payloads.mpg\t397\n/shuttle/missions/51-l/images/86HC159.GIF\t397\n/shuttle/missions/51-l/images/850128.GIF\t395\n/shuttle/missions/51-l/news/\t393\n/history/skylab/skylab-4.html\t390\n/shuttle/missions/sts-70/images/holes-in-et.gif\t384\n/shuttle/missions/sts-26/sts-26-patch-small.gif\t382\n/history/apollo/apollo-16/apollo-16.html\t381\n/history/apollo/apollo-1/images/\t376\n/images/NASA-logo.gif\t374\n/history/mercury/ma-6/ma-6-patch-small.gif\t374\n/history/apollo/as-201/as-201-patch-small.gif\t373\n/shuttle/missions/51-l/images/86HC68.GIF\t372\n/shuttle/technology/sts-newsref/stsover-prep.html\t371\n/history/skylab/skylab-2.html\t371\n/shuttle/missions/sts-70/images/woodpecker-on-et.gif\t371\n/history/mercury/mr-4/mr-4-patch-small.gif\t369\n/history/mercury/ma-9/ma-9.html\t364\n/history/skylab/skylab-station.txt\t360\n/images/rollout.gif\t359\n/history/apollo/apollo-6/apollo-6.html\t358\n/facts/faq10.html\t356\n/history/gemini/gemini-3/gemini-3.html\t356\n/history/apollo/apollo-13/images/70HC431.GIF\t356\n/shuttle/missions/sts-74/sts-74-info.html\t355\n/shuttle/missions/51-l/docs/\t354\n/history/apollo/apollo-16/apollo-16-patch-small.gif\t353\n/shuttle/missions/sts-71/images/KSC-95EC-0913.jpg\t353\n/shuttle/missions/51-l/images/86HC125.GIF\t352\n/shuttle/missions/sts-2/sts-2-patch-small.gif\t350\n/elv/uplink.htm\t348\n/shuttle/technology/sts-newsref/sts-apu.html\t347\n/shuttle/resources/orbiters/endeavour.gif\t346\n/history/mercury/mercury-overview.txt\t345\n/history/skylab/skylab-4-small.gif\t342\n/history/gemini/gemini-xii/gemini-xii.html\t341\n/shuttle/missions/sts-37/sts-37-patch-small.gif\t339\n/software/winvn/userguide/docsleft.gif\t338\n/shuttle/missions/sts-61/mission-sts-61.html\t338\n/shuttle/missions/sts-37/mission-sts-37.html\t338\n/history/apollo/apollo-17/apollo-17-info.html\t337\n/software/winvn/userguide/docscont.gif\t336\n/shuttle/missions/51-l/images/86HC119.GIF\t334\n/history/mercury/ma-9/ma-9-patch-small.gif\t334\n/software/winvn/userguide/docsrigh.gif\t333\n/history/mercury/mercury-goals.txt\t332\n/software/winvn/\t330\n/images/kscmap.gif\t329\n/shuttle/missions/100th.html\t329\n/images\t327\n/shuttle/technology/sts-newsref/sts-subs.html\t324\n/shuttle/missions/sts-73/\t324\n/history/apollo/apollo-6/apollo-6-patch-small.gif\t322\n/shuttle/missions/sts-74/\t322\n/statistics/images/newstat.gif\t322\n/history/apollo/apollo-13/images/70HC323.GIF\t321\n/images/nasa-logo.gif\t319\n/procurement/midrange/equip.htm\t318\n/history/apollo/apollo-13/images/70HC418.GIF\t318\n/shuttle/missions/sts-70/images/KSC-95EC-1012.jpg\t318\n/history/apollo/apollo-17/\t317\n/software/winvn/faq/WINVNFAQ-I-6.html\t315\n/shuttle/missions/sts-70/images/KSC-95EC-0515.gif\t314\n/shuttle/missions/sts-71/images/KSC-95EC-0915.jpg\t313\n/shuttle/missions/sts-73/news\t312\n/shuttle/missions/sts-9/mission-sts-9.html\t312\n/images/landing.jpg\t311\n/images/oldtower.gif\t310\n/history/gemini/gemini-xii/gemini-xii-patch-small.gif\t310\n/history/skylab/skylab-1.html\t309\n/shuttle/missions/sts-69/images/KSC-95EC-0969.gif\t307\n/shuttle/missions/sts-71/images/KSC-95EC-0423.gif\t307\n/history/gemini/gemini-3/gemini-3-patch-small.gif\t306\n/shuttle/missions/sts-71/images/index71.gif\t304\n/elv/whnew.htm\t304\n/images/launchpalms.gif\t301\n/history/astp/astp-spacecraft.txt\t299\n/htbin/wais.pl?TISP\t299\n/shuttle/technology/sts-newsref/sts-jsc.html\t296\n/shuttle/missions/sts-70/movies/sts-70-launch-srbsep.mpg\t295\n/history/apollo/apollo-11/movies/\t295\n/facts/faq11.html\t295\n/shuttle/missions/sts-27/mission-sts-27.html\t294\n/shuttle/missions/sts-71/movies/sts-71-landing.mpg\t287\n/shuttle/missions/sts-27/sts-27-patch-small.gif\t287\n/shuttle/missions/sts-71/images/KSC-95EC-0911.gif\t283\n/shuttle/missions/sts-74/news/\t282\n/shuttle/missions/sts-61/sts-61-patch-small.gif\t282\n/shuttle/missions/sts-70/images/KSC-95EC-1017.jpg\t282\n/images/IMPACT.JPG\t281\n/shuttle/missions/51-j/mission-51-j.html\t280\n/htbin/wais.pl?IMAX\t279\n/shuttle/missions/sts-6/sts-6-patch-small.gif\t278\n/images/cm-logo.gif\t278\n/shuttle/missions/sts-71/images/KSC-95EC-0916.jpg\t278\n/history/apollo/apollo-13/images/70HC517.GIF\t277\n/history/gemini/flight-summary.txt\t276\n/shuttle/technology/sts-newsref/sts_sys.html\t276\n/shuttle/missions/41-d/mission-41-d.html\t274\n/history/apollo/apollo-17/images/\t274\n/shuttle/missions/sts-6/mission-sts-6.html\t274\n/shuttle/missions/sts-70/images/KSC-95EC-1016.jpg\t273\n/history/apollo/apollo-13/images/70HC464.GIF\t272\n/history/mercury/ma-7/ma-7.html\t272\n/history/gemini/gemini-v/gemini-v.html\t272\n/shuttle/missions/51-j/51-j-patch-small.gif\t271\n/shuttle/missions/sts-71/sts-71-patch.jpg\t271\n/shuttle/missions/sts-34/mission-sts-34.html\t269\n/shuttle/technology/sts-newsref/sts-inst.html\t269\n/shuttle/missions/sts-70/countdown.html\t268\n/shuttle/missions/sts-70/images/KSC-95EC-0515.jpg\t268\n/persons/astronauts/u-to-z/YoungJW.txt\t268\n/history/apollo/apollo-1/movies/\t267\n/shuttle/missions/sts-71/images/KSC-95EC-0917.jpg\t266\n/shuttle/missions/61-a/mission-61-a.html\t262\n/shuttle/missions/sts-9/sts-9-patch-small.gif\t262\n/images/263_small.jpg\t261\n/shuttle/missions/41-d/41-d-patch-small.gif\t260\n/shuttle/missions/sts-70/images/index70.gif\t260\n/shuttle/missions/sts-70/images/KSC-95EC-1018.jpg\t259\n/shuttle/countdown/lps/osr/osr.html\t258\n/shuttle/missions/sts-71/images/KSC-95EC-0951.jpg\t257\n/shuttle/missions/sts-70/images/KSC-95EC-1014.jpg\t255\n/shuttle/missions/sts-71/movies/sts-71-rollover.mpg\t254\n/shuttle/missions/sts-71/images/KSC-95EC-0423.jpg\t254\n/history/mercury/ma-8/ma-8.html\t253\n/shuttle/missions/sts-70/images/KSC-95EC-1013.jpg\t251\n/shuttle/missions/sts-68/ksc-upclose.gif\t251\n/shuttle/missions/51-c/mission-51-c.html\t251\n/history/apollo/apollo-13/images/70HC353.GIF\t250\n/history/apollo/apollo-13/movies/apo13launch.mpg\t249\n/history/apollo/sa-1/sa-1.html\t249\n/shuttle/missions/sts-69/images/\t248\n/history/gemini/gemini-1/gemini-1.html\t248\n/shuttle/missions/sts-71/images/KSC-95EC-0918.jpg\t247\n/facts/faq01.html\t247\n/shuttle/missions/sts-71/images/KSC-95EC-0948.jpg\t247\n/shuttle/missions/sts-71/movies/sts-71-mir-dock-2.mpg\t247\n/images/bluemarb.gif\t245\n/images/vab-medium.gif\t244\n/shuttle/missions/41-b/mission-41-b.html\t243\n/shuttle/missions/sts-70/count70.gif\t242\n/history/gemini/gemini-v/gemini-v-patch-small.gif\t242\n/shuttle/missions/sts-35/mission-sts-35.html\t242\n/shuttle/missions/sts-60/mission-sts-60.html\t241\n/history/apollo/apollo-1/images/66HC1519.gif\t241\n/history/mercury/ma-7/ma-7-patch-small.gif\t241\n/shuttle/missions/51-c/51-c-patch-small.gif\t240\n/shuttle/missions/41-b/41-b-patch-small.gif\t239\n/procurement/midrange/rfo.htm\t238\n/history/apollo/apollo-1/sounds/\t238\n/statistics/1995/Jul/Jul95.html\t238\n/history/apollo/apollo-13/sounds/a13_003.wav\t238\n/history/apollo/apollo-13/sounds/a13_001.wav\t237\n/finance/pmarcube.gif\t235\n/shuttle/missions/sts-70/sts-70-patch.jpg\t235\n/shuttle/missions/sts-3/mission-sts-3.html\t235\n/history/skylab/skylab.jpg\t234\n/shuttle/missions/61-a/61-a-patch-small.gif\t233\n/finance/bmarcube.gif\t233\n/history/gemini/gemini-vii/gemini-vii.html\t232\n/elv/movie.htm\t232\n/shuttle/technology/sts-newsref/sts-ovcomm.html\t231\n/history/skylab/skylab-3.html\t231\n/history/apollo/apollo-13/images/70HC467.GIF\t230\n/history/apollo/apollo-13/images/70HC496.GIF\t229\n/history/astp/flight-summary.txt\t229\n/shuttle/missions/51-l/51-l-crew.gif\t228\n/htbin/wais.pl?51-L\t226\n/history/gemini/gemini-viii/gemini-viii.html\t226\n/history/skylab/skylab-goals.txt\t225\n/history/gemini/gemini-goals.txt\t225\n/history/\t225\n/shuttle/missions/sts-missions-flown.txt\t224\n/history/apollo/apollo-1/news/\t223\n/history/apollo/apollo-11/sounds/\t223\n/elv/TITAN/titan.htm\t223\n/payloads/cm-systems.html\t223\n/history/skylab/flight-summary.txt\t222\n/shuttle/missions/sts-70/images/KSC-95EC-0768.jpg\t222\n/shuttle/missions/sts-70/images/KSC-95EC-1059.jpg\t221\n/shuttle/missions/sts-34/sts-34-patch-small.gif\t221\n/history/mercury/ma-8/ma-8-patch-small.gif\t221\n/shuttle/missions/sts-70/images/DSC-95EC-0006.jpg\t220\n/shuttle/missions/sts-73/news/sts-73-mir-01.txt\t220\n/shuttle/missions/41-g/mission-41-g.html\t220\n/elv/DELTA/dedesc.htm\t219\n/shuttle/missions/sts-7/mission-sts-7.html\t219\n/shuttle/technology/sts-newsref/sts-oms.html\t219\n/shuttle/missions/sts-57/mission-sts-57.html\t217\n/shuttle/missions/sts-51/mission-sts-51.html\t216\n/shuttle/missions/sts-71/movies/sts-71-launch-2.mpg\t215\n/history/gemini/gemini-4/gemini-4.html\t214\n/history/mercury/mr-3/mr-3-patch.gif\t213\n/shuttle/missions/sts-69/images/KSC-95EC-0694.txt\t213\n/history/apollo/apollo-13/sounds/a13_004.wav\t213\n/shuttle/missions/sts-35/sts-35-patch-small.gif\t213\n/shuttle/missions/sts-7/sts-7-patch-small.gif\t213\n/history/apollo/apollo-11/apollo-11-patch.jpg\t213\n/shuttle/missions/sts-71/sts-71-info.html\t211\n/shuttle/missions/sts-51/sts-51-patch-small.gif\t210\n/shuttle/technology/sts-newsref/sts-rcs.html\t209\n/software/\t209\n/elv/DELTA/uncons.htm\t209\n/shuttle/missions/sts-40/mission-sts-40.html\t207\n/shuttle/missions/sts-29/sts-29-patch-small.gif\t206\n/history/apollo/as-203/as-203.html\t206\n/shuttle/missions/51-f/mission-51-f.html\t205\n/software/winvn/faq/WINVNFAQ-I-3.html\t205\n/history/gemini/gemini-1/gemini-1-patch-small.gif\t204\n/shuttle/missions/sts-70/images/KSC-95EC-1019.jpg\t204\n/shuttle/missions/sts-29/mission-sts-29.html\t203\n/shuttle/missions/sts-78/\t203\n/shuttle/missions/51-b/mission-51-b.html\t203\n/shuttle/missions/sts-41/mission-sts-41.html\t203\n/shuttle/missions/sts-8/mission-sts-8.html\t203\n/history/gemini/gemini-vii/gemini-vii-patch-small.gif\t203\n/shuttle/missions/sts-31/mission-sts-31.html\t202\n/shuttle/missions/sts-60/sts-60-patch-small.gif\t202\n/shuttle/technology/sts-newsref/sts-rhc.html\t202\n/shuttle/missions/51-g/mission-51-g.html\t201\n/images/crawler.gif\t201\n/shuttle/missions/51-g/51-g-patch-small.gif\t201\n/shuttle/missions/sts-28/mission-sts-28.html\t200\n/shuttle/missions/sts-4/mission-sts-4.html\t200\n/history/apollo/sa-1/sa-1-patch-small.gif\t200\n/history/skylab/skylab-operations.txt\t199\n/facts/faq07.html\t199\n/shuttle/missions/sts-55/mission-sts-55.html\t199\n/shuttle/missions/51-d/51-d-patch-small.gif\t198\n/history/apollo/apollo-13/images/70HC507.GIF\t198\n/shuttle/missions/sts-5/sts-5-patch-small.gif\t198\n/shuttle/missions/sts-28/sts-28-patch-small.gif\t198\n/history/apollo/apollo-8/apollo-8-info.html\t197\n/images/mlp.gif\t197\n/shuttle/resources/orbiters/pathfinder.html\t197\n/shuttle/missions/sts-3/sts-3-patch-small.gif\t197\n/history/apollo/as-202/as-202.html\t196\n/elv/ATLAS_CENTAUR/atlcent.htm\t196\n/shuttle/missions/sts-47/mission-sts-47.html\t196\n/shuttle/missions/51-d/mission-51-d.html\t196\n/shuttle/missions/51-i/mission-51-i.html\t195\n/shuttle/missions/sts-71/images/KSC-95EC-0946.jpg\t195\n/elv/koreamin.gif\t194\n/shuttle/missions/sts-71/images/KSC-95EC-0912.gif\t193\n/history/apollo/apollo-13/movies/apo13home.mpg\t193\n/shuttle/missions/51-a/mission-51-a.html\t192\n/shuttle/technology/sts-newsref/sts-acronyms.html\t191\n/shuttle/missions/sts-72/\t191\n/shuttle/missions/sts-70/images/KSC-95EC-1060.jpg\t190\n/shuttle/missions/sts-39/mission-sts-39.html\t190\n/history/gemini/gemini-viii/gemini-viii-patch-small.gif\t189\n/history/apollo/apollo-11/images/index.gif\t189\n/history/apollo/apollo-1/images/67HC33a.gif\t188\n/history/apollo/as-203/as-203-patch-small.gif\t188\n/shuttle/missions/41-g/41-g-patch-small.gif\t188\n/shuttle/missions/41-c/mission-41-c.html\t188\n/statistics/1995/Jul/Jul95_request.gif\t187\n/shuttle/missions/sts-30/mission-sts-30.html\t187\n/history/gemini/gemini-x/gemini-x.html\t187\n/shuttle/missions/sts-57/sts-57-patch-small.gif\t187\n/history/apollo/apollo-13/movies/apo13inside.mpg\t186\n/shuttle/missions/sts-70/images/KSC-95EC-0649.jpg\t186\n/statistics/1995/Jul/Jul95_byte.gif\t186\n/shuttle/missions/sts-50/mission-sts-50.html\t185\n/history/apollo/apollo-1/docs/\t185\n/shuttle/missions/sts-70/images/KSC-95EC-1012.gif\t185\n/history/apollo/as-202/as-202-patch-small.gif\t183\n/history/apollo/apollo-12/\t183\n/images/imagemaps/\t183\n/shuttle/missions/sts-71/movies/sts-71-hand-shake.mpg\t182\n/history/gemini/gemini-vi-a/gemini-vi-a.html\t182\n/history/gemini/gemini-overview.txt\t182\n/shuttle/missions/sts-69/images/KSC-95EC-1032.txt\t181\n/images/KSC-94EC-412.jpg\t181\n/history/gemini/gemini-4/gemini-4-patch-small.gif\t180\n/shuttle/technology/sts-newsref/sts-msfc.html\t180\n/shuttle/missions/sts-5/mission-sts-5.html\t179\n/shuttle/missions/51-l/51-l-patch.jpg\t179\n/shuttle/missions/sts-70/images/KSC-95EC-1015.jpg\t179\n/shuttle/missions/sts-56/mission-sts-56.html\t179\n/shuttle/missions/sts-39/sts-39-patch-small.gif\t178\n/shuttle/missions/sts-71/sts-71-day-01-highlights.html\t178\n/shuttle/missions/51-i/51-i-patch-small.gif\t177\n/shuttle/missions/sts-69/movies/\t176\n/shuttle/missions/sts-55/sts-55-patch-small.gif\t176\n/shuttle/missions/51-b/51-b-patch-small.gif\t174\n/shuttle/missions/sts-8/sts-8-patch-small.gif\t172\n/history/apollo/apollo-1/images/67HC21.gif\t172\n/facilities/lps.html\t171\n/shuttle/missions/51-f/51-f-patch-small.gif\t171\n/shuttle/technology/sts-newsref/sts-caws.html\t171\n/shuttle/technology/sts-newsref/sts_eclss.html\t170\n/shuttle/missions/sts-40/sts-40-patch-small.gif\t170\n/shuttle/missions/sts-71/images/KSC-95EC-0443.jpg\t169\n/shuttle/missions/sts-45/sts-45-patch-small.gif\t169\n/software/winvn/faq/WINVNFAQ-I-7.html\t169\n/facilities/mila.html\t169\n/shuttle/missions/sts-4/sts-4-patch-small.gif\t169\n/shuttle/missions/sts-41/sts-41-patch-small.gif\t168\n/shuttle/missions/51-a/51-a-patch-small.gif\t168\n/shuttle/missions/sts-72/sts-72-info.html\t167\n/shuttle/missions/sts-70/sts-70-press-kit.txt\t167\n/history/apollo/apollo-14/apollo-14-info.html\t166\n/shuttle/missions/sts-71/count71.gif\t166\n/://spacelink.msfc.nasa.gov\t166\n/shuttle/countdown/lps/mstr/mstr.html\t166\n/shuttle/missions/sts-71/images/KSC-95EC-0913.gif\t165\n/msfc/onboard/come_aboard.gif\t165\n/history/gemini/gemini-x/gemini-x-patch-small.gif\t165\n/shuttle/missions/sts-73/images/\t165\n/history/apollo/apollo-12/apollo-12-info.html\t164\n/shuttle/missions/sts-70/movies/sts-70-landing-2.mpg\t163\n/shuttle/missions/sts-31/sts-31-patch-small.gif\t163\n/shuttle/missions/sts-52/mission-sts-52.html\t163\n/shuttle/missions/sts-30/sts-30-patch-small.gif\t163\n/history/apollo/apollo-14/\t163\n/shuttle/missions/sts-70/images/KSC-95EC-1020.jpg\t163\n/images/shuttle2.gif\t162\n/shuttle/missions/sts-71/images/KSC-95EC-0915.gif\t162\n/shuttle/missions/sts-71/countdown.html\t162\n/shuttle/missions/sts-45/mission-sts-45.html\t162\n/history/apollo/apollo-11/sounds/A01106AA.WAV\t162\n/shuttle/missions/sts-71/images/KSC-95EC-0950.jpg\t161\n/shuttle/resources/orbiters/mpta-098.html\t161\n/history/gemini/gemini-vi-a/gemini-vi-a-patch-small.gif\t161\n/shuttle/missions/sts-56/sts-56-patch-small.gif\t160\n/shuttle/missions/sts-47/sts-47-patch-small.gif\t160\n/images/lps-small.gif\t160\n/images/crawlerway-logo.gif\t160\n/history/apollo/apollo-13/videos/\t159\n/shuttle/missions/sts-71/images/KSC-95EC-0613.jpg\t159\n/history/apollo/apollo-17/movies/\t159\n/images/shuttle-patch.jpg\t159\n/shuttle/missions/sts-53/mission-sts-53.html\t158\n/history/apollo/apollo-1/images/67HC33.gif\t158\n/shuttle/missions/sts-70/movies/sts-70-launch-press.mpg\t158\n/shuttle/movies/TDRSopen.mpg\t157\n/history/astp/astp-goals.txt\t157\n/shuttle/missions/sts-69/rsrm-joint.jpeg\t157\n/history/apollo/apollo-11/images/690700.GIF\t157\n/software/winvn/faq/WINVNFAQ-I-2.html\t157\n/history/apollo/apollo-1/images/67HC31.gif\t157\n/facilities/milapict.gif\t157\n/shuttle/missions/sts-70/images/KSC-95EC-1013.gif\t156\n/history/gemini/gemini-ix-a/gemini-ix-a.html\t156\n/shuttle/technology/sts-newsref/sts-eclss-wcl.html\t156\n/history/apollo/apollo-1/images/apollo-1-crew.gif\t155\n/shuttle/missions/sts-32/mission-sts-32.html\t155\n/shuttle/missions/41-c/41-c-patch-small.gif\t155\n/images/kscmap-logo.gif\t154\n/shuttle/missions/sts-32/sts-32-patch-small.gif\t154\n/history/apollo/a-001/a-001-patch-small.gif\t154\n/images/flight-deck.gif\t153\n/shuttle/missions/sts-50/sts-50-patch-small.gif\t153\n/shuttle/missions/sts-54/mission-sts-54.html\t152\n/shuttle/missions/sts-58/mission-sts-58.html\t152\n/finance/search.htm\t151\n/images/STS-5.JPG\t151\n/shuttle/missions/sts-74/news\t150\n/history/apollo/apollo-13/sounds/a13_005.wav\t150\n/shuttle/missions/sts-46/sts-46-patch-small.gif\t150\n/shuttle/countdown/lps/images/MASTER.gif\t150\n/shuttle/missions/sts-36/mission-sts-36.html\t150\n/shuttle/missions/sts-71/sts-71-day-03-highlights.html\t149\n/elv/TITAN/tit2desc.htm\t149\n/elv/DELTA/deprev.htm\t148\n/history/apollo/apollo-15/apollo-15-info.html\t148\n/history/gemini/gemini-xi/gemini-xi.html\t147\n/shuttle/missions/sts-71/images/KSC-95EC-0589.jpg\t147\n/images/landing-747.gif\t147\n/shuttle/missions/sts-46/mission-sts-46.html\t147\n/software/winvn/faq/WINVNFAQ-I-4.html\t147\n/shuttle/missions/sts-70/images/KSC-95EC-0635.jpg\t147\n/shuttle/missions/sts-70/images/KSC-95EC-1017.gif\t146\n/facts/launch-pass.txt\t146\n/history/gemini/gemini-2/gemini-2.html\t145\n/history/apollo/sa-10/sa-10.html\t145\n/history/apollo/pad-abort-test-1/pad-abort-test-1-patch-small.gif\t144\n/facilities/milaptch.gif\t144\n/shuttle/missions/sts-48/mission-sts-48.html\t144\n/finance/travel.htm\t144\n/elv/TITAN/titdesc.htm\t144\n/shuttle/countdown/launch-team.html\t143\n/shuttle/missions/sts-70/images/KSC-95EC-1058.jpg\t143\n/shuttle/missions/sts-70/images/KSC-95EC-1018.gif\t143\n/facilities/pdlpict.gif\t142\n/shuttle/missions/sts-70/images/KSC-95EC-1056.jpg\t141\n/shuttle/missions/sts-36/sts-36-patch-small.gif\t141\n/history/apollo/pad-abort-test-1/pad-abort-test-1.html\t140\n/shuttle/missions/sts-70/sts-70-day-01-highlights.html\t140\n/shuttle/technology/sts-newsref/sts-tps.html\t140\n/shuttle/missions/sts-71/images/KSC-95EC-0951.gif\t140\n/shuttle/missions/sts-70/images/KSC-95EC-1016.gif\t140\n/shuttle/missions/sts-33/sts-33-patch-small.gif\t140\n/shuttle/missions/sts-48/sts-48-patch-small.gif\t139\n/images/gemini.gif\t139\n/shuttle/missions/sts-38/sts-38-patch-small.gif\t139\n/shuttle/countdown/lps/aa/aa.html\t138\n/shuttle/missions/sts-70/images/KSC-95EC-1057.jpg\t138\n/shuttle/technology/sts-newsref/sts-gear.html\t137\n/shuttle/missions/sts-38/mission-sts-38.html\t137\n/history/gemini/gemini-xi/gemini-xi-patch-small.gif\t137\n/shuttle/missions/sts-71/images/KSC-95EC-0918.gif\t137\n/shuttle/missions/sts-70/images/KSC-95EC-0768.gif\t136\n/shuttle/missions/sts-70/images/KSC-95EC-0667.jpg\t136\n/history/apollo/apollo-12/images/\t136\n/procurement/expo95.htm\t135\n/shuttle/missions/sts-70/movies/sts-70-tdrs-deploy.mpg\t135\n/statistics/1995/Aug/Aug95.html\t135\n/shuttle\t135\n/cgi-bin/imagemap/countdown69\t134\n/msfc/onboard/onboard.html\t134\n/images/cdrom-1-95/\t134\n/shuttle/missions/sts-71/images/KSC-95EC-0916.gif\t134\n/shuttle/missions/sts-53/sts-53-patch-small.gif\t134\n/shuttle/missions/sts-33/mission-sts-33.html\t134\n/shuttle/missions/sts-70/images/KSC-95EC-1014.gif\t134\n/shuttle/missions/sts-58/sts-58-patch-small.gif\t133\n/shuttle/missions/sts-71/movies/sts-71-undocking.mpg\t133\n/statistics/images/statsm.gif\t133\n/statistics/images/getstats_big.gif\t132\n/shuttle/missions/sts-52/sts-52-patch-small.gif\t132\n/history/apollo/apollo-17/images/721200.GIF\t131\n/shuttle/missions/sts-43/mission-sts-43.html\t131\n/elv/PEGASUS/pegdesc.htm\t130\n/shuttle/missions/sts-42/mission-sts-42.html\t129\n/shuttle/missions/sts-70/images/KSC-95EC-0852.jpg\t129\n/shuttle/technology/sts-newsref/sts-lc39.html\t128\n/history/apollo/apollo-14/images/\t127\n/history/apollo/a-001/a-001.html\t127\n/history/apollo/apollo-15/images/\t126\n/statistics/1995/Aug/Aug95_request.gif\t126\n/shuttle/missions/sts-42/sts-42-patch-small.gif\t126\n/shuttle/missions/sts-44/mission-sts-44.html\t125\n/history/gemini/gemini-ix-a/gemini-ix-a-patch-small.gif\t125\n/statistics/1995/Aug/Aug95_byte.gif\t124\n/facilities/crawlerway.html\t124\n/shuttle/missions/sts-43/sts-43-patch-small.gif\t124\n/history/apollo/apollo-17/images/72HC670.GIF\t123\n/elv/DELTA/delseps.jpg\t123\n/history/apollo/apollo-8/images/\t123\n/images/oc.gif\t123\n/shuttle/missions/sts-54/sts-54-patch-small.gif\t123\n/shuttle/resources/orbiters/columbia.gif\t122\n/shuttle/technology/sts-newsref/carriers.html\t122\n/shuttle/missions/sts-71/images/KSC-95EC-0917.gif\t121\n/history/apollo/apollo-16/apollo-16-info.html\t121\n/cgi-bin/geturlstats.pl\t121\n/facilities/oc.html\t121\n/shuttle/missions/sts-1/sts-1-info.html\t120\n/shuttle/missions/sts-71/sts-71-day-04-highlights.html\t120\n/history/gemini/gemini-2/gemini-2-patch-small.gif\t120\n/persons/astronauts/a-to-d/BoldenCF.txt\t120\n/shuttle/missions/sts-71/images/KSC-95EC-0544.jpg\t120\n/shuttle/missions/sts-78/sts-78-info.html\t120\n/shuttle/missions/sts-71/movies/sts-71-rollout.mpg\t119\n/msfc/onboard/colorbar.gif\t119\n/finance/gvtlinks.htm\t119\n/shuttle/missions/sts-1/\t118\n/shuttle/missions/sts-44/sts-44-patch-small.gif\t118\n/shuttle/missions/sts-70/images/KSC-95EC-1059.gif\t118\n/shuttle/missions/sts-70/images/KSC-95EC-0649.gif\t118\n/msfc/onboard/redball.gif\t117\n/elv/ATLAS_CENTAUR/atc69.jpg\t117\n/history/apollo/apollo-15/\t117\n/mdss/s_md-1.gif\t116\n/shuttle/missions/sts-70/images/KSC-95EC-0585.jpg\t116\n/shuttle/countdown/images/KSC-81EC-84.gif\t116\n/shuttle/missions/sts-74/images/\t116\n/software/winvn/faq/WINVNFAQ-I-5.html\t116\n/shuttle/missions/sts-73/sts-73-patch.jpg\t116\n/shuttle/missions/sts-69/movies/sts-69-crew-arrival.mpg\t116\n/elv/TITAN/mars1.jpg\t115\n/shuttle/missions/sts-71/images/KSC-95EC-0443.gif\t115\n/images/index.gif\t115\n/shuttle/missions/sts-1/sts-1-patch.jpg\t114\n/welcome.html\t114\n/shuttle/missions/sts-70/movies/sts-70-landing.mpg\t114\n/shuttle/missions/sts-70/sts-70-info.html\t114\n/shuttle/missions/sts-72/news/\t114\n/history/apollo/apollo-11/sounds/A01108AA.WAV\t113\n/shuttle/missions/sts-71/images/KSC-95EC-0589.gif\t113\n/elv/DELTA/dsolids.jpg\t113\n/shuttle/missions/sts-70/images/KSC-95EC-1015.gif\t112\n/images/postit.gif\t112\n/history/apollo/apollo-17/images/73HC182.GIF\t112\n/shuttle/missions/sts-70/images/KSC-95EC-1019.gif\t112\n/images/getstats.gif\t111\n/shuttle/missions\t111\n/shuttle/technology/images/et_1.jpg\t111\n/facilities/press.html\t111\n/shuttle/missions/sts-70/movies/sts-70-roll-back-pad.mpg\t111\n/elv/DELTA/deline.gif\t111\n/finance/qmarcube.gif\t110\n/shuttle/missions/sts-71/movies/sts-71-hatch-hand-group.mpg\t110\n/shuttle/missions/sts-73/movies/\t110\n/history/apollo/apollo-16/\t110\n/elv/ATLAS_CENTAUR/acsun.jpg\t110\n/shuttle/countdown/images/lccteam.gif\t110\n/elv/UELV/ultralit.htm\t110\n/finance/other.htm\t110\n/shuttle/technology/sts-newsref/sts-eclss-airlock.html\t109\n/shuttle/missions/sts-71/images/KSC-95EC-0613.gif\t109\n/cgi-bin/newwvn-mail.pl\t109\n/history/apollo/apollo-1/apollo-1-patch.jpg\t109\n/history/apollo/apollo-8/\t109\n/shuttle/missions/sts-74/docs/\t109\n/history/apollo/apollo-11/docs/\t108\n/shuttle/missions/sts-69/docs/\t107\n/images/press-site-logo.gif\t107\n/shuttle/countdown/lps/images/AA-ROW.gif\t107\n/shuttle/missions/sts-71/images/KSC-95EC-0948.gif\t106\n/shuttle/technology/\t106\n/history/apollo/apollo-11/images/69HC680.GIF\t106\n/shuttle/technology/sts-newsref/stsover-acronyms.html\t106\n/history/apollo/apollo-16/images/\t106\n/shuttle/missions/sts-70/images/KSC-95EC-0635.gif\t106\n/images/lcc.jpg\t105\n/shuttle/missions/sts-75/sts-75-info.html\t105\n/history/apollo/apollo-11/images/69HC1119.GIF\t103\n/history/apollo/apollo-17/images/72HC181.GIF\t102\n/history/apollo/apollo-11/images/69HC635.GIF\t102\n/shuttle/countdown/lps/omr/omr.html\t102\n/statistics/1995/bkup/Mar95_full.html\t102\n/facilities/sspf.html\t102\n/shuttle/missions/sts-70/images/KSC-95EC-1060.gif\t101\n/htbin/wais.pl?STS-69\t101\n/history/apollo/apollo-11/images/69HC469.GIF\t101\n/shuttle/missions/sts-71/sts-71-day-02-highlights.html\t101\n/shuttle/missions/sts-70/sts-70-day-10-highlights.html\t99\n/shuttle/missions/sts-71/sts-71-day-11-highlights.html\t99\n/shuttle/missions/sts-71/images/KSC-95EC-0544.gif\t99\n/shuttle/countdown/lps/bkup-intg/bkup-intg.html\t99\n/history/gemini/gemini-3/gemini-3-info.html\t99\n/shuttle/missions/sts-70/images/KSC-95EC-0667.gif\t99\n/shuttle/missions/sts-71/movies/crew-arrival.mpg\t98\n/history/apollo/apollo-17/sounds/\t98\n/shuttle/missions/sts-75/\t98\n/elv/DOCS/faq.htm\t98\n/history/apollo/apollo-11/images/69HC681.GIF\t97\n/shuttle/missions/sts-78/news/\t97\n/history/apollo/images/\t97\n/images/hq.gif\t97\n/shuttle/missions/sts-70/images/KSC-95EC-0540.jpg\t97\n/shuttle/missions/manifest.txt\t97\n/shuttle/countdown/lps/ab/ab.html\t96\n/history/gemini/gemini-xii/gemini-xii-info.html\t96\n/shuttle/missions/sts-71/\t96\n/shuttle/movies/\t96\n/htbin/wais.pl?STS-73\t95\n/images/horz.gif\t95\n/history/apollo/apollo-11/images/69HC684.GIF\t95\n/history/apollo/apollo-11/images/69HC683.GIF\t95\n/images/slf.gif\t95\n/images/NASAseal-small.gif\t95\n/htbin/wais.pl?GAS\t94\n/shuttle/missions/sts-69/sounds/\t94\n/elv/ATLAS_CENTAUR/atlprev.htm\t94\n/shuttle/missions/sts-70/images/KSC-95EC-0585.gif\t94\n/shuttle/technology/sts-newsref/stsover-chron.html\t94\n/persons/nasa-cm/mtd.html\t93\n/shuttle/missions/sts-69/images/KSC-95EC-0760.txt\t93\n/history/apollo/apollo-17/images/72HC924.GIF\t93\n/shuttle/missions/sts-71/images/KSC-95EC-0946.gif\t92\n/shuttle/missions/sts-1/images/\t92\n/software/winvn/faq/WINVNFAQ-I-8.html\t91\n/finance/orgstruc.htm\t91\n/history/apollo/apollo-17/images/72HC941.GIF\t91\n/images/canister.gif\t91\n/history/apollo/apollo-17/images/72HC958.GIF\t90\n/history/apollo/apollo-11/images/69HC761.GIF\t90\n/shuttle/missions/sts-70/movies/sts-70-approach.mpg\t90\n/history/apollo/apollo-17/images/72HC981.GIF\t88\n/shuttle/missions/sts-73/docs/\t88\n/software/winvn/faq/WINVNFAQ-I.html\t88\n/software/winvn/userguide/1_2.htm\t87\n/shuttle/missions/sts-71/images/KSC-95EC-0947.jpg\t87\n/shuttle/missions/sts-70/images/KSC-95EC-1020.gif\t87\n/facts/faq06.html\t87\n/shuttle/missions/sts-71/images/KSC-95EC-0950.gif\t87\n/history/apollo/apollo-7/apollo-7-info.html\t86\n/shuttle/missions/sts-70/\t86\n/history/apollo/sa-2/sa-2.html\t86\n/history/apollo/apollo-17/images/72HC945.GIF\t85\n/images/Nasa-logo.gif\t85\n/shuttle/missions/sts-75/news/\t85\n/elv/TITAN/titprev.htm\t85\n/history/apollo/apollo-4/apollo-4-info.html\t85\n/shuttle/technology/sts-newsref/sts-oalt.html\t85\n/history/apollo/images/little-joe.jpg\t84\n/images/elv.jpg\t84\n/history/apollo/apollo-10/apollo-10-info.html\t84\n/elv/TITAN/mars3.jpg\t83\n/history/apollo/apollo-5/apollo-5-info.html\t83\n/shuttle/missions/sts-71/sts-71-day-06-highlights.html\t83\n/elv/DELTA/del181.gif\t82\n/shuttle/missions/sts-74/sts-74-patch.jpg\t82\n/history/apollo/apollo-11/images/69HC788.GIF\t82\n/shuttle/countdown/lps/images/BKUP-INT.gif\t82\n/history/apollo/apollo-11/images/69HC905.GIF\t82\n/facilities/hq.html\t82\n/history/apollo/apollo-11/news/\t82\n/shuttle/missions/sts-71/movies/sts-71-hatch-open.mpg\t82\n/shuttle/resources/orbiters/discovery.gif\t82\n/shuttle/missions/sts-71/sts-71-day-05-highlights.html\t82\n/shuttle/countdown/lps/c-1/c-1.html\t81\n/shuttle/countdown/lps/images/AB-ROW.gif\t81\n/software/winvn/userguide/3_1_1_1.htm\t81\n/history/apollo/apollo-17/images/72HC971.GIF\t81\n/history/apollo/sa-3/sa-3.html\t80\n/shuttle/resources/orbiters/atlantis.gif\t80\n/images/cm-map.gif\t80\n/software/winvn/userguide/winvn1.gif\t80\n/shuttle/technology/sts-newsref/stsover-mgt.html\t80\n/history/apollo/apollo-12/images/69HC1007.GIF\t79\n/shuttle/missions/sts-70/images/KSC-95EC-1053.jpg\t79\n/persons/nasa-cm/mtd.gif\t79\n"}]},"apps":[],"jobName":"paragraph_1533570787643_1074760000","id":"20180710-144234_141434652","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:47:57-0500","dateFinished":"2018-08-08T10:47:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"text":"%md\nComo último ejemplo, encontremos las direcciones más visitadas en el sitio. Ordenamos el DataFrame antes de realizar las gráficas, por lo que no es necesario ordenarlo nuevamente, simplemente usarémos `show()`.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Como último ejemplo, encontremos las direcciones más visitadas en el sitio. Ordenamos el DataFrame antes de realizar las gráficas, por lo que no es necesario ordenarlo nuevamente, simplemente usarémos <code>show()</code>.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787644_1072836256","id":"20180710-145443_1685396798","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"text":"%pyspark\nprint 'Las 10 direcciones mas visitadas en el sitio:'\npaths_df.show(n=10, truncate=False)","user":"hduser","dateUpdated":"2018-08-08T10:48:01-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Las 10 direcciones mas visitadas en el sitio:\n+---------------------------------------+-----+\n|path                                   |count|\n+---------------------------------------+-----+\n|/images/NASA-logosmall.gif             |97275|\n|/images/KSC-logosmall.gif              |75283|\n|/images/MOSAIC-logosmall.gif           |67356|\n|/images/USA-logosmall.gif              |66975|\n|/images/WORLD-logosmall.gif            |66351|\n|/images/ksclogo-medium.gif             |62670|\n|/ksc.html                              |43618|\n|/history/apollo/images/apollo-logo1.gif|37806|\n|/images/launch-logo.gif                |35119|\n|/                                      |30105|\n+---------------------------------------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787644_1072836256","id":"20180710-145632_2137467273","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:01-0500","dateFinished":"2018-08-08T10:48:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"text":"%md\n## Analizando el Log del servidor web\n\nAhora es tu turno de realizar algunos análisis.","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Analizando el Log del servidor web</h2>\n<p>Ahora es tu turno de realizar algunos análisis.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787645_1072451507","id":"20180710-145711_995374933","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%md\n### Top 10 de direcciones con errores\n\n¿Cuáles son las 10 direcciones que no han retronado el código 200? \n(El código de estado 200 es indicativo de que no hubo ningún error al acceder a la dirección)\n\nCrea una lista ordenada que contenga las direcciones que no han retornado el código 200 y el número de veces que se accedió a ellas.\n\nDetermina los pasos a seguir para encontrar las direcciones con código diferente al 200 y los pasos para contar unicamente esas direcciones para generar la lista ordenada.\n\n_Tips_:\n\n* Recuerda que puedes usar `filter()` para seleccionar entradas especificas usando una expresión.\n* Para hacer un conteo, deberás usar una función de agrupación en conjunto con una función de agregación.\n* Debes ordenar de forma descendente para obtener los direcciones más visitadas","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Top 10 de direcciones con errores</h3>\n<p>¿Cuáles son las 10 direcciones que no han retronado el código 200?<br/>(El código de estado 200 es indicativo de que no hubo ningún error al acceder a la dirección)</p>\n<p>Crea una lista ordenada que contenga las direcciones que no han retornado el código 200 y el número de veces que se accedió a ellas.</p>\n<p>Determina los pasos a seguir para encontrar las direcciones con código diferente al 200 y los pasos para contar unicamente esas direcciones para generar la lista ordenada.</p>\n<p><em>Tips</em>:</p>\n<ul>\n  <li>Recuerda que puedes usar <code>filter()</code> para seleccionar entradas especificas usando una expresión.</li>\n  <li>Para hacer un conteo, deberás usar una función de agrupación en conjunto con una función de agregación.</li>\n  <li>Debes ordenar de forma descendente para obtener los direcciones más visitadas</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787645_1072451507","id":"20180710-145734_904844967","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\nfrom pyspark.sql.functions import desc\n\nnot200DF= logs_df.filter(logs_df['status']!=200) #<RELLENA> #Entradas sin codigo 200\nnot200DF = not200DF.groupBy('path').count() #Contar las direcciones\nnot200DF.show(10)\n\n\nlogs_sum_df = not200DF.orderBy('count', ascending=False) #Ordenar el DataFrame para mostrar las entradas con mayor numero de visitas con codigo diferente a 200\n\nprint 'Top 10 de URLs con errores:'\nlogs_sum_df.show(10, False)","user":"hduser","dateUpdated":"2018-08-08T10:48:05-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|                path|count|\n+--------------------+-----+\n|/shuttle/missions...|    1|\n|/cgi-bin/imagemap...|    7|\n|/cgi-bin/imagemap...|   12|\n|/cgi-bin/imagemap...|    1|\n|/shuttle/missions...|    5|\n|    /mdss/s_md-2.gif|   41|\n|/cgi-bin/imagemap...|    6|\n|/cgi-bin/imagemap...|    4|\n|/history/apollo/a...|   19|\n|/cgi-bin/imagemap...|    8|\n+--------------------+-----+\nonly showing top 10 rows\n\nTop 10 de URLs con errores:\n+----------------------------------------+-----+\n|path                                    |count|\n+----------------------------------------+-----+\n|/images/NASA-logosmall.gif              |19072|\n|/images/KSC-logosmall.gif               |11328|\n|/images/MOSAIC-logosmall.gif            |8617 |\n|/images/USA-logosmall.gif               |8565 |\n|/images/WORLD-logosmall.gif             |8360 |\n|/images/ksclogo-medium.gif              |7722 |\n|/history/apollo/images/apollo-logo1.gif |4355 |\n|/shuttle/countdown/images/countclock.gif|4227 |\n|/images/launch-logo.gif                 |4178 |\n|/                                       |3605 |\n+----------------------------------------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787646_1073605753","id":"20180710-150101_280602137","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:05-0500","dateFinished":"2018-08-08T10:48:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%md\n## Número de visitantes (`hosts`) únicos\n\n¿Cuántos \"hosts\" únicos hay en el Log?\n\n_Tip_:\nUna opción es agrupar por la columna  `host`, pero hay distintas maneras de hacer la tarea.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Número de visitantes (<code>hosts</code>) únicos</h2>\n<p>¿Cuántos &ldquo;hosts&rdquo; únicos hay en el Log?</p>\n<p><em>Tip</em>:<br/>Una opción es agrupar por la columna <code>host</code>, pero hay distintas maneras de hacer la tarea.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787647_1073221004","id":"20180710-151105_2035207680","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nunique_host_count = logs_df.groupBy('host').count()\n#unique_host_count = unique_host_count.select(unique_host_count.host,unique_host_count['count'].alias('cuenta'))\n#unique_host_count=unique_host_count.filter(\"count=1\")\n#unique_host_count.show()\nunique_host_count=unique_host_count.count()\n\nprint 'Número de visitantes distintos: {0}'.format(unique_host_count)","user":"hduser","dateUpdated":"2018-08-08T10:48:12-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Número de visitantes distintos: 75060\n"}]},"apps":[],"jobName":"paragraph_1533570787648_1058985295","id":"20180710-151239_612416453","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:12-0500","dateFinished":"2018-08-08T10:48:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"text":"%md\n### Número de \"`hosts`\" únicos por día\n\nEl siguiente análisis tiene una mayor complejidad. Busquemos el número de \"hosts\" únicos en todo el Log para cada día disponible. En otas palabras, queremos computar el conteo de usuarios únicos que visitaron el sitio para cada día del mes. Generarás un DataFrame ordenado de manera creciente por día del mes y el conteo asociado de visitantes únicos para ese día. Usa `cache()` en `daily_hosts_df`, ya que lo seguirás usando durante la notebook.\n\nPrimero, deberás pensar en como obtener el conteo de \"hosts\" únicos por cada día. El log que tenemos contiene únicamente datos de un periodo de un mes, por lo que puedes ignorar el mes al escribir código. Deberás usar la función [`dayofmonth()`](https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.dayofmonth) del módulo `pyspark.sql.functions` para obtener el día contenido en la columna `time`.\n\nEn particular, generarás 3 DataFrames:\n\n**`day_to_host_pair_df`**\n\nSe genera seleccionando y transformando ciertas columnas de `logs_df`. Deberás obtener un DataFrame con dos columnas:\n\n| columna | contenido               |\n| ------  | --------------------    |\n| `host`  | El nombre de visitante  |\n| `day`   | El día del mes          |\n\n\n**`day_group_hosts_df`**\n\nUn DataFrame que contiene las mismas columnas que `day_to_host_pair_df`, pero elimina las entradas repetidas. \n\ny\n\n**`daily_hosts_df`**\n\nUn DataFrame que contien el conteo de \"hosts\" únicos por día. Generalo usando funciones de agrupación en conjunto con la función de agregación necesaria.\n\n\n| columna  | contenido                                          |\n| -------  | -------------------------------------------------- |\n| `day`    | Día del mes                                        |\n| `count`  | El número de visitantes únicos en el día asociado  |\n\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Número de &ldquo;<code>hosts</code>&rdquo; únicos por día</h3>\n<p>El siguiente análisis tiene una mayor complejidad. Busquemos el número de &ldquo;hosts&rdquo; únicos en todo el Log para cada día disponible. En otas palabras, queremos computar el conteo de usuarios únicos que visitaron el sitio para cada día del mes. Generarás un DataFrame ordenado de manera creciente por día del mes y el conteo asociado de visitantes únicos para ese día. Usa <code>cache()</code> en <code>daily_hosts_df</code>, ya que lo seguirás usando durante la notebook.</p>\n<p>Primero, deberás pensar en como obtener el conteo de &ldquo;hosts&rdquo; únicos por cada día. El log que tenemos contiene únicamente datos de un periodo de un mes, por lo que puedes ignorar el mes al escribir código. Deberás usar la función <a href=\"https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.dayofmonth\"><code>dayofmonth()</code></a> del módulo <code>pyspark.sql.functions</code> para obtener el día contenido en la columna <code>time</code>.</p>\n<p>En particular, generarás 3 DataFrames:</p>\n<p><strong><code>day_to_host_pair_df</code></strong></p>\n<p>Se genera seleccionando y transformando ciertas columnas de <code>logs_df</code>. Deberás obtener un DataFrame con dos columnas:</p>\n<table>\n  <thead>\n    <tr>\n      <th>columna </th>\n      <th>contenido </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>host</code> </td>\n      <td>El nombre de visitante </td>\n    </tr>\n    <tr>\n      <td><code>day</code> </td>\n      <td>El día del mes </td>\n    </tr>\n  </tbody>\n</table>\n<p><strong><code>day_group_hosts_df</code></strong></p>\n<p>Un DataFrame que contiene las mismas columnas que <code>day_to_host_pair_df</code>, pero elimina las entradas repetidas. </p>\n<p>y</p>\n<p><strong><code>daily_hosts_df</code></strong></p>\n<p>Un DataFrame que contien el conteo de &ldquo;hosts&rdquo; únicos por día. Generalo usando funciones de agrupación en conjunto con la función de agregación necesaria.</p>\n<table>\n  <thead>\n    <tr>\n      <th>columna </th>\n      <th>contenido </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><code>day</code> </td>\n      <td>Día del mes </td>\n    </tr>\n    <tr>\n      <td><code>count</code> </td>\n      <td>El número de visitantes únicos en el día asociado </td>\n    </tr>\n  </tbody>\n</table>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787648_1058985295","id":"20180710-151523_625492390","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nfrom pyspark.sql.functions import dayofmonth\n\nday_to_host_pair_df = logs_df.select(logs_df.host,dayofmonth('time').alias('day') )#debe tener dos columnas (host, day)\n\n#day_group_hosts_df = day_to_host_pair_df.groupBy('host').count().filter(\"count=1\")#debe tener dos columnas (host, day), no debe contener entradas repetidas\nday_group_hosts_df = day_to_host_pair_df.distinct()\n\ndaily_hosts_df = day_group_hosts_df.groupBy('day').count().orderBy('day')#debe contener dos columnas (day, count)\n\nprint 'Visitantes unicos por dia:'\ndaily_hosts_df.show(30, False)\ndaily_hosts_df.cache()","user":"hduser","dateUpdated":"2018-08-08T10:48:17-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Visitantes unicos por dia:\n+---+-----+\n|day|count|\n+---+-----+\n|1  |2582 |\n|3  |3222 |\n|4  |4191 |\n|5  |2502 |\n|6  |2538 |\n|7  |4108 |\n|8  |4406 |\n|9  |4317 |\n|10 |4523 |\n|11 |4346 |\n|12 |2865 |\n|13 |2650 |\n|14 |4454 |\n|15 |4214 |\n|16 |4340 |\n|17 |4385 |\n|18 |4168 |\n|19 |2550 |\n|20 |2560 |\n|21 |4135 |\n|22 |4456 |\n|23 |4368 |\n|24 |4077 |\n|25 |4407 |\n|26 |2644 |\n|27 |2690 |\n|28 |4215 |\n|29 |4826 |\n|30 |5266 |\n|31 |5916 |\n+---+-----+\n\nDataFrame[day: int, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1533570787649_1058600546","id":"20180710-152947_1965729991","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:17-0500","dateFinished":"2018-08-08T10:48:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"text":"%md\nVisualiza `daily_hosts_df` utilizando gráficas de Zeppelin:\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Visualiza <code>daily_hosts_df</code> utilizando gráficas de Zeppelin:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787649_1058600546","id":"20180710-154000_2021817968","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nz.show(daily_hosts_df)","user":"hduser","dateUpdated":"2019-02-13T16:56:02-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"day":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tcount\n1\t2582\n3\t3222\n4\t4191\n5\t2502\n6\t2538\n7\t4108\n8\t4406\n9\t4317\n10\t4523\n11\t4346\n12\t2865\n13\t2650\n14\t4454\n15\t4214\n16\t4340\n17\t4385\n18\t4168\n19\t2550\n20\t2560\n21\t4135\n22\t4456\n23\t4368\n24\t4077\n25\t4407\n26\t2644\n27\t2690\n28\t4215\n29\t4826\n30\t5266\n31\t5916\n"}]},"apps":[],"jobName":"paragraph_1533570787650_1059754793","id":"20180710-154028_668367933","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:23-0500","dateFinished":"2018-08-08T10:48:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"%md\n## Número de visitas promedio de un usuario por día\n\nAhora determinemos el número de visitas promedio de un usuario por día. Crea un DataFrame que contega a cada \"`host`\", el día del mes y el conteo de visitas del \"`host`\" en ese día. Después, utilizalo en conjunto con funciones de agrupamiento y agregación para encontrar el número de visitas promedio de un usuario (esto es, el promedio del conteo de visitas de los \"`host`\" en cada día del mes).\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Número de visitas promedio de un usuario por día</h2>\n<p>Ahora determinemos el número de visitas promedio de un usuario por día. Crea un DataFrame que contega a cada &ldquo;<code>host</code>&rdquo;, el día del mes y el conteo de visitas del &ldquo;<code>host</code>&rdquo; en ese día. Después, utilizalo en conjunto con funciones de agrupamiento y agregación para encontrar el número de visitas promedio de un usuario (esto es, el promedio del conteo de visitas de los &ldquo;<code>host</code>&rdquo; en cada día del mes).</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787650_1059754793","id":"20180710-154131_1705346781","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\ntotal_req_per_day_df = logs_df.select(logs_df.host,dayofmonth('time').alias('day')).groupBy('host','day').count()\n# debe tener 3 columnas, (host, day, count)\n\navg_daily_req_per_host_df = (total_req_per_day_df\n                            .groupBy('day').agg(sqlFunctions.avg(total_req_per_day_df['count']))\n                            .orderBy(\"day\")\n                            ) #debe tener dos columnas (day, avg(count))\n\nprint 'Promedio de visitas diarias por host:'\navg_daily_req_per_host_df.show(30)\navg_daily_req_per_host_df.cache()","user":"hduser","dateUpdated":"2018-08-08T10:48:27-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Promedio de visitas diarias por host:\n+---+------------------+\n|day|        avg(count)|\n+---+------------------+\n|  1|13.166537567776917|\n|  3|12.845437616387336|\n|  4|14.210689572894298|\n|  5|12.747002398081534|\n|  6| 12.77383766745469|\n|  7|  13.9634858812074|\n|  8|13.653427144802542|\n|  9| 14.00463284688441|\n| 10|13.541454786646032|\n| 11|14.092498849516797|\n| 12|13.288307155322862|\n| 13|13.766037735849057|\n| 14|13.443646160754378|\n| 15|13.964641670621736|\n| 16|  13.0536866359447|\n| 17|13.452223489167617|\n| 18|13.494721689059501|\n| 19|12.585882352941177|\n| 20|      12.876171875|\n| 21|  13.4316807738815|\n| 22|12.962746858168762|\n| 23|13.300595238095237|\n| 24|12.889870002452783|\n| 25|13.006807351940095|\n| 26|11.954614220877458|\n| 27| 12.20185873605948|\n| 28|13.166310794780546|\n| 29|14.087857438872772|\n| 30|15.313520698822636|\n| 31|15.234110885733603|\n+---+------------------+\n\nDataFrame[day: int, avg(count): double]\n"}]},"apps":[],"jobName":"paragraph_1533570787651_1059370044","id":"20180710-160042_825271383","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:27-0500","dateFinished":"2018-08-08T10:48:29-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%md\nVisualiza el promedio de visitas diarias de un usuario mediante gráficas de Zeppelin:\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Visualiza el promedio de visitas diarias de un usuario mediante gráficas de Zeppelin:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787651_1059370044","id":"20180710-160047_1859453680","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nz.show(avg_daily_req_per_host_df)","user":"hduser","dateUpdated":"2019-02-13T16:56:03-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"day":"string","avg(count)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(count)","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tavg(count)\n1\t13.166537567776917\n3\t12.845437616387336\n4\t14.210689572894298\n5\t12.747002398081534\n6\t12.77383766745469\n7\t13.9634858812074\n8\t13.653427144802542\n9\t14.00463284688441\n10\t13.541454786646032\n11\t14.092498849516797\n12\t13.288307155322862\n13\t13.766037735849057\n14\t13.443646160754378\n15\t13.964641670621736\n16\t13.0536866359447\n17\t13.452223489167617\n18\t13.494721689059501\n19\t12.585882352941177\n20\t12.876171875\n21\t13.4316807738815\n22\t12.962746858168762\n23\t13.300595238095237\n24\t12.889870002452783\n25\t13.006807351940095\n26\t11.954614220877458\n27\t12.20185873605948\n28\t13.166310794780546\n29\t14.087857438872772\n30\t15.313520698822636\n31\t15.234110885733603\n"}]},"apps":[],"jobName":"paragraph_1533570787652_1057446300","id":"20180710-173229_1449885496","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:33-0500","dateFinished":"2018-08-08T10:48:34-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%md\n## Explorando códigos de estado 404\n\nExploremos las entradas del log con código de estado 404. Al navegar en internet, es posible que encuentre páginas que muestran el mensaje \"404 Not Found\". Este código de error es retornado por el servidor cuando no se encuentra disponible el contenido que el cliente desea acceder.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Explorando códigos de estado 404</h2>\n<p>Exploremos las entradas del log con código de estado 404. Al navegar en internet, es posible que encuentre páginas que muestran el mensaje &ldquo;404 Not Found&rdquo;. Este código de error es retornado por el servidor cuando no se encuentra disponible el contenido que el cliente desea acceder.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787652_1057446300","id":"20180710-160109_225508307","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"%md\n### Contando el número de códigos 404\n\nCrea un DataFrame que contenga entradas con código de estado 404. Utiliza `cache()` para poner el DataFrame `not_found_df` en memoria, lo usarás en el resto de la notebook.\n\n¿Cuántas entradas con error 404 existen en el log?","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Contando el número de códigos 404</h3>\n<p>Crea un DataFrame que contenga entradas con código de estado 404. Utiliza <code>cache()</code> para poner el DataFrame <code>not_found_df</code> en memoria, lo usarás en el resto de la notebook.</p>\n<p>¿Cuántas entradas con error 404 existen en el log?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787653_1057061551","id":"20180710-160215_2029301208","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\nnot_found_df = logs_df.filter(\"status=404\")\nprint('Se encontraron {0} registros con código 404').format(not_found_df.count())\n\nnot_found_df.cache()","user":"hduser","dateUpdated":"2018-08-08T10:48:41-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Se encontraron 10056 registros con código 404\nDataFrame[host: string, path: string, status: int, content_size: int, time: timestamp]\n"}]},"apps":[],"jobName":"paragraph_1533570787653_1057061551","id":"20180710-160124_1194569467","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:41-0500","dateFinished":"2018-08-08T10:48:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"%md\n### Listando entradas con código de estado 404\n\nUsando el DataFrame que contiene unicamente entradas con código de estado 404, imprime una lista con 40 direcciones que generan error 404.\n\n**Nota: No debe haber direcciones repetidas en la lista.**\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Listando entradas con código de estado 404</h3>\n<p>Usando el DataFrame que contiene unicamente entradas con código de estado 404, imprime una lista con 40 direcciones que generan error 404.</p>\n<p><strong>Nota: No debe haber direcciones repetidas en la lista.</strong></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787654_1058215797","id":"20180710-160230_1721266888","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\nnot_found_paths_df = not_found_df.select(not_found_df.path)\nunique_not_found_paths_df = not_found_paths_df.distinct()\n\nprint 'Direcciones que generan error 404:\\n'\n\nunique_not_found_paths_df.show(n=40, truncate=False)\n","user":"hduser","dateUpdated":"2018-08-08T10:48:49-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Direcciones que generan error 404:\n\n+--------------------------------------------------------------+\n|path                                                          |\n+--------------------------------------------------------------+\n|/history/apollo/a-001/news/                                   |\n|/shuttle/missions/sts-68/images/images.html                   |\n|/history/apollo/a-003/movies/                                 |\n|/CSMT_PageNS                                                  |\n|/fia/projects/bayes-group/Atlas/Earth/                        |\n|/missions/shuttle                                             |\n|/shuttle/technology/sts-newsref/stsret-newsref/stsref-toc.html|\n|/uof.edu/                                                     |\n|/comprod/at_work/images/wlcobanb.gif                          |\n|/pub/wiinvn/win3/ww16_99_.zip                                 |\n|/shuttle/sts-1/sts-1-pa.jpg                                   |\n|/public.win3/winvn                                            |\n|/mol/                                                         |\n|/nssdc.gsfc.nasa.gov                                          |\n|/shuttle/missions/sts-61-a/images/                            |\n|/insert-name.html                                             |\n|/history/apollo/apollo/13                                     |\n|/IMAGES/RSS.GIF                                               |\n|/shuttle/missions/sts-71/images/KSC-95EC-0916.txt             |\n|/pub/winvn/docs                                               |\n|/shuttle/technology/images/sts-comm-small.gif                 |\n|/shuttle/countdown/ac.html                                    |\n|/history/apollo/-apollo-13/apollo-3.html                      |\n|/history/apollo/apollo-13/thumb/little_buzz.gif               |\n|/thunder                                                      |\n|/shuttle/missions/sts-71/./video/livevideo.jpeg               |\n|/pub/winvn/readme.txt                                         |\n|/home.html                                                    |\n|/ksc.shtml                                                    |\n|/img/sportstalk3.gif                                          |\n|/shuttle/missions/sts-61a/mission-sts-61a.html                |\n|/history/apollo-12/apollo-12.html                             |\n|/shuttle/technology/sts-newsref/srb.html%23srb                |\n|/sts-69                                                       |\n|/elv/cape.htm                                                 |\n|/elv/vidpicp.htlm                                             |\n|/astronaut.*                                                  |\n|/shuttle/miccions/sts-73/mission-sts-73.html                  |\n|/history/apollo/sa-9/images/                                  |\n|/shuttle/missions/sts-86/mission-sts-86.html                  |\n+--------------------------------------------------------------+\nonly showing top 40 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787654_1058215797","id":"20180710-160239_73377626","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:49-0500","dateFinished":"2018-08-08T10:48:49-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"text":"%md\n### Listando el top 20 de direcciones con error 404\n\nUsando el DataFrame que contiene entradas del log con códigos de estado 404, imprime una lista con las 20 direcciones que regresaron más errores 404.\n\n\n**Nota: Las direcciones que imprimas deben estar ordenadas de forma descendente.**\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Listando el top 20 de direcciones con error 404</h3>\n<p>Usando el DataFrame que contiene entradas del log con códigos de estado 404, imprime una lista con las 20 direcciones que regresaron más errores 404.</p>\n<p><strong>Nota: Las direcciones que imprimas deben estar ordenadas de forma descendente.</strong></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787655_1057831048","id":"20180710-160250_389625160","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:129"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\ntop_20_not_found_df = not_found_paths_df.groupBy('path').count().orderBy('count', ascending=False )\n\nprint 'Top 20 de direcciones que generaron error 404:\\n'\ntop_20_not_found_df.show(n=20, truncate=False)\n","user":"hduser","dateUpdated":"2018-08-08T10:48:53-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top 20 de direcciones que generaron error 404:\n\n+-----------------------------------------------------------------+-----+\n|path                                                             |count|\n+-----------------------------------------------------------------+-----+\n|/pub/winvn/readme.txt                                            |1337 |\n|/pub/winvn/release.txt                                           |1185 |\n|/shuttle/missions/STS-69/mission-STS-69.html                     |682  |\n|/images/nasa-logo.gif                                            |319  |\n|/shuttle/missions/sts-68/ksc-upclose.gif                         |251  |\n|/elv/DELTA/uncons.htm                                            |209  |\n|/history/apollo/sa-1/sa-1-patch-small.gif                        |200  |\n|/://spacelink.msfc.nasa.gov                                      |166  |\n|/images/crawlerway-logo.gif                                      |160  |\n|/history/apollo/a-001/a-001-patch-small.gif                      |154  |\n|/history/apollo/pad-abort-test-1/pad-abort-test-1-patch-small.gif|144  |\n|                                                                 |142  |\n|/images/Nasa-logo.gif                                            |85   |\n|/history/apollo/images/little-joe.jpg                            |84   |\n|/shuttle/resources/orbiters/discovery.gif                        |82   |\n|/shuttle/resources/orbiters/atlantis.gif                         |80   |\n|/robots.txt                                                      |77   |\n|/images/lf-logo.gif                                              |77   |\n|/shuttle/resources/orbiters/challenger.gif                       |77   |\n|/software/winvn/winvn.html.                                      |57   |\n+-----------------------------------------------------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787655_1057831048","id":"20180710-160302_1087178504","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:53-0500","dateFinished":"2018-08-08T10:48:53-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:130"},{"text":"%md\n### Listando el top 25 de \"hosts\" que recibieron errores 404\n\nAhora, usando el DataFrame que contiene los registros con códigos de estado 404, busca a los \"hosts\" que encontraron el mayor número de errores 404 al visitar el sitio.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Listando el top 25 de &ldquo;hosts&rdquo; que recibieron errores 404</h3>\n<p>Ahora, usando el DataFrame que contiene los registros con códigos de estado 404, busca a los &ldquo;hosts&rdquo; que encontraron el mayor número de errores 404 al visitar el sitio.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787656_1055907304","id":"20180710-160317_592432990","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:131"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nhosts_404_count_df = not_found_df.select(not_found_df.host).groupBy('host').count().orderBy('count', ascending=False )\n\nprint 'Top 25 de hosts que encontraron errores 404:\\n'\nhosts_404_count_df.show(n=25, truncate=False)\n","user":"hduser","dateUpdated":"2018-08-08T10:48:58-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top 25 de hosts que encontraron errores 404:\n\n+---------------------------+-----+\n|host                       |count|\n+---------------------------+-----+\n|dialip-217.den.mmc.com     |62   |\n|piweba3y.prodigy.com       |47   |\n|155.148.25.4               |44   |\n|maz3.maz.net               |39   |\n|gate.barr.com              |38   |\n|204.62.245.32              |37   |\n|m38-370-9.mit.edu          |37   |\n|nexus.mlckew.edu.au        |37   |\n|ts8-1.westwood.ts.ucla.edu |37   |\n|scooter.pa-x.dec.com       |35   |\n|reddragon.ksc.nasa.gov     |33   |\n|www-c4.proxy.aol.com       |32   |\n|piweba5y.prodigy.com       |31   |\n|piweba4y.prodigy.com       |30   |\n|www-d4.proxy.aol.com       |30   |\n|internet-gw.watson.ibm.com |29   |\n|unidata.com                |28   |\n|163.206.104.34             |28   |\n|spica.sci.isas.ac.jp       |27   |\n|www-d2.proxy.aol.com       |26   |\n|203.13.168.24              |25   |\n|203.13.168.17              |25   |\n|www-c2.proxy.aol.com       |23   |\n|crl5.crl.com               |23   |\n|www-d1.proxy.aol.com       |23   |\n+---------------------------+-----+\nonly showing top 25 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787657_1055522555","id":"20180710-160327_672221051","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:48:58-0500","dateFinished":"2018-08-08T10:48:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:132"},{"text":"%md\n### Listando errores 404 por día\n\nUsemos información temporal para encontrar el número de códigos de estado 404 que se generaron cada día del mes. Ordena el DataFrame por día de forma ascendente.\n\n**El log unicamente contiene registros de un mes, por lo que puedes ignorar el mes en tu código y enfocarte en los días.**\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Listando errores 404 por día</h3>\n<p>Usemos información temporal para encontrar el número de códigos de estado 404 que se generaron cada día del mes. Ordena el DataFrame por día de forma ascendente.</p>\n<p><strong>El log unicamente contiene registros de un mes, por lo que puedes ignorar el mes en tu código y enfocarte en los días.</strong></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787657_1055522555","id":"20180710-160341_1780212344","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:133"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\nerrors_by_date_sorted_df = not_found_df.select(dayofmonth('time').alias('day')).groupBy('day').count().orderBy('day')\nprint 'Codigos 404 por dia:\\n'\nerrors_by_date_sorted_df.show()\nerrors_by_date_sorted_df.cache()\n","user":"hduser","dateUpdated":"2018-08-08T10:49:02-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Codigos 404 por dia:\n\n+---+-----+\n|day|count|\n+---+-----+\n|  1|  243|\n|  3|  304|\n|  4|  346|\n|  5|  236|\n|  6|  373|\n|  7|  537|\n|  8|  391|\n|  9|  279|\n| 10|  315|\n| 11|  263|\n| 12|  196|\n| 13|  216|\n| 14|  287|\n| 15|  327|\n| 16|  259|\n| 17|  271|\n| 18|  256|\n| 19|  209|\n| 20|  312|\n| 21|  305|\n+---+-----+\nonly showing top 20 rows\n\nDataFrame[day: int, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1533570787658_1056676802","id":"20180710-160351_1249960104","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:49:02-0500","dateFinished":"2018-08-08T10:49:03-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:134"},{"text":"%md\nVisualiza los resultados de \"errores 404 por día\" utilizando gráficas de Zeppelin:\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Visualiza los resultados de &ldquo;errores 404 por día&rdquo; utilizando gráficas de Zeppelin:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787658_1056676802","id":"20180710-160431_941671758","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:135"},{"text":"%pyspark\nz.show(errors_by_date_sorted_df)","user":"hduser","dateUpdated":"2019-02-13T16:56:03-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"day":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"day","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day\tcount\n1\t243\n3\t304\n4\t346\n5\t236\n6\t373\n7\t537\n8\t391\n9\t279\n10\t315\n11\t263\n12\t196\n13\t216\n14\t287\n15\t327\n16\t259\n17\t271\n18\t256\n19\t209\n20\t312\n21\t305\n22\t288\n23\t345\n24\t420\n25\t415\n26\t366\n27\t370\n28\t410\n29\t420\n30\t571\n31\t526\n"}]},"apps":[],"jobName":"paragraph_1533570787659_1056292053","id":"20180710-160430_1793256179","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:49:06-0500","dateFinished":"2018-08-08T10:49:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:136"},{"text":"%md\n### Top 5 de días con más errores 404\n\nUtiliza el DataFrame `errors_by_date_sorted_df` que generaste, para encontrar el top 5 de díás que generaron más errores 404.\nEl DataFrame que generes debe mostrar el día y su conteo de errores 404 respectivo.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Top 5 de días con más errores 404</h3>\n<p>Utiliza el DataFrame <code>errors_by_date_sorted_df</code> que generaste, para encontrar el top 5 de díás que generaron más errores 404.<br/>El DataFrame que generes debe mostrar el día y su conteo de errores 404 respectivo.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787659_1056292053","id":"20180710-160524_314444803","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:137"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\n\ntop_err_date_df = errors_by_date_sorted_df.orderBy('count', ascending=False)\n\nprint 'Top 5 de dias con mas errores 404:\\n'\ntop_err_date_df.show(5)\n","user":"hduser","dateUpdated":"2018-08-08T10:49:13-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top 5 de dias con mas errores 404:\n\n+---+-----+\n|day|count|\n+---+-----+\n| 30|  571|\n|  7|  537|\n| 31|  526|\n| 29|  420|\n| 24|  420|\n+---+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570787660_1054368308","id":"20180710-160540_845980530","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:49:13-0500","dateFinished":"2018-08-08T10:49:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:138"},{"text":"%md\n### Horas del día con más errores 404\n\n¿En qué horarios se generan más errores 404?\n\nUtiliza el DataFrame `not_found_df` que generaste anteriormente y genera un nuevo DataFrame que contenga por hora del día, el número total de entradas con código de estado 404, ordena el DataFrame para mostrar las horas del día donde se presentan más errores 404.\n\n_Tip:_\n_Utiliza la función [`hour()`](http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.hour) del módulo `pyspark.sql.functions`._\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Horas del día con más errores 404</h3>\n<p>¿En qué horarios se generan más errores 404?</p>\n<p>Utiliza el DataFrame <code>not_found_df</code> que generaste anteriormente y genera un nuevo DataFrame que contenga por hora del día, el número total de entradas con código de estado 404, ordena el DataFrame para mostrar las horas del día donde se presentan más errores 404.</p>\n<p><em>Tip:</em><br/><em>Utiliza la función <a href=\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.functions.hour\"><code>hour()</code></a> del módulo <code>pyspark.sql.functions</code>.</em></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787660_1054368308","id":"20180710-160552_1016066002","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:139"},{"text":"%pyspark\n# Reemplaza <Rellena> con tu codigo\nfrom pyspark.sql.functions import hour\n\nhour_records_sorted_df = not_found_df.select(hour('time').alias('hora')).groupBy('hora').count().orderBy('count', ascending=False)\n\nprint 'Top hours for 404 requests:\\n'\nhour_records_sorted_df.show(24)\nhour_records_sorted_df.cache()\n","user":"hduser","dateUpdated":"2018-08-08T10:49:23-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Top hours for 404 requests:\n\n+----+-----+\n|hora|count|\n+----+-----+\n|  12|  651|\n|  13|  614|\n|   2|  600|\n|  17|  586|\n|  16|  550|\n|  15|  549|\n|  14|  522|\n|  10|  492|\n|  23|  474|\n|  19|  440|\n|  21|  434|\n|  20|  432|\n|  22|  430|\n|  11|  428|\n|  18|  425|\n|   3|  363|\n|   9|  359|\n|   0|  344|\n|   8|  340|\n|   1|  327|\n|   7|  218|\n|   4|  183|\n|   5|  160|\n|   6|  135|\n+----+-----+\n\nDataFrame[hora: int, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1533570787661_1053983559","id":"20180710-160600_2128864137","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:49:23-0500","dateFinished":"2018-08-08T10:49:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:140"},{"text":"%md\nVisualiza los resultados de \"Horas del día con más errores 404\" con gráficas de Zeppelin:","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Visualiza los resultados de &ldquo;Horas del día con más errores 404&rdquo; con gráficas de Zeppelin:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787661_1053983559","id":"20180710-160631_750911479","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:141"},{"text":"%pyspark\nz.show(hour_records_sorted_df)","user":"hduser","dateUpdated":"2019-02-13T16:56:03-0600","config":{"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"hora":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"hora","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"editorMode":"ace/mode/python","editorHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hora\tcount\n12\t651\n13\t614\n2\t600\n17\t586\n16\t550\n15\t549\n14\t522\n10\t492\n23\t474\n19\t440\n21\t434\n20\t432\n22\t430\n11\t428\n18\t425\n3\t363\n9\t359\n0\t344\n8\t340\n1\t327\n7\t218\n4\t183\n5\t160\n6\t135\n"}]},"apps":[],"jobName":"paragraph_1533570787662_1055137806","id":"20180710-160632_738136620","dateCreated":"2018-08-06T10:53:07-0500","dateStarted":"2018-08-08T10:49:26-0500","dateFinished":"2018-08-08T10:49:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:142"},{"text":"%md\n# Felicidades!, finalizaste esta notebook.\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Felicidades!, finalizaste esta notebook.</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787663_1054753057","id":"20180710-210143_1404770510","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:143"},{"text":"%md\nYay!","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"tableHide":false,"results":{},"editorMode":"ace/mode/markdown","editorHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Yay!</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1533570787663_1054753057","id":"20180713-184039_1387932636","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:144"},{"text":"%md\n","dateUpdated":"2018-08-06T10:53:07-0500","config":{"enabled":true,"editorMode":"ace/mode/markdown","results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533570787664_1065141278","id":"20180720-113509_1903346542","dateCreated":"2018-08-06T10:53:07-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:145"}],"name":"JSGP/Practicas/3-Analisis_Log","id":"2DQ864HA8","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
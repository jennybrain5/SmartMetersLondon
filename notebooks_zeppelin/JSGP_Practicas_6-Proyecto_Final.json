{"paragraphs":[{"text":"%pyspark\n\n\n# Leer datos desde HBase y entregarlos en dataframes\nloadedMoviesDF = sqlContext.read.format(\"org.apache.phoenix.spark\").option(\"table\", \"MOVIES\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").load()\nloadedRatingsDF = sqlContext.read.format(\"org.apache.phoenix.spark\").option(\"table\", \"RATINGS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").load()\n\nloadedMoviesDF.show()\nloadedRatingsDF.show()","user":"hduser","dateUpdated":"2018-11-28T16:08:31-0600","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Py4JJavaError: An error occurred while calling o573813.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Master removed our application: KILLED\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1651)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1639)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1638)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1638)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1872)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1821)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1810)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3278)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3259)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3258)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2489)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2703)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n\tat sun.reflect.GeneratedMethodAccessor303.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:745)\n\n(<class 'py4j.protocol.Py4JJavaError'>, Py4JJavaError(u'An error occurred while calling o573813.showString.\\n', JavaObject id=o573819), <traceback object at 0x7fb2169c5ab8>)"}]},"apps":[],"jobName":"paragraph_1533570838601_13683830","id":"20180723-091629_180277835","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-11-28T16:08:31-0600","dateFinished":"2018-11-28T16:09:56-0600","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:55"},{"text":"%pyspark\nfrom pyspark.sql.functions import split, regexp_extract\nfrom pyspark.sql.functions import from_unixtime\n\n#Separa el año y el tíutlo\nsplit_df_movies = loadedMoviesDF.select(loadedMoviesDF.MOVIEID,regexp_extract('TITLE', r'.+\\((\\d{4})\\)', 1).cast('integer').alias('Year'),\n                                regexp_extract('TITLE', r'^(.+)\\(\\d{4}\\)$', 1).alias('Title'),\n                                loadedMoviesDF.GENRES)\n                                \n#Separa los diferentes géneros de una película. Se selecciona el primero como género principal\nsplit_col = split(split_df_movies['GENRES'], '\\|')\nsplit_df_movies = split_df_movies.withColumn('Genre', split_col.getItem(0))\nmoviesDF=split_df_movies.select(split_df_movies.MOVIEID.alias('mId'), split_df_movies.Title, split_df_movies.Year, split_df_movies.Genre)\nmoviesDF.show(truncate=False)\n","user":"hduser","dateUpdated":"2018-08-10T10:35:24-0500","config":{"enabled":true,"results":{},"editorMode":"ace/mode/python","editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------------------------------+----+---------+\n|mId|Title                          |Year|Genre    |\n+---+-------------------------------+----+---------+\n|1  |Toy Story                      |1995|Adventure|\n|2  |Jumanji                        |1995|Adventure|\n|3  |Grumpier Old Men               |1995|Comedy   |\n|4  |Waiting to Exhale              |1995|Comedy   |\n|5  |Father of the Bride Part II    |1995|Comedy   |\n|6  |Heat                           |1995|Action   |\n|7  |Sabrina                        |1995|Comedy   |\n|8  |Tom and Huck                   |1995|Adventure|\n|9  |Sudden Death                   |1995|Action   |\n|10 |GoldenEye                      |1995|Action   |\n|11 |American President, The        |1995|Comedy   |\n|12 |Dracula: Dead and Loving It    |1995|Comedy   |\n|13 |Balto                          |1995|Adventure|\n|14 |Nixon                          |1995|Drama    |\n|15 |Cutthroat Island               |1995|Action   |\n|16 |Casino                         |1995|Crime    |\n|17 |Sense and Sensibility          |1995|Drama    |\n|18 |Four Rooms                     |1995|Comedy   |\n|19 |Ace Ventura: When Nature Calls |1995|Comedy   |\n|20 |Money Train                    |1995|Action   |\n+---+-------------------------------+----+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570838603_14453328","id":"20180723-091847_845460279","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-08-10T10:35:24-0500","dateFinished":"2018-08-10T10:35:24-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\nfrom pyspark.sql.functions import to_date\n\n#Convierte la fecha de formato Unix\nratingsDF = loadedRatingsDF.withColumn(\"Date\", to_date(from_unixtime(\"UTIME\", \"yyyy-MM-dd\")))\nratingsDF = ratingsDF.select(ratingsDF.USERID.alias('uId'),ratingsDF.MOVIEID.alias('mId'),ratingsDF.RATING.alias('Rating'),ratingsDF.Date)\nratingsDF.show()\n","user":"hduser","dateUpdated":"2018-08-10T10:35:36-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+------+----------+\n|uId|mId|Rating|      Date|\n+---+---+------+----------+\n|  1|  2|   3.5|2005-04-02|\n|  1| 29|   3.5|2005-04-02|\n|  1| 32|   3.5|2005-04-02|\n|  1| 47|   3.5|2005-04-02|\n|  1| 50|   3.5|2005-04-02|\n|  1|112|   3.5|2004-09-09|\n|  1|151|   4.0|2004-09-09|\n|  1|223|   4.0|2005-04-02|\n|  1|253|   4.0|2005-04-02|\n|  1|260|   4.0|2005-04-02|\n|  1|293|   4.0|2005-04-02|\n|  1|296|   4.0|2005-04-02|\n|  1|318|   4.0|2005-04-02|\n|  1|337|   3.5|2004-09-09|\n|  1|367|   3.5|2005-04-02|\n|  1|541|   4.0|2005-04-02|\n|  1|589|   3.5|2005-04-02|\n|  1|593|   3.5|2005-04-02|\n|  1|653|   3.0|2004-09-09|\n|  1|919|   3.5|2004-09-09|\n+---+---+------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570838604_12529584","id":"20180726-103732_1657351878","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-08-10T10:35:36-0500","dateFinished":"2018-08-10T10:35:36-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%pyspark\n\n\n# Une todos los datos en una sola tabla. El campo común es el Id de la película\nta = moviesDF.alias('ta')\ntb = ratingsDF.alias('tb')\nallDF = ta.join(tb, ta.mId == tb.mId)\nallDF=allDF.select(ta.mId.alias('MID'),allDF.Title.alias('TITLE'),allDF.Year.alias('YEAR'),allDF.Genre.alias('GENRE'),allDF.uId.alias('UID'),allDF.Rating.alias('RATING'),allDF.Date.alias('DATERATED'))\nallDF.show()\n","user":"hduser","dateUpdated":"2018-08-10T10:35:43-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+----+---------+---+------+----------+\n|MID|               TITLE|YEAR|    GENRE|UID|RATING| DATERATED|\n+---+--------------------+----+---------+---+------+----------+\n|  2|            Jumanji |1995|Adventure|  1|   3.5|2005-04-02|\n| 29|City of Lost Chil...|1995|Adventure|  1|   3.5|2005-04-02|\n| 32|Twelve Monkeys (a...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 47|Seven (a.k.a. Se7...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 50|Usual Suspects, The |1995|    Crime|  1|   3.5|2005-04-02|\n|112|Rumble in the Bro...|1995|   Action|  1|   3.5|2004-09-09|\n|151|            Rob Roy |1995|   Action|  1|   4.0|2004-09-09|\n|223|             Clerks |1994|   Comedy|  1|   4.0|2005-04-02|\n|253|Interview with th...|1994|    Drama|  1|   4.0|2005-04-02|\n|260|Star Wars: Episod...|1977|   Action|  1|   4.0|2005-04-02|\n|293|Léon: The Profess...|1994|   Action|  1|   4.0|2005-04-02|\n|296|       Pulp Fiction |1994|   Comedy|  1|   4.0|2005-04-02|\n|318|Shawshank Redempt...|1994|    Crime|  1|   4.0|2005-04-02|\n|337|What's Eating Gil...|1993|    Drama|  1|   3.5|2004-09-09|\n|367|          Mask, The |1994|   Action|  1|   3.5|2005-04-02|\n|541|       Blade Runner |1982|   Action|  1|   4.0|2005-04-02|\n|589|Terminator 2: Jud...|1991|   Action|  1|   3.5|2005-04-02|\n|593|Silence of the La...|1991|    Crime|  1|   3.5|2005-04-02|\n|653|        Dragonheart |1996|   Action|  1|   3.0|2004-09-09|\n|919|  Wizard of Oz, The |1939|Adventure|  1|   3.5|2004-09-09|\n+---+--------------------+----+---------+---+------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570838605_12144835","id":"20180726-123847_2062733355","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-08-10T10:35:43-0500","dateFinished":"2018-08-10T10:35:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\nfrom pyspark.sql import functions as sqlFunctions\n\n\n#Géneros preferidos\n\nprefGenDF = (allDF\n                .groupBy('GENRE')\n                .agg(sqlFunctions.avg(allDF[\"RATING\"]))\n                .orderBy('avg(RATING)', ascending=False)\n                )\n\nprefGenDF.show()","user":"hduser","dateUpdated":"2018-08-10T10:35:47-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+------------------+\n|             GENRE|       avg(RATING)|\n+------------------+------------------+\n|         Film-Noir| 4.071710730948678|\n|           Mystery| 3.901195523565372|\n|             Crime|3.8495894968946116|\n|       Documentary|3.7677840265610936|\n|             Drama|3.6642971320182647|\n|               War| 3.652677651905252|\n|           Musical|3.6023352593204017|\n|         Animation|3.5719552048005965|\n|         Adventure| 3.554215432558488|\n|           Western|3.5350400672289086|\n|          Thriller| 3.525002952717156|\n|           Fantasy|  3.50508888168157|\n|            Comedy|3.4543040125815865|\n|            Action|3.4438918693405465|\n|           Romance|3.2796556478962473|\n|          Children|3.2131401291399206|\n|              null|3.1598214285714286|\n|            Horror|3.0907629751010366|\n|            Sci-Fi|3.0493655066333396|\n|(no genres listed)|3.0069252077562325|\n+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533570838605_12144835","id":"20180726-124757_1018701855","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-08-10T10:35:47-0500","dateFinished":"2018-08-10T10:35:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\nz.show(prefGenDF)","user":"hduser","dateUpdated":"2018-10-24T12:37:50-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"GENRE":"string","avg(RATING)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"Genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(Rating)","index":1,"aggr":"sum"}]},"helium":{}}},"editorHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"GENRE\tavg(RATING)\nFilm-Noir\t4.071710730948678\nMystery\t3.901195523565372\nCrime\t3.8495894968946116\nDocumentary\t3.7677840265610936\nDrama\t3.6642971320182647\nWar\t3.652677651905252\nMusical\t3.6023352593204017\nAnimation\t3.5719552048005965\nAdventure\t3.554215432558488\nWestern\t3.5350400672289086\nThriller\t3.525002952717156\nFantasy\t3.50508888168157\nComedy\t3.4543040125815865\nAction\t3.4438918693405465\nRomance\t3.2796556478962473\nChildren\t3.2131401291399206\nnull\t3.1598214285714286\nHorror\t3.0907629751010366\nSci-Fi\t3.0493655066333396\n(no genres listed)\t3.0069252077562325\nIMAX\t2.533333333333333\n"}]},"apps":[],"jobName":"paragraph_1533570838606_13299081","id":"20180726-125822_1502866323","dateCreated":"2018-08-06T10:53:58-0500","dateStarted":"2018-08-10T10:35:51-0500","dateFinished":"2018-08-10T10:35:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\n#Copia el esquema de HBase y los datos de la tabla AllDF\n#Primero se debe crear la tabla en HBase con la siguiente instrucción:\n#CREATE TABLE MOVIESDB (MID INTEGER NOT NULL, TITLE VARCHAR, YEAR INTEGER, GENRE VARCHAR, UID INTEGER NOT NULL, RATING DOUBLE, DATERATED DATE NOT NULL, CONSTRAINT pk PRIMARY KEY (MID, UID, DATERATED));\nloadedmoviesdbDF = sqlContext.read.format(\"org.apache.phoenix.spark\").option(\"table\", \"MOVIESDB\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").load()\nloadedmoviesdbDF=allDF.select(allDF.MID, allDF.TITLE,allDF.YEAR, allDF.GENRE,allDF.UID,allDF.RATING,allDF.DATERATED)\nloadedmoviesdbDF.show()\n","user":"hduser","dateUpdated":"2018-08-10T10:39:38-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+----+---------+---+------+----------+\n|MID|               TITLE|YEAR|    GENRE|UID|RATING| DATERATED|\n+---+--------------------+----+---------+---+------+----------+\n|  2|            Jumanji |1995|Adventure|  1|   3.5|2005-04-02|\n| 29|City of Lost Chil...|1995|Adventure|  1|   3.5|2005-04-02|\n| 32|Twelve Monkeys (a...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 47|Seven (a.k.a. Se7...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 50|Usual Suspects, The |1995|    Crime|  1|   3.5|2005-04-02|\n|112|Rumble in the Bro...|1995|   Action|  1|   3.5|2004-09-09|\n|151|            Rob Roy |1995|   Action|  1|   4.0|2004-09-09|\n|223|             Clerks |1994|   Comedy|  1|   4.0|2005-04-02|\n|253|Interview with th...|1994|    Drama|  1|   4.0|2005-04-02|\n|260|Star Wars: Episod...|1977|   Action|  1|   4.0|2005-04-02|\n|293|Léon: The Profess...|1994|   Action|  1|   4.0|2005-04-02|\n|296|       Pulp Fiction |1994|   Comedy|  1|   4.0|2005-04-02|\n|318|Shawshank Redempt...|1994|    Crime|  1|   4.0|2005-04-02|\n|337|What's Eating Gil...|1993|    Drama|  1|   3.5|2004-09-09|\n|367|          Mask, The |1994|   Action|  1|   3.5|2005-04-02|\n|541|       Blade Runner |1982|   Action|  1|   4.0|2005-04-02|\n|589|Terminator 2: Jud...|1991|   Action|  1|   3.5|2005-04-02|\n|593|Silence of the La...|1991|    Crime|  1|   3.5|2005-04-02|\n|653|        Dragonheart |1996|   Action|  1|   3.0|2004-09-09|\n|919|  Wizard of Oz, The |1939|Adventure|  1|   3.5|2004-09-09|\n+---+--------------------+----+---------+---+------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1533850133629_-2111185259","id":"20180809-162853_31779928","dateCreated":"2018-08-09T16:28:53-0500","dateStarted":"2018-08-10T10:39:38-0500","dateFinished":"2018-08-10T10:39:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\nfrom functools import reduce\n\n#Elimina entradas de fecha con valores nulos, ya que este campo hace parte de los primary key\nloadedmoviesdbDF=loadedmoviesdbDF.filter(loadedmoviesdbDF[\"DATERATED\"].isNotNull())\nloadedmoviesdbDF.show()\n\nbad_rows_df = loadedmoviesdbDF.filter(loadedmoviesdbDF['DATERATED'].isNull())\nbad_rows_df.count()\n","user":"hduser","dateUpdated":"2018-08-10T10:39:43-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+----+---------+---+------+----------+\n|MID|               TITLE|YEAR|    GENRE|UID|RATING| DATERATED|\n+---+--------------------+----+---------+---+------+----------+\n|  2|            Jumanji |1995|Adventure|  1|   3.5|2005-04-02|\n| 29|City of Lost Chil...|1995|Adventure|  1|   3.5|2005-04-02|\n| 32|Twelve Monkeys (a...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 47|Seven (a.k.a. Se7...|1995|  Mystery|  1|   3.5|2005-04-02|\n| 50|Usual Suspects, The |1995|    Crime|  1|   3.5|2005-04-02|\n|112|Rumble in the Bro...|1995|   Action|  1|   3.5|2004-09-09|\n|151|            Rob Roy |1995|   Action|  1|   4.0|2004-09-09|\n|223|             Clerks |1994|   Comedy|  1|   4.0|2005-04-02|\n|253|Interview with th...|1994|    Drama|  1|   4.0|2005-04-02|\n|260|Star Wars: Episod...|1977|   Action|  1|   4.0|2005-04-02|\n|293|Léon: The Profess...|1994|   Action|  1|   4.0|2005-04-02|\n|296|       Pulp Fiction |1994|   Comedy|  1|   4.0|2005-04-02|\n|318|Shawshank Redempt...|1994|    Crime|  1|   4.0|2005-04-02|\n|337|What's Eating Gil...|1993|    Drama|  1|   3.5|2004-09-09|\n|367|          Mask, The |1994|   Action|  1|   3.5|2005-04-02|\n|541|       Blade Runner |1982|   Action|  1|   4.0|2005-04-02|\n|589|Terminator 2: Jud...|1991|   Action|  1|   3.5|2005-04-02|\n|593|Silence of the La...|1991|    Crime|  1|   3.5|2005-04-02|\n|653|        Dragonheart |1996|   Action|  1|   3.0|2004-09-09|\n|919|  Wizard of Oz, The |1939|Adventure|  1|   3.5|2004-09-09|\n+---+--------------------+----+---------+---+------+----------+\nonly showing top 20 rows\n\n0\n"}]},"apps":[],"jobName":"paragraph_1533913414705_1386454200","id":"20180810-100334_395822870","dateCreated":"2018-08-10T10:03:34-0500","dateStarted":"2018-08-10T10:39:43-0500","dateFinished":"2018-08-10T10:39:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\n#Carga los datos del DF en la tabla HBase llamada MOVIESDB. P\n\nloadedmoviesdbDF.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"MOVIESDB\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-08-10T10:39:53-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533910063007_646605612","id":"20180810-090743_10304283","dateCreated":"2018-08-10T09:07:43-0500","dateStarted":"2018-08-10T10:39:53-0500","dateFinished":"2018-08-10T10:44:37-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\n#Guarda de un DF a un CSV\nloadedmoviesdbDF.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/moviesDB.csv\")\n","user":"hduser","dateUpdated":"2018-08-10T10:52:47-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533911244580_115517501","id":"20180810-092724_164201085","dateCreated":"2018-08-10T09:27:24-0500","dateStarted":"2018-08-10T10:51:18-0500","dateFinished":"2018-08-10T10:51:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2018-08-10T10:46:37-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533915997256_1131829741","id":"20180810-104637_823878951","dateCreated":"2018-08-10T10:46:37-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:65"}],"name":"JSGP/Practicas/6-Proyecto_Final","id":"2DNU59VYJ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
{"paragraphs":[{"title":"Instructions tu use this notebook:","text":"%md\n# **ETL - LOAD**\n\nThis notebook saves all generated dataframes to csv files and puts them in the HDFS. \n\n1. You need first run\n\n    - [ETL - Extraction Notebook](http://big0.iie.org.mx:10002/#/notebook/2DUXFQPGZ)\n    - [ETL - Transformation Notebook](http://big0.iie.org.mx:10002/#/notebook/2DWV7Z8C8)\n    \n2. Once you have run those notebooks, please create HBASE tables as follows:\n\n    In shell, type:\n    ```shell\n    hbase shell\n    ```\n    Then, in hbase shell, create tables:\n    ```shell\n    create \"UK_HD\", \"UK\"\n    create \"ACORN_CATS\", \"CAT\"\n    create \"ACORN_GROUPS\", \"GROUP\"\n    create \"INFORMATION_HOUSEHOLDS\", \"IH\"\n    create \"WEATHER_DAILY\", \"WD\"\n    create \"WEATHER_HOURLY\", \"WH\"\n    create \"HALF_TS\",\"HH\"\n    create \"HALF_11\", \"HH\"\n    create \"HALF_12\", \"HH\"\n    create \"HALF_13\", \"HH\"\n    create \"HALF_14\", \"HH\"\n    create \"HOUR_TS\",\"HOUR\"\n    create \"HOUR_11\", \"HOUR\"\n    create \"HOUR_12\", \"HOUR\"\n    create \"HOUR_13\", \"HOUR\"\n    create \"HOUR_14\", \"HOUR\"\n    create \"DAY_TS\", \"DAY\"\n    create \"MONTH_TS\", \"MONTH\"\n    create \"HH_DF\", \"HH_DF\"\n    create \"HOUR_DF\", \"HOUR\"\n    create \"DAY_DF\", \"DAY\"\n    create \"TARIFF_VAL\", \"TARIFF\"\n    create \"TARIFF_TS\", \"TARIFF\"\n    create \"METERS_DB\", \"METER\"\n    ```\n\n3. Proceed to **run this notebook**\n4. Populate HBase tables runnig the following script: \n\n    In shell, type:\n    \n    ```shell\n    ./<path_to_file>/upload_hbase.sh\n    ```\n    \n5. Once tables are populated, remove header lines. Since import script from file adds the header line as a row, you have to remove them from tables.\n\n     In shell, type:\n    ```shell\n    hbase shell\n    ```\n    Then, in hbase shell, create tables:\n    ```shell\n    deleteall \"UK_HD\", \"ID\"\n    deleteall \"ACORN_CATS\", \"ACORN_CAT\"\n    deleteall \"ACORN_GROUPS\", \"ID\"\n    deleteall \"INFORMATION_HOUSEHOLDS\", \"ID\"\n    deleteall \"WEATHER_DAILY\", \"ID\"\n    deleteall \"WEATHER_HOURLY\", \"ID\"\n    deleteall \"HALF_TS\", \"ID\"\n    deleteall \"HALF_11\", \"ID\"\n    deleteall \"HALF_12\", \"ID\"\n    deleteall \"HALF_13\", \"ID\"\n    deleteall \"HALF_14\", \"ID\"\n    deleteall \"HOUR_TS\", \"ID\"\n    deleteall \"HOUR_11\", \"ID\"\n    deleteall \"HOUR_12\", \"ID\"\n    deleteall \"HOUR_13\", \"ID\"\n    deleteall \"HOUR_14\", \"ID\"\n    deleteall \"DAY_TS\", \"ID\"\n    deleteall \"MONTH_TS\", \"ID\"\n    deleteall \"HH_DF\", \"ID\"\n    deleteall \"HOUR_DF\", \"ID\"\n    deleteall \"DAY_DF\", \"ID\"\n    deleteall \"TARIFF_VAL\", \"ID\"\n    deleteall \"TARIFF_TS\", \"ID\"\n    deleteall \"METERS_DB\", \"ID\"\n    ```\n6. Map HBase populated tables to Phoenix tables as follows:\n\n    In shell, on phoenix's parent folder, type:\n    \n    ```shell\n    apache-phoenix-4.10.0-HBase-1.2-bin/bin/sqlline.py\n    ```\n    Then, in hbase-phoenix shell, map the tables:\n\n    ```shell\n    CREATE TABLE \"UK_HD\" (ID VARCHAR PRIMARY KEY, \"UK\".\"HD_DATE\" VARCHAR, \"UK\".\"HD_NAME\" VARCHAR);\n    CREATE TABLE \"ACORN_CATS\" (ACORN_CAT VARCHAR PRIMARY KEY, \"CAT\".\"ACORN_CAT_NAME\" VARCHAR, \"CAT\".\"CAT_POPULATION\" VARCHAR);\n    CREATE TABLE \"ACORN_GROUPS\" (ID VARCHAR PRIMARY KEY, \"GROUP\".\"ACORN_CAT\" VARCHAR, \"GROUP\".\"ACORN_GROUP\" VARCHAR, \"GROUP\".\"ACORN_CAT_NAME\" VARCHAR);\n    CREATE TABLE \"INFORMATION_HOUSEHOLDS\" (ID VARCHAR PRIMARY KEY, \"IH\".\"METER_ID\" VARCHAR, \"IH\".\"STD_TOU\" VARCHAR, \"IH\".\"ACORN_CAT\" VARCHAR, \"IH\".\"ACORN_CAT_NAME\" VARCHAR,  \"IH\".\"ACORN_GROUP\" VARCHAR);\n    CREATE TABLE \"WEATHER_DAILY\" (ID VARCHAR PRIMARY KEY, \"WD\".\"DATE\" VARCHAR, \"WD\".\"TEMP_MAX\" VARCHAR, \"WD\".\"TEMP_MAX_TIME\" VARCHAR, \"WD\".\"TEMP_MIN\" VARCHAR, \"WD\".\"TEMP_MIN_TIME\" VARCHAR, \"WD\".\"PRESSURE\" VARCHAR, \"WD\".\"HUMIDITY\" VARCHAR, \"WD\".\"UV_INDEX\" VARCHAR, \"WD\".\"SUNRISE_TIME\" VARCHAR, \"WD\".\"SUNSET_TIME\" VARCHAR, \"WD\".\"LIGHT_HOURS\" VARCHAR);    CREATE TABLE \"WEATHER_HOURLY\" (ID VARCHAR PRIMARY KEY, \"WH\".\"DATETIME\" VARCHAR, \"WH\".\"DATE\" VARCHAR, \"WH\".\"TEMPERATURE\" VARCHAR, \"WH\".\"PRESSURE\" VARCHAR, \"WH\".\"HUMIDITY\" VARCHAR);\n    CREATE TABLE \"HALF_TS\" (ID VARCHAR PRIMARY KEY, \"HH\".\"METER_ID\" VARCHAR, \"HH\".\"TIMESTAMP\" VARCHAR, \"HH\".\"DATE\" VARCHAR, \"HH\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HALF_11\" (ID VARCHAR PRIMARY KEY, \"HH\".\"METER_ID\" VARCHAR, \"HH\".\"DATE\" VARCHAR, \"HH\".\"TIMESTAMP\" VARCHAR, \"HH\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HALF_12\" (ID VARCHAR PRIMARY KEY, \"HH\".\"METER_ID\" VARCHAR, \"HH\".\"DATE\" VARCHAR, \"HH\".\"TIMESTAMP\" VARCHAR, \"HH\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HALF_13\" (ID VARCHAR PRIMARY KEY, \"HH\".\"METER_ID\" VARCHAR, \"HH\".\"DATE\" VARCHAR, \"HH\".\"TIMESTAMP\" VARCHAR, \"HH\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HALF_14\" (ID VARCHAR PRIMARY KEY, \"HH\".\"METER_ID\" VARCHAR, \"HH\".\"DATE\" VARCHAR, \"HH\".\"TIMESTAMP\" VARCHAR, \"HH\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HOUR_TS\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"TIMESTAMP\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HOUR_11\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"TIMESTAMP\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"HD\" VARCHAR, \"HOUR\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HOUR_12\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"TIMESTAMP\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"HD\" VARCHAR, \"HOUR\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HOUR_13\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"TIMESTAMP\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"HD\" VARCHAR, \"HOUR\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"HOUR_14\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"TIMESTAMP\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"HD\" VARCHAR, \"HOUR\".\"ENERGY\" VARCHAR);\n    CREATE TABLE \"DAY_TS\" (ID VARCHAR PRIMARY KEY, \"DAY\".\"METER_ID\" VARCHAR, \"DAY\".\"DATE\" VARCHAR, \"DAY\".\"ENERGY\" VARCHAR, \"DAY\".\"E_MAX\" VARCHAR);\n    CREATE TABLE \"MONTH_DF\" (ID VARCHAR PRIMARY KEY, \"MONTH\".\"METER_ID\" VARCHAR, \"MONTH\".\"YEAR\" VARCHAR, \"MONTH\".\"MONTH\" VARCHAR, \"MONTH\".\"MONTH_E\" VARCHAR, \"MONTH\".\"COUNT_MONTH\" VARCHAR, \"MONTH\".\"AVG_DAY\" VARCHAR, \"MONTH\".\"MAX_DAY_E\" VARCHAR);\n    CREATE TABLE \"HH_DF\" (ID VARCHAR PRIMARY KEY, \"HH_DF\".\"METER_ID\" VARCHAR, \"HH_DF\".\"DATE\" VARCHAR, \"HH_DF\".\"HH0\" VARCHAR, \"HH_DF\".\"HH1\" VARCHAR, \"HH_DF\".\"HH2\" VARCHAR, \"HH_DF\".\"HH3\" VARCHAR, \"HH_DF\".\"HH4\" VARCHAR, \"HH_DF\".\"HH5\" VARCHAR, \"HH_DF\".\"HH6\" VARCHAR, \"HH_DF\".\"HH7\" VARCHAR, \"HH_DF\".\"HH8\" VARCHAR, \"HH_DF\".\"HH9\" VARCHAR, \"HH_DF\".\"HH10\" VARCHAR, \"HH_DF\".\"HH11\" VARCHAR, \"HH_DF\".\"HH12\" VARCHAR, \"HH_DF\".\"HH13\" VARCHAR, \"HH_DF\".\"HH14\" VARCHAR, \"HH_DF\".\"HH15\" VARCHAR, \"HH_DF\".\"HH16\" VARCHAR, \"HH_DF\".\"HH17\" VARCHAR, \"HH_DF\".\"HH18\" VARCHAR, \"HH_DF\".\"HH19\" VARCHAR, \"HH_DF\".\"HH20\" VARCHAR, \"HH_DF\".\"HH21\" VARCHAR, \"HH_DF\".\"HH22\" VARCHAR, \"HH_DF\".\"HH23\" VARCHAR, \"HH_DF\".\"HH24\" VARCHAR, \"HH_DF\".\"HH25\" VARCHAR, \"HH_DF\".\"HH26\" VARCHAR, \"HH_DF\".\"HH27\" VARCHAR, \"HH_DF\".\"HH28\" VARCHAR, \"HH_DF\".\"HH29\" VARCHAR, \"HH_DF\".\"HH30\" VARCHAR, \"HH_DF\".\"HH31\" VARCHAR, \"HH_DF\".\"HH32\" VARCHAR, \"HH_DF\".\"HH33\" VARCHAR, \"HH_DF\".\"HH34\" VARCHAR, \"HH_DF\".\"HH35\" VARCHAR, \"HH_DF\".\"HH36\" VARCHAR, \"HH_DF\".\"HH37\" VARCHAR, \"HH_DF\".\"HH38\" VARCHAR, \"HH_DF\".\"HH39\" VARCHAR, \"HH_DF\".\"HH40\" VARCHAR, \"HH_DF\".\"HH41\" VARCHAR, \"HH_DF\".\"HH42\" VARCHAR, \"HH_DF\".\"HH43\" VARCHAR, \"HH_DF\".\"HH44\" VARCHAR, \"HH_DF\".\"HH45\" VARCHAR, \"HH_DF\".\"HH46\" VARCHAR, \"HH_DF\".\"HH47\" VARCHAR);\n    CREATE TABLE \"HOUR_DF\" (ID VARCHAR PRIMARY KEY, \"HOUR\".\"METER_ID\" VARCHAR, \"HOUR\".\"DATE\" VARCHAR, \"HOUR\".\"H0\" VARCHAR, \"HOUR\".\"H1\" VARCHAR, \"HOUR\".\"H2\" VARCHAR, \"HOUR\".\"H3\" VARCHAR, \"HOUR\".\"H4\" VARCHAR, \"HOUR\".\"H5\" VARCHAR, \"HOUR\".\"H6\" VARCHAR, \"HOUR\".\"H7\" VARCHAR, \"HOUR\".\"H8\" VARCHAR, \"HOUR\".\"H9\" VARCHAR, \"HOUR\".\"H10\" VARCHAR, \"HOUR\".\"H11\" VARCHAR, \"HOUR\".\"H12\" VARCHAR, \"HOUR\".\"H13\" VARCHAR, \"HOUR\".\"H14\" VARCHAR, \"HOUR\".\"H15\" VARCHAR, \"HOUR\".\"H16\" VARCHAR, \"HOUR\".\"H17\" VARCHAR, \"HOUR\".\"H18\" VARCHAR, \"HOUR\".\"H19\" VARCHAR, \"HOUR\".\"H20\" VARCHAR, \"HOUR\".\"H21\" VARCHAR, \"HOUR\".\"H22\" VARCHAR, \"HOUR\".\"H23\" VARCHAR, \"HOUR\".\"HD\" VARCHAR, \"HOUR\".\"MAX_E\" VARCHAR, \"HOUR\".\"MAX_TIME\" VARCHAR);\n    CREATE TABLE \"DAY_DF\" (ID VARCHAR PRIMARY KEY, \"DAY\".\"METER_ID\" VARCHAR, \"DAY\".\"DATE\" VARCHAR, \"DAY\".\"HD\" VARCHAR, \"DAY\".\"MAX_E\" VARCHAR, \"DAY\".\"MAX_TIME\" VARCHAR, \"DAY\".\"DAY_E\" VARCHAR);\n    CREATE TABLE \"TARIFF_VAL\" (ID VARCHAR PRIMARY KEY, \"TARIFF\".\"DATE\" VARCHAR, \"TARIFF\".\"HH0\" VARCHAR, \"TARIFF\".\"HH1\" VARCHAR, \"TARIFF\".\"HH2\" VARCHAR, \"TARIFF\".\"HH3\" VARCHAR, \"TARIFF\".\"HH4\" VARCHAR, \"TARIFF\".\"HH5\" VARCHAR, \"TARIFF\".\" HH6\" VARCHAR, \"TARIFF\".\"HH7\" VARCHAR, \"TARIFF\".\"HH8\" VARCHAR, \"TARIFF\".\"HH9\" VARCHAR, \"TARIFF\".\"HH10\" VARCHAR, \"TARIFF\".\"HH11\" VARCHAR, \"TARIFF\".\"HH12\" VARCHAR, \"TARIFF\".\"HH13\" VARCHAR, \"TARIFF\".\"HH14\" VARCHAR, \"TARIFF\".\"HH15\" VARCHAR, \"TARIFF\".\"HH16\" VARCHAR, \"TARIFF\".\"HH17\" VARCHAR, \"TARIFF\".\"HH18\" VARCHAR, \"TARIFF\".\"HH19\" VARCHAR, \"TARIFF\".\"HH20\" VARCHAR, \"TARIFF\".\"HH21\" VARCHAR, \"TARIFF\".\"HH22\" VARCHAR, \"TARIFF\".\"HH23\" VARCHAR, \"TARIFF\".\"HH24\" VARCHAR, \"TARIFF\".\"HH25\" VARCHAR, \"TARIFF\".\"HH26\" VARCHAR, \"TARIFF\".\"HH27\" VARCHAR, \"TARIFF\".\"HH28\" VARCHAR, \"TARIFF\".\"HH29\" VARCHAR, \"TARIFF\".\"HH30\" VARCHAR, \"TARIFF\".\"HH31\" VARCHAR, \"TARIFF\".\"HH32\" VARCHAR, \"TARIFF\".\"HH33\" VARCHAR, \"TARIFF\".\"HH34\" VARCHAR, \"TARIFF\".\"HH35\" VARCHAR, \"TARIFF\".\"HH36\" VARCHAR, \"TARIFF\".\"HH37\" VARCHAR, \"TARIFF\".\"HH38\" VARCHAR, \"TARIFF\".\"HH39\" VARCHAR, \"TARIFF\".\"HH40\" VARCHAR, \"TARIFF\".\"HH41\" VARCHAR, \"TARIFF\".\"HH42\" VARCHAR, \"TARIFF\".\"HH43\" VARCHAR, \"TARIFF\".\"HH44\" VARCHAR, \"TARIFF\".\"HH45\" VARCHAR, \"TARIFF\".\"HH46\" VARCHAR, \"TARIFF\".\"HH47\" VARCHAR, \"TARIFF\".\"HD\" VARCHAR);\n    CREATE TABLE \"TARIFF_TS\" (ID VARCHAR PRIMARY KEY, \"TARIFF\".\"TIMESTAMP\" VARCHAR, \"TARIFF\".\"TARIFF\" VARCHAR, \"TARIFF\".\"VALUE\" VARCHAR);\n    CREATE TABLE \"METERS_DB\" (ID VARCHAR PRIMARY KEY, \"METER\".\"METER_ID\" VARCHAR, \"METER\".\"STD_TOU\" VARCHAR, \"METER\".\"ACORN_CAT\" VARCHAR, \"METER\".\"ACORN_CAT_NAME\" VARCHAR, \"METER\".\"ACORN_GROUP\" VARCHAR, \"METER\".\"MEAN_MONTH\" VARCHAR, \"METER\".\"MEAN_HD\" VARCHAR, \"METER\".\"MEAN_WD\" VARCHAR, \"METER\".\"MEAN_SD\" VARCHAR, \"METER\".\"MEAN_MAX\" VARCHAR, \"METER\".\"MEAN_MAX_H\" VARCHAR, \"METER\".\"MEAN_MAX_H_TIME\" VARCHAR);\n    ```\n","user":"hduser","dateUpdated":"2019-01-02T15:34:21-0600","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1><strong>ETL - LOAD</strong></h1>\n<p>This notebook saves all generated dataframes to csv files and puts them in the HDFS. </p>\n<ol>\n  <li>\n    <p>You need first run</p>\n    <ul>\n      <li><a href=\"http://big0.iie.org.mx:10002/#/notebook/2DUXFQPGZ\">ETL - Extraction Notebook</a></li>\n      <li><a href=\"http://big0.iie.org.mx:10002/#/notebook/2DWV7Z8C8\">ETL - Transformation Notebook</a></li>\n    </ul>\n  </li>\n  <li>\n    <p>Once you have run those notebooks, please create HBASE tables as follows:</p>\n    <p>In shell, type:</p>\n    <pre><code class=\"shell\">hbase shell\n</code></pre>\n    <p>Then, in hbase shell, create tables:</p>\n    <pre><code class=\"shell\">create &quot;UK_HD&quot;, &quot;UK&quot;\ncreate &quot;ACORN_CATS&quot;, &quot;CAT&quot;\ncreate &quot;ACORN_GROUPS&quot;, &quot;GROUP&quot;\ncreate &quot;INFORMATION_HOUSEHOLDS&quot;, &quot;IH&quot;\ncreate &quot;WEATHER_DAILY&quot;, &quot;WD&quot;\ncreate &quot;WEATHER_HOURLY&quot;, &quot;WH&quot;\ncreate &quot;HALF_TS&quot;,&quot;HH&quot;\ncreate &quot;HALF_11&quot;, &quot;HH&quot;\ncreate &quot;HALF_12&quot;, &quot;HH&quot;\ncreate &quot;HALF_13&quot;, &quot;HH&quot;\ncreate &quot;HALF_14&quot;, &quot;HH&quot;\ncreate &quot;HOUR_TS&quot;,&quot;HOUR&quot;\ncreate &quot;HOUR_11&quot;, &quot;HOUR&quot;\ncreate &quot;HOUR_12&quot;, &quot;HOUR&quot;\ncreate &quot;HOUR_13&quot;, &quot;HOUR&quot;\ncreate &quot;HOUR_14&quot;, &quot;HOUR&quot;\ncreate &quot;DAY_TS&quot;, &quot;DAY&quot;\ncreate &quot;MONTH_TS&quot;, &quot;MONTH&quot;\ncreate &quot;HH_DF&quot;, &quot;HH_DF&quot;\ncreate &quot;HOUR_DF&quot;, &quot;HOUR&quot;\ncreate &quot;DAY_DF&quot;, &quot;DAY&quot;\ncreate &quot;TARIFF_VAL&quot;, &quot;TARIFF&quot;\ncreate &quot;TARIFF_TS&quot;, &quot;TARIFF&quot;\ncreate &quot;METERS_DB&quot;, &quot;METER&quot;\n</code></pre>\n  </li>\n  <li>\n  <p>Proceed to <strong>run this notebook</strong></p></li>\n  <li>Populate HBase tables runnig the following script:\n    <p>In shell, type:</p>\n    <pre><code class=\"shell\">./&lt;path_to_file&gt;/upload_hbase.sh\n</code></pre>\n  </li>\n  <li>\n    <p>Once tables are populated, remove header lines. Since import script from file adds the header line as a row, you have to remove them from tables.</p>\n    <p>In shell, type:</p>\n    <pre><code class=\"shell\">hbase shell\n</code></pre>\n    <p>Then, in hbase shell, create tables:</p>\n    <pre><code class=\"shell\">deleteall &quot;UK_HD&quot;, &quot;ID&quot;\ndeleteall &quot;ACORN_CATS&quot;, &quot;ACORN_CAT&quot;\ndeleteall &quot;ACORN_GROUPS&quot;, &quot;ID&quot;\ndeleteall &quot;INFORMATION_HOUSEHOLDS&quot;, &quot;ID&quot;\ndeleteall &quot;WEATHER_DAILY&quot;, &quot;ID&quot;\ndeleteall &quot;WEATHER_HOURLY&quot;, &quot;ID&quot;\ndeleteall &quot;HALF_TS&quot;, &quot;ID&quot;\ndeleteall &quot;HALF_11&quot;, &quot;ID&quot;\ndeleteall &quot;HALF_12&quot;, &quot;ID&quot;\ndeleteall &quot;HALF_13&quot;, &quot;ID&quot;\ndeleteall &quot;HALF_14&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_TS&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_11&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_12&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_13&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_14&quot;, &quot;ID&quot;\ndeleteall &quot;DAY_TS&quot;, &quot;ID&quot;\ndeleteall &quot;MONTH_TS&quot;, &quot;ID&quot;\ndeleteall &quot;HH_DF&quot;, &quot;ID&quot;\ndeleteall &quot;HOUR_DF&quot;, &quot;ID&quot;\ndeleteall &quot;DAY_DF&quot;, &quot;ID&quot;\ndeleteall &quot;TARIFF_VAL&quot;, &quot;ID&quot;\ndeleteall &quot;TARIFF_TS&quot;, &quot;ID&quot;\ndeleteall &quot;METERS_DB&quot;, &quot;ID&quot;\n</code></pre>\n  </li>\n  <li>Map HBase populated tables to Phoenix tables as follows:\n    <p>In shell, on phoenix&rsquo;s parent folder, type:</p>\n    <pre><code class=\"shell\">apache-phoenix-4.10.0-HBase-1.2-bin/bin/sqlline.py\n</code></pre>\n    <p>Then, in hbase-phoenix shell, map the tables:</p>\n    <pre><code class=\"shell\">CREATE TABLE &quot;UK_HD&quot; (ID VARCHAR PRIMARY KEY, &quot;UK&quot;.&quot;HD_DATE&quot; VARCHAR, &quot;UK&quot;.&quot;HD_NAME&quot; VARCHAR);\nCREATE TABLE &quot;ACORN_CATS&quot; (ACORN_CAT VARCHAR PRIMARY KEY, &quot;CAT&quot;.&quot;ACORN_CAT_NAME&quot; VARCHAR, &quot;CAT&quot;.&quot;CAT_POPULATION&quot; VARCHAR);\nCREATE TABLE &quot;ACORN_GROUPS&quot; (ID VARCHAR PRIMARY KEY, &quot;GROUP&quot;.&quot;ACORN_CAT&quot; VARCHAR, &quot;GROUP&quot;.&quot;ACORN_GROUP&quot; VARCHAR, &quot;GROUP&quot;.&quot;ACORN_CAT_NAME&quot; VARCHAR);\nCREATE TABLE &quot;INFORMATION_HOUSEHOLDS&quot; (ID VARCHAR PRIMARY KEY, &quot;IH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;IH&quot;.&quot;STD_TOU&quot; VARCHAR, &quot;IH&quot;.&quot;ACORN_CAT&quot; VARCHAR, &quot;IH&quot;.&quot;ACORN_CAT_NAME&quot; VARCHAR,  &quot;IH&quot;.&quot;ACORN_GROUP&quot; VARCHAR);\nCREATE TABLE &quot;WEATHER_DAILY&quot; (ID VARCHAR PRIMARY KEY, &quot;WD&quot;.&quot;DATE&quot; VARCHAR, &quot;WD&quot;.&quot;TEMP_MAX&quot; VARCHAR, &quot;WD&quot;.&quot;TEMP_MAX_TIME&quot; VARCHAR, &quot;WD&quot;.&quot;TEMP_MIN&quot; VARCHAR, &quot;WD&quot;.&quot;TEMP_MIN_TIME&quot; VARCHAR, &quot;WD&quot;.&quot;PRESSURE&quot; VARCHAR, &quot;WD&quot;.&quot;HUMIDITY&quot; VARCHAR, &quot;WD&quot;.&quot;UV_INDEX&quot; VARCHAR, &quot;WD&quot;.&quot;SUNRISE_TIME&quot; VARCHAR, &quot;WD&quot;.&quot;SUNSET_TIME&quot; VARCHAR, &quot;WD&quot;.&quot;LIGHT_HOURS&quot; VARCHAR);    CREATE TABLE &quot;WEATHER_HOURLY&quot; (ID VARCHAR PRIMARY KEY, &quot;WH&quot;.&quot;DATETIME&quot; VARCHAR, &quot;WH&quot;.&quot;DATE&quot; VARCHAR, &quot;WH&quot;.&quot;TEMPERATURE&quot; VARCHAR, &quot;WH&quot;.&quot;PRESSURE&quot; VARCHAR, &quot;WH&quot;.&quot;HUMIDITY&quot; VARCHAR);\nCREATE TABLE &quot;HALF_TS&quot; (ID VARCHAR PRIMARY KEY, &quot;HH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HH&quot;.&quot;DATE&quot; VARCHAR, &quot;HH&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HALF_11&quot; (ID VARCHAR PRIMARY KEY, &quot;HH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH&quot;.&quot;DATE&quot; VARCHAR, &quot;HH&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HH&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HALF_12&quot; (ID VARCHAR PRIMARY KEY, &quot;HH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH&quot;.&quot;DATE&quot; VARCHAR, &quot;HH&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HH&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HALF_13&quot; (ID VARCHAR PRIMARY KEY, &quot;HH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH&quot;.&quot;DATE&quot; VARCHAR, &quot;HH&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HH&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HALF_14&quot; (ID VARCHAR PRIMARY KEY, &quot;HH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH&quot;.&quot;DATE&quot; VARCHAR, &quot;HH&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HH&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_TS&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_11&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;HD&quot; VARCHAR, &quot;HOUR&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_12&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;HD&quot; VARCHAR, &quot;HOUR&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_13&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;HD&quot; VARCHAR, &quot;HOUR&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_14&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;HD&quot; VARCHAR, &quot;HOUR&quot;.&quot;ENERGY&quot; VARCHAR);\nCREATE TABLE &quot;DAY_TS&quot; (ID VARCHAR PRIMARY KEY, &quot;DAY&quot;.&quot;METER_ID&quot; VARCHAR, &quot;DAY&quot;.&quot;DATE&quot; VARCHAR, &quot;DAY&quot;.&quot;ENERGY&quot; VARCHAR, &quot;DAY&quot;.&quot;E_MAX&quot; VARCHAR);\nCREATE TABLE &quot;MONTH_DF&quot; (ID VARCHAR PRIMARY KEY, &quot;MONTH&quot;.&quot;METER_ID&quot; VARCHAR, &quot;MONTH&quot;.&quot;YEAR&quot; VARCHAR, &quot;MONTH&quot;.&quot;MONTH&quot; VARCHAR, &quot;MONTH&quot;.&quot;MONTH_E&quot; VARCHAR, &quot;MONTH&quot;.&quot;COUNT_MONTH&quot; VARCHAR, &quot;MONTH&quot;.&quot;AVG_DAY&quot; VARCHAR, &quot;MONTH&quot;.&quot;MAX_DAY_E&quot; VARCHAR);\nCREATE TABLE &quot;HH_DF&quot; (ID VARCHAR PRIMARY KEY, &quot;HH_DF&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HH_DF&quot;.&quot;DATE&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH0&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH1&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH2&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH3&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH4&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH5&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH6&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH7&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH8&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH9&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH10&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH11&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH12&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH13&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH14&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH15&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH16&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH17&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH18&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH19&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH20&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH21&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH22&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH23&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH24&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH25&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH26&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH27&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH28&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH29&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH30&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH31&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH32&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH33&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH34&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH35&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH36&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH37&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH38&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH39&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH40&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH41&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH42&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH43&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH44&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH45&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH46&quot; VARCHAR, &quot;HH_DF&quot;.&quot;HH47&quot; VARCHAR);\nCREATE TABLE &quot;HOUR_DF&quot; (ID VARCHAR PRIMARY KEY, &quot;HOUR&quot;.&quot;METER_ID&quot; VARCHAR, &quot;HOUR&quot;.&quot;DATE&quot; VARCHAR, &quot;HOUR&quot;.&quot;H0&quot; VARCHAR, &quot;HOUR&quot;.&quot;H1&quot; VARCHAR, &quot;HOUR&quot;.&quot;H2&quot; VARCHAR, &quot;HOUR&quot;.&quot;H3&quot; VARCHAR, &quot;HOUR&quot;.&quot;H4&quot; VARCHAR, &quot;HOUR&quot;.&quot;H5&quot; VARCHAR, &quot;HOUR&quot;.&quot;H6&quot; VARCHAR, &quot;HOUR&quot;.&quot;H7&quot; VARCHAR, &quot;HOUR&quot;.&quot;H8&quot; VARCHAR, &quot;HOUR&quot;.&quot;H9&quot; VARCHAR, &quot;HOUR&quot;.&quot;H10&quot; VARCHAR, &quot;HOUR&quot;.&quot;H11&quot; VARCHAR, &quot;HOUR&quot;.&quot;H12&quot; VARCHAR, &quot;HOUR&quot;.&quot;H13&quot; VARCHAR, &quot;HOUR&quot;.&quot;H14&quot; VARCHAR, &quot;HOUR&quot;.&quot;H15&quot; VARCHAR, &quot;HOUR&quot;.&quot;H16&quot; VARCHAR, &quot;HOUR&quot;.&quot;H17&quot; VARCHAR, &quot;HOUR&quot;.&quot;H18&quot; VARCHAR, &quot;HOUR&quot;.&quot;H19&quot; VARCHAR, &quot;HOUR&quot;.&quot;H20&quot; VARCHAR, &quot;HOUR&quot;.&quot;H21&quot; VARCHAR, &quot;HOUR&quot;.&quot;H22&quot; VARCHAR, &quot;HOUR&quot;.&quot;H23&quot; VARCHAR, &quot;HOUR&quot;.&quot;HD&quot; VARCHAR, &quot;HOUR&quot;.&quot;MAX_E&quot; VARCHAR, &quot;HOUR&quot;.&quot;MAX_TIME&quot; VARCHAR);\nCREATE TABLE &quot;DAY_DF&quot; (ID VARCHAR PRIMARY KEY, &quot;DAY&quot;.&quot;METER_ID&quot; VARCHAR, &quot;DAY&quot;.&quot;DATE&quot; VARCHAR, &quot;DAY&quot;.&quot;HD&quot; VARCHAR, &quot;DAY&quot;.&quot;MAX_E&quot; VARCHAR, &quot;DAY&quot;.&quot;MAX_TIME&quot; VARCHAR, &quot;DAY&quot;.&quot;DAY_E&quot; VARCHAR);\nCREATE TABLE &quot;TARIFF_VAL&quot; (ID VARCHAR PRIMARY KEY, &quot;TARIFF&quot;.&quot;DATE&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH0&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH1&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH2&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH3&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH4&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH5&quot; VARCHAR, &quot;TARIFF&quot;.&quot; HH6&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH7&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH8&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH9&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH10&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH11&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH12&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH13&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH14&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH15&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH16&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH17&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH18&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH19&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH20&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH21&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH22&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH23&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH24&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH25&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH26&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH27&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH28&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH29&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH30&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH31&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH32&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH33&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH34&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH35&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH36&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH37&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH38&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH39&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH40&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH41&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH42&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH43&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH44&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH45&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH46&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HH47&quot; VARCHAR, &quot;TARIFF&quot;.&quot;HD&quot; VARCHAR);\nCREATE TABLE &quot;TARIFF_TS&quot; (ID VARCHAR PRIMARY KEY, &quot;TARIFF&quot;.&quot;TIMESTAMP&quot; VARCHAR, &quot;TARIFF&quot;.&quot;TARIFF&quot; VARCHAR, &quot;TARIFF&quot;.&quot;VALUE&quot; VARCHAR);\nCREATE TABLE &quot;METERS_DB&quot; (ID VARCHAR PRIMARY KEY, &quot;METER&quot;.&quot;METER_ID&quot; VARCHAR, &quot;METER&quot;.&quot;STD_TOU&quot; VARCHAR, &quot;METER&quot;.&quot;ACORN_CAT&quot; VARCHAR, &quot;METER&quot;.&quot;ACORN_CAT_NAME&quot; VARCHAR, &quot;METER&quot;.&quot;ACORN_GROUP&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_MONTH&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_HD&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_WD&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_SD&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_MAX&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_MAX_H&quot; VARCHAR, &quot;METER&quot;.&quot;MEAN_MAX_H_TIME&quot; VARCHAR);\n</code></pre>\n  </li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1544042984989_2087433393","id":"20181205-142801_925348895","dateCreated":"2018-12-05T14:49:44-0600","dateStarted":"2018-12-13T08:50:06-0600","dateFinished":"2018-12-13T08:50:06-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:55"},{"text":"%pyspark\n\nstartTimeQueryG= time.time()\nstartTimeQuery = time.time()\nuk_hd.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/uk_hd.csv\")\nmes_et(startTimeQuery)\n#uk_hd.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"UK_HD\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:33-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.627179861069 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985000_1156856078","id":"20181203-110139_323920899","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:33-0600","dateFinished":"2018-12-11T16:31:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nacorn_cats.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn_cats.csv\")\nmes_et(startTimeQuery)\n#acorn_cats.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"ACORN_CATS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:33-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.229216814041 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985002_-357138763","id":"20181203-114247_877375609","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:33-0600","dateFinished":"2018-12-11T16:31:34-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nacorn_groups.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn_groups.csv\")\nmes_et(startTimeQuery)\n#acorn_groups.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"ACORN_GROUPS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:34-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.583743810654 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985002_363393664","id":"20181203-114251_1197297527","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:34-0600","dateFinished":"2018-12-11T16:31:34-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\ninformation_households.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/information_households.csv\")\nmes_et(startTimeQuery)\n#information_households.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"INFORMATION_HOUSEHOLDS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:34-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.425863981247 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985003_-1616153687","id":"20181203-114253_276470432","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:34-0600","dateFinished":"2018-12-11T16:31:35-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nweather_daily_darksky.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/weather_daily.csv\")\n\nmes_et(startTimeQuery)\n#weather_daily_darksky.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"WEATHER_DAILY\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:35-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.52138710022 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985004_57760267","id":"20181203-114255_546831940","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:35-0600","dateFinished":"2018-12-11T16:31:35-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nweather_hourly_darksky.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/weather_hourly.csv\")\n\nmes_et(startTimeQuery)\n#weather_hourly_darksky.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"WEATHER_HOURLY\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:36-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.732060909271 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985005_450813580","id":"20181203-114257_555671810","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T16:31:36-0600","dateFinished":"2018-12-11T16:31:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nhalf_ts.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/half_ts.csv\")\n\nmes_et(startTimeQuery)\n#hh_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"HH_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T16:31:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 1195.88533092 seconds\n"}]},"apps":[],"jobName":"paragraph_1544562696211_858262069","id":"20181211-151136_886857884","dateCreated":"2018-12-11T15:11:36-0600","dateStarted":"2018-12-11T16:31:36-0600","dateFinished":"2018-12-11T16:51:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\nstartTimeQuery = time.time()\nhalf_11.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/half_11.csv\")\nhalf_12.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/half_12.csv\")\nhalf_13.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/half_13.csv\")\nhalf_14.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/half_14.csv\")\n\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-13T08:45:30-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 2711.73063397 seconds\n"}]},"apps":[],"jobName":"paragraph_1544712277467_178710233","id":"20181213-084437_1550161292","dateCreated":"2018-12-13T08:44:37-0600","dateStarted":"2018-12-13T08:45:30-0600","dateFinished":"2018-12-13T09:30:42-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\n\nacorn1.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn1.csv\")\nacorn2.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn2.csv\")\nacorn3.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn3.csv\")\nacorn4.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn4.csv\")\nacorn5.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn5.csv\")","user":"hduser","dateUpdated":"2018-12-17T14:18:38-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1544724928745_-1164651402","id":"20181213-121528_66106359","dateCreated":"2018-12-13T12:15:28-0600","dateStarted":"2018-12-17T14:18:38-0600","dateFinished":"2018-12-17T14:55:01-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nhour_ts.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_ts.csv\")\n\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-11T16:51:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 822.099139929 seconds\n"}]},"apps":[],"jobName":"paragraph_1544562841833_506885434","id":"20181211-151401_1997632179","dateCreated":"2018-12-11T15:14:01-0600","dateStarted":"2018-12-11T16:51:32-0600","dateFinished":"2018-12-11T17:05:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nhour_11.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_11.csv\")\nhour_12.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_12.csv\")\nhour_13.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_13.csv\")\nhour_14.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_14.csv\")\n\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-13T08:46:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 1741.15155411 seconds\n"}]},"apps":[],"jobName":"paragraph_1544712337771_-1545365153","id":"20181213-084537_79131378","dateCreated":"2018-12-13T08:45:37-0600","dateStarted":"2018-12-13T08:46:15-0600","dateFinished":"2018-12-13T09:59:43-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\nhour_11.show(3)","user":"hduser","dateUpdated":"2019-01-14T13:20:29-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---------+-------------------+----------+-----+------+\n|    ID| METER_ID|          TIMESTAMP|      DATE|   HD|ENERGY|\n+------+---------+-------------------+----------+-----+------+\n|168439|MAC000015|2011-12-06 13:00:00|2011-12-06|false| 0.989|\n|168440|MAC000015|2011-12-06 14:00:00|2011-12-06|false|  1.11|\n|168441|MAC000015|2011-12-06 15:00:00|2011-12-06|false| 2.134|\n+------+---------+-------------------+----------+-----+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547493618090_-371578514","id":"20190114-132018_277961402","dateCreated":"2019-01-14T13:20:18-0600","dateStarted":"2019-01-14T13:20:29-0600","dateFinished":"2019-01-14T13:24:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%pyspark\nhour_11.printSchema()\nhour_11.withColumn(\"TIMESTAMP\",col(\"TIMESTAMP\").cast(StringType())).show(3)","user":"hduser","dateUpdated":"2019-01-14T13:25:48-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ID: integer (nullable = true)\n |-- METER_ID: string (nullable = true)\n |-- TIMESTAMP: timestamp (nullable = true)\n |-- DATE: date (nullable = true)\n |-- HD: boolean (nullable = false)\n |-- ENERGY: double (nullable = true)\n\n+------+---------+-------------------+----------+-----+------+\n|    ID| METER_ID|          TIMESTAMP|      DATE|   HD|ENERGY|\n+------+---------+-------------------+----------+-----+------+\n|168439|MAC000015|2011-12-06 13:00:00|2011-12-06|false| 0.989|\n|168440|MAC000015|2011-12-06 14:00:00|2011-12-06|false|  1.11|\n|168441|MAC000015|2011-12-06 15:00:00|2011-12-06|false| 2.134|\n+------+---------+-------------------+----------+-----+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1547493861371_918475538","id":"20190114-132421_1276093116","dateCreated":"2019-01-14T13:24:21-0600","dateStarted":"2019-01-14T13:25:48-0600","dateFinished":"2019-01-14T13:29:31-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%pyspark\nhour_11.withColumn(\"TIMESTAMP\",col(\"TIMESTAMP\").cast(StringType())).write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/darwin/hour_11.csv\")\nhour_12.withColumn(\"TIMESTAMP\",col(\"TIMESTAMP\").cast(StringType())).write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/darwin/hour_12.csv\")\nhour_13.withColumn(\"TIMESTAMP\",col(\"TIMESTAMP\").cast(StringType())).write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/darwin/hour_13.csv\")\nhour_14.withColumn(\"TIMESTAMP\",col(\"TIMESTAMP\").cast(StringType())).write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/darwin/hour_14.csv\")","user":"hduser","dateUpdated":"2019-01-14T14:01:12-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1547493646690_496304792","id":"20190114-132046_297480483","dateCreated":"2019-01-14T13:20:46-0600","dateStarted":"2019-01-14T14:01:12-0600","dateFinished":"2019-01-14T14:38:01-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nday_ts.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/day_ts.csv\")\n\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-11T17:05:14-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 154.606571913 seconds\n"}]},"apps":[],"jobName":"paragraph_1544562870776_-1720138401","id":"20181211-151430_236071291","dateCreated":"2018-12-11T15:14:30-0600","dateStarted":"2018-12-11T17:05:15-0600","dateFinished":"2018-12-11T17:07:49-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%pyspark\nstartTimeQuery = time.time()\nmonth_ts.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/month_ts.csv\")\n\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-11T17:07:49-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 141.616802931 seconds\n"}]},"apps":[],"jobName":"paragraph_1544562885520_1408270959","id":"20181211-151445_2129425591","dateCreated":"2018-12-11T15:14:45-0600","dateStarted":"2018-12-11T17:07:49-0600","dateFinished":"2018-12-11T17:10:11-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nhh_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hh_df.csv\")\n\nmes_et(startTimeQuery)\n#hh_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"HH_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T17:10:11-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 168.749269962 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985005_-795363050","id":"20181203-114259_1542894041","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T17:10:11-0600","dateFinished":"2018-12-11T17:13:00-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nhour_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_df.csv\")\nmes_et(startTimeQuery)\n#hour_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"HOUR_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T17:13:00-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 207.945214987 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985006_1834922832","id":"20181203-145419_1637449492","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T17:13:00-0600","dateFinished":"2018-12-11T17:16:28-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nday_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/day_df.csv\")\nmes_et(startTimeQuery)\n#day_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"DAY_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\n","user":"hduser","dateUpdated":"2018-12-11T17:16:28-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 220.907604933 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985006_-1534020249","id":"20181203-144708_1428444325","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T17:16:28-0600","dateFinished":"2018-12-11T17:20:09-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\ntariff_val.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/tariff_val.csv\")\nmes_et(startTimeQuery)\n#tariff_val.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"TARIFF_VAL\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\n","user":"hduser","dateUpdated":"2018-12-11T17:20:09-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.796622991562 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985007_2016951011","id":"20181203-114304_70803731","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T17:20:09-0600","dateFinished":"2018-12-11T17:20:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\ntariff_ts.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/tariff_ts.csv\")\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-13T10:39:29-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.889442205429 seconds\n"}]},"apps":[],"jobName":"paragraph_1544567405281_293197228","id":"20181211-163005_1296369519","dateCreated":"2018-12-11T16:30:05-0600","dateStarted":"2018-12-13T10:39:29-0600","dateFinished":"2018-12-13T10:39:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"%pyspark\n\n\nstartTimeQuery = time.time()\nmeters_db.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/meters_db.csv\")\nmes_et(startTimeQuery)\n\n#meters_db.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"METERS_DB\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-12-11T17:32:16-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 257.778517008 seconds\n"}]},"apps":[],"jobName":"paragraph_1544042985007_1736663748","id":"20181203-114306_515330514","dateCreated":"2018-12-05T14:49:45-0600","dateStarted":"2018-12-11T17:32:16-0600","dateFinished":"2018-12-11T17:36:34-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2018-12-11T17:32:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544571136640_-1684689771","id":"20181211-173216_1045748542","dateCreated":"2018-12-11T17:32:16-0600","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:78"}],"name":"JSGP/london/ETL-L","id":"2DYJ22P1T","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
{"paragraphs":[{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#uk_hd.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/uk_hd.csv\")\nuk_hd.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"UK_HD\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-05T09:09:23-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Fail to execute line 3: uk_hd.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"UK_HD\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nTraceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-1130091908048199501.py\", line 375, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 3, in <module>\n  File \"/usr/local/bigdata/spark-2.3.2-bin-hadoop2.6/python/lib/pyspark.zip/pyspark/sql/readwriter.py\", line 703, in save\n    self._jwrite.save()\n  File \"/usr/local/bigdata/spark-2.3.2-bin-hadoop2.6/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1255, in __call__\n    answer = self.gateway_client.send_command(command)\n  File \"/usr/local/bigdata/spark-2.3.2-bin-hadoop2.6/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 985, in send_command\n    response = connection.send_command(command)\n  File \"/usr/local/bigdata/spark-2.3.2-bin-hadoop2.6/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py\", line 1152, in send_command\n    answer = smart_decode(self.stream.readline()[:-1])\n  File \"/usr/lib/python2.7/socket.py\", line 447, in readline\n    data = self._sock.recv(self._rbufsize)\n  File \"/usr/local/bigdata/spark-2.3.2-bin-hadoop2.6/python/lib/pyspark.zip/pyspark/context.py\", line 254, in signal_handler\n    raise KeyboardInterrupt()\nKeyboardInterrupt\n"}]},"apps":[],"jobName":"paragraph_1544020346560_414853630","id":"20181203-110139_323920899","dateCreated":"2018-12-05T08:32:26-0600","dateStarted":"2018-12-05T09:09:23-0600","dateFinished":"2018-12-05T09:10:21-0600","status":"ABORT","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:55"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#acorn_cats.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn_cats.csv\")\nacorn_cats.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"ACORN_CATS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:33:01-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.324778079987 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346563_-374335879","id":"20181203-114247_877375609","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#acorn_groups.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/acorn_groups.csv\")\n\nacorn_groups.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"ACORN_GROUPS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)","user":"hduser","dateUpdated":"2018-12-05T08:33:14-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.301837921143 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346564_-579453726","id":"20181203-114251_1197297527","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#information_households.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/information_households.csv\")\ninformation_households.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"INFORMATION_HOUSEHOLDS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:33:35-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.698491096497 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346565_-1746114150","id":"20181203-114253_276470432","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#weather_daily_darksky.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/weather_daily.csv\")\n\nweather_daily_darksky.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"WEATHER_DAILY\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:33:53-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.566553115845 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346566_-784598156","id":"20181203-114255_546831940","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#weather_hourly_darksky.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/weather_hourly.csv\")\n\nweather_hourly_darksky.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"WEATHER_HOURLY\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:34:53-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.512470006943 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346567_778574335","id":"20181203-114257_555671810","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#hh_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hh_df.csv\")\n\nhh_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"HH_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:34:55-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 174.382467031 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346568_276867260","id":"20181203-114259_1542894041","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#hour_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/hour_df.csv\")\nhour_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"HOUR_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:34:57-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 205.279851913 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346569_-1986028127","id":"20181203-145419_1637449492","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#day_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/day_df.csv\")\nday_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"DAY_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n\n","user":"hduser","dateUpdated":"2018-12-05T08:34:59-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 219.967544079 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346570_-610567750","id":"20181203-144708_1428444325","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#month_df.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/month_df.csv\")\nmonth_df.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"MONTH_DF\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n\n","user":"hduser","dateUpdated":"2018-12-05T08:35:03-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 25.9684779644 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346571_520275148","id":"20181203-114303_1496777404","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\n#tariff_val.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/tariff_val.csv\")\ntariff_val.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"TARIFF_VAL\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n\n","user":"hduser","dateUpdated":"2018-12-05T08:35:06-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.662875890732 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346572_-2106173359","id":"20181203-114304_70803731","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%pyspark\n\n\nstartTimeQuery = time.time()\n#meters_db.write.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").save(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/london/etl/meters_db.csv\")\nmeters_db.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"METERS_DB\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nmes_et(startTimeQuery)\n","user":"hduser","dateUpdated":"2018-12-05T08:35:11-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 160.859843016 seconds\n"}]},"apps":[],"jobName":"paragraph_1544020346573_117109533","id":"20181203-114306_515330514","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2018-12-05T08:32:26-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544020346575_1200335360","id":"20181203-110233_1516419300","dateCreated":"2018-12-05T08:32:26-0600","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:67"}],"name":"JSGP/london/test2","id":"2DWHKM7FC","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
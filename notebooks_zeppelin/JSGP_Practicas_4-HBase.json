{"paragraphs":[{"text":"%pyspark\n#Crea dataframes con los datos de los archivos CSV que deben estar en el HDFS\nfrom pyspark.sql.types import StructType\nfrom pyspark.sql.types import StructField\nfrom pyspark.sql.types import *\n\nmoviesDF=spark.read.csv(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/movies.csv\", header=True, schema = StructType([\n                        StructField('movieId', IntegerType(), True),\n                        StructField('title', StringType(), True),\n                        StructField('genres', StringType(), True)]))\n                        \nratingsDF=spark.read.csv(\"hdfs://big0.iie.org.mx:9000/JSGP/datasets/ratings.csv\", header=True, schema = StructType([\n                        StructField('userId', IntegerType(), True),\n                        StructField('movieId', IntegerType(), True),\n                        StructField('rating', DoubleType(), True),\n                        StructField('utime', LongType(), True)]))\n","user":"hduser","dateUpdated":"2018-10-25T16:32:23-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533570822907_1869312451","id":"20180720-143957_125375375","dateCreated":"2018-08-06T10:53:42-0500","dateStarted":"2018-10-25T16:32:23-0500","dateFinished":"2018-10-25T16:33:14-0500","status":"ABORT","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:29"},{"text":"%pyspark\n\nmoviesDF.select(moviesDF.movieId, moviesDF.title, moviesDF.genres).orderBy(\"title\", ascending=False).show(n=30)\nratingsDF.show()\n","user":"hduser","dateUpdated":"2018-10-25T16:33:15-0500","config":{"enabled":true,"editorMode":"ace/mode/python","results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9,"colWidth":12},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533570822909_1867003958","id":"20180720-144329_1004634227","dateCreated":"2018-08-06T10:53:42-0500","dateStarted":"2018-10-25T16:33:15-0500","dateFinished":"2018-10-25T16:33:19-0500","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:30"},{"user":"hduser","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540404046345_-592559719","id":"20181024-130046_1802920666","dateCreated":"2018-10-24T13:00:46-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:31"},{"text":"%pyspark\n# Llenar la tabla HBase con los datos del dataframe\n#Primero se debe crear la tabla en HBase con las siguientes instrucciones:\n#CREATE TABLE MOVIES (movieId INTEGER NOT NULL PRIMARY KEY, title VARCHAR, genres VARCHAR);\n#CREATE TABLE RATINGS (userId INTEGER NOT NULL, movieId INTEGER NOT NULL, rating DOUBLE, utime UNSIGNED_LONG, CONSTRAINT pk PRIMARY KEY (userId, movieId));\n\nmoviesDF.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"MOVIES\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()\nratingsDF.write.format(\"org.apache.phoenix.spark\").mode(\"overwrite\").option(\"table\", \"RATINGS\").option(\"zkUrl\", \"jdbc:phoenix:10.0.111.102\").save()","user":"hduser","dateUpdated":"2018-08-10T10:28:57-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1533841655107_1406669242","id":"20180809-140735_274492929","dateCreated":"2018-08-09T14:07:35-0500","dateStarted":"2018-08-10T10:28:57-0500","dateFinished":"2018-08-10T10:31:53-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32"},{"text":"","user":"hduser","dateUpdated":"2018-08-10T10:28:11-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533844932141_1594855185","id":"20180809-150212_1700571904","dateCreated":"2018-08-09T15:02:12-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:33"}],"name":"JSGP/Practicas/4-HBase","id":"2DKCHS1M5","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
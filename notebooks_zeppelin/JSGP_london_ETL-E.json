{"paragraphs":[{"text":"%md\n# **ETL - EXTRACTION**\n\nThis notebook is extracting all data stored in a databse lying in HDFS\nTo upload a file into HDFS from linux command line:\n\n1. Create a HDFS directory\n`$ hadoop fs -mkdir <designed-HDFS-directory-route>` \n\n2. Copy from linux to HDFS\n`$ hadoop dfs -copyFromLocal <route-to-linux-sourcefile-or-directory> <route-to-HDFS-destination-file-or-directory>`\n\n3. Generated dataframes:\n    - uk_hd: holidays according to uk bank\n    - acorn_cats: acorn categories and their population percentage. More information available at [CACI ACORN webpage](https://www.caci.co.uk/products/product/acorn)\n    - acorn_groups: acorn groups and their categories\n    - information_households: information about household's meter and file location\n    - weather_daily_darksky: weather information for each day\n    - weather_hourly_darksky: weather information for each hour\n    - half_block_dataset/block_0-111: household's consumption each half hour (time series)\n    - hhblock_dataset/block_0-111: household's consumption each half hour (hour matrix)\n    - tariff: tafirff matrix per user each half hour","user":"hduser","dateUpdated":"2019-01-30T14:13:31-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1><strong>ETL - EXTRACTION</strong></h1>\n<p>This notebook is extracting all data stored in a databse lying in HDFS<br/>To upload a file into HDFS from linux command line:</p>\n<ol>\n  <li>\n  <p>Create a HDFS directory<br/><code>$ hadoop fs -mkdir &lt;designed-HDFS-directory-route&gt;</code></p></li>\n  <li>\n  <p>Copy from linux to HDFS<br/><code>$ hadoop dfs -copyFromLocal &lt;route-to-linux-sourcefile-or-directory&gt; &lt;route-to-HDFS-destination-file-or-directory&gt;</code></p></li>\n  <li>\n    <p>Generated dataframes:</p>\n    <ul>\n      <li>uk_hd: holidays according to uk bank</li>\n      <li>acorn_cats: acorn categories and their population percentage. More information available at <a href=\"https://www.caci.co.uk/products/product/acorn\">CACI ACORN webpage</a></li>\n      <li>acorn_groups: acorn groups and their categories</li>\n      <li>information_households: information about household&rsquo;s meter and file location</li>\n      <li>weather_daily_darksky: weather information for each day</li>\n      <li>weather_hourly_darksky: weather information for each hour</li>\n      <li>half_block_dataset/block_0-111: household&rsquo;s consumption each half hour (time series)</li>\n      <li>hhblock_dataset/block_0-111: household&rsquo;s consumption each half hour (hour matrix)</li>\n      <li>tariff: tafirff matrix per user each half hour</li>\n    </ul>\n  </li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1541620689868_-1237611440","id":"20181107-135809_84367222","dateCreated":"2018-11-07T13:58:09-0600","dateStarted":"2019-01-30T14:13:31-0600","dateFinished":"2019-01-30T14:13:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:55"},{"text":"%md\n## Imports and Basic Functions\n\nImports all needed libraries. Some pre-defined variables and functions are:\n\n1. dir_in: Directory where database is located\n2. server: Hadoop server ip direction and port\n3. mes_et: Function to measure any cell execution elapsed time\n4. test: How many of 112 blocks you need to dismiss for tests. Test=0 means you consider all 112 blocks in data processing","user":"hduser","dateUpdated":"2019-01-30T14:13:33-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Imports and Basic Functions</h2>\n<p>Imports all needed libraries. Some pre-defined variables and functions are:</p>\n<ol>\n  <li>dir_in: Directory where database is located</li>\n  <li>server: Hadoop server ip direction and port</li>\n  <li>mes_et: Function to measure any cell execution elapsed time</li>\n  <li>test: How many of 112 blocks you need to dismiss for tests. Test=0 means you consider all 112 blocks in data processing</li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1543423829876_-1472133595","id":"20181128-105029_606759694","dateCreated":"2018-11-28T10:50:29-0600","dateStarted":"2019-01-30T14:13:33-0600","dateFinished":"2019-01-30T14:13:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\nfrom pyspark.sql.types import *\nimport subprocess\nimport time\ngbl = globals()\n\n\ndir_in = \"/JSGP/datasets/london/\"\nserver=\"hdfs://big0.iie.org.mx:9000/\"\ntest=0\n\n# Measure Elapsed time\ndef mes_et(startTimeQuery):\n    endTimeQuery = time.time()\n    runTimeQuery = endTimeQuery - startTimeQuery\n    print(\"ELAPSED TIME: \"+str(runTimeQuery)+\" seconds\")\n    ","user":"hduser","dateUpdated":"2019-01-30T14:13:33-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1541619462209_-158189786","id":"20181025-135053_1999611944","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:13:33-0600","dateFinished":"2019-01-30T14:13:44-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%md\n### uk_hd dataframe\nExtracts a list of London holidays, accordint to UK Bank.\n\n- HD_DATE: Holiday Date\n- HD_NAME: Holiday Name","user":"hduser","dateUpdated":"2019-01-30T14:13:45-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>uk_hd dataframe</h3>\n<p>Extracts a list of London holidays, accordint to UK Bank.</p>\n<ul>\n  <li>HD_DATE: Holiday Date</li>\n  <li>HD_NAME: Holiday Name</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1543424074715_1983605751","id":"20181128-105434_267011851","dateCreated":"2018-11-28T10:54:34-0600","dateStarted":"2019-01-30T14:13:45-0600","dateFinished":"2019-01-30T14:13:45-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"uk_bank_holidays.csv\"\nsubdir=\"\"\n\nuk_hd=spark.read.csv(server+dir_in+subdir+file, header=True, schema = 'HD_DATE string, HD_NAME string')\nuk_hd.collect()\nmes_et(startTimeQuery)\n\"\"\"            \nfor older Spark Versions:\nuk_hd=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('HD_DATE', StringType(), True),\n                        StructField('HD_NAME', StringType(), True)]))\n\"\"\"\nuk_hd.show(30)","user":"hduser","dateUpdated":"2019-01-30T14:13:45-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 14.3885500431 seconds\n+----------+--------------------+\n|   HD_DATE|             HD_NAME|\n+----------+--------------------+\n|26/12/2014|          Boxing Day|\n|25/12/2014|       Christmas Day|\n|25/08/2014| Summer bank holiday|\n|26/05/2014| Spring bank holiday|\n|05/05/2014|Early May bank ho...|\n|21/04/2014|       Easter Monday|\n|18/04/2014|         Good Friday|\n|01/01/2014|      New Year�s Day|\n|26/12/2013|          Boxing Day|\n|25/12/2013|       Christmas Day|\n|26/08/2013| Summer bank holiday|\n|27/05/2013| Spring bank holiday|\n|06/05/2013|Early May bank ho...|\n|01/04/2013|       Easter Monday|\n|29/03/2013|         Good Friday|\n|01/01/2013|      New Year�s Day|\n|26/12/2012|          Boxing Day|\n|25/12/2012|       Christmas Day|\n|27/08/2012| Summer bank holiday|\n|05/06/2012|Queen�s Diamond J...|\n|04/06/2012|Spring bank holid...|\n|07/05/2012|Early May bank ho...|\n|09/04/2012|       Easter Monday|\n|06/04/2012|         Good Friday|\n|02/01/2012|New Year�s Day (s...|\n+----------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1541619462212_-1522613946","id":"20181107-133346_1458365935","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:13:45-0600","dateFinished":"2019-01-30T14:14:02-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%md\n### acorn_cats dataframe\nA list with Households' ACORN categories and the % of population for each one.\n\n- ACORN_CAT: Category number (0-5)\n- ACORN_CAT_NAME: Category name\n- CAT_POPULATION: % of households classified under each category\n\nMore information about households ACORN categories in [ACORN household User Guide](http://www.caci.co.uk/sites/default/files/resources/Household_Acorn_UG.pdf)","user":"hduser","dateUpdated":"2019-01-30T14:14:02-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>acorn_cats dataframe</h3>\n<p>A list with Households&rsquo; ACORN categories and the % of population for each one.</p>\n<ul>\n  <li>ACORN_CAT: Category number (0-5)</li>\n  <li>ACORN_CAT_NAME: Category name</li>\n  <li>CAT_POPULATION: % of households classified under each category</li>\n</ul>\n<p>More information about households ACORN categories in <a href=\"http://www.caci.co.uk/sites/default/files/resources/Household_Acorn_UG.pdf\">ACORN household User Guide</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1543612054407_-367010237","id":"20181130-150734_483541854","dateCreated":"2018-11-30T15:07:34-0600","dateStarted":"2019-01-30T14:14:02-0600","dateFinished":"2019-01-30T14:14:02-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"acorn_hh_categories.csv\"\nsubdir=\"\"\nacorn_cats=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('ACORN_CAT', IntegerType(), True),\n                        StructField('ACORN_CAT_NAME', StringType(), True),\n                        StructField('CAT_POPULATION', DoubleType(), True)]))   \nacorn_cats.collect()\nmes_et(startTimeQuery)\nacorn_cats.show() ","user":"hduser","dateUpdated":"2019-01-30T14:14:02-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.354666948318 seconds\n+---------+--------------------+--------------+\n|ACORN_CAT|      ACORN_CAT_NAME|CAT_POPULATION|\n+---------+--------------------+--------------+\n|        1|  Affluent Achievers|   0.216169398|\n|        2|   Rising Prosperity|   0.097081371|\n|        3|Comfortable Comun...|   0.267579841|\n|        4|Financially Stret...|   0.231608437|\n|        5|     Urban Adversity|   0.185077406|\n|        0|               Other|   0.002483547|\n+---------+--------------------+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1543612066540_1761904634","id":"20181130-150746_1606666774","dateCreated":"2018-11-30T15:07:46-0600","dateStarted":"2019-01-30T14:14:02-0600","dateFinished":"2019-01-30T14:14:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%md\n### acorn_groups dataframe\nA list with Households' ACORN groups and the category for each one.\n\n- ACORN_CAT: Category number (0-5)\n- ACORN_GROUP: ACORN Group (A to Q)\n- ACORN_CAT_NAME: Category name\n\nMore information about households ACORN categories in [ACORN household User Guide](http://www.caci.co.uk/sites/default/files/resources/Household_Acorn_UG.pdf)","user":"hduser","dateUpdated":"2019-01-30T14:14:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>acorn_groups dataframe</h3>\n<p>A list with Households&rsquo; ACORN groups and the category for each one.</p>\n<ul>\n  <li>ACORN_CAT: Category number (0-5)</li>\n  <li>ACORN_GROUP: ACORN Group (A to Q)</li>\n  <li>ACORN_CAT_NAME: Category name</li>\n</ul>\n<p>More information about households ACORN categories in <a href=\"http://www.caci.co.uk/sites/default/files/resources/Household_Acorn_UG.pdf\">ACORN household User Guide</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1543433154136_-259114501","id":"20181128-132554_1115404716","dateCreated":"2018-11-28T13:25:54-0600","dateStarted":"2019-01-30T14:14:15-0600","dateFinished":"2019-01-30T14:14:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"acorn_hh_groups.csv\"\nsubdir=\"\"\nacorn_groups=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('ACORN_CAT', IntegerType(), True),\n                        StructField('ACORN_GROUP', StringType(), True),\n                        StructField('ACORN_CAT_NAME', StringType(), True)]))   \nacorn_groups.collect()\nmes_et(startTimeQuery)\nacorn_groups.show()  ","user":"hduser","dateUpdated":"2019-01-30T14:14:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.161152839661 seconds\n+---------+-----------+--------------------+\n|ACORN_CAT|ACORN_GROUP|      ACORN_CAT_NAME|\n+---------+-----------+--------------------+\n|        0|     ACORN-|               Other|\n|        1|    ACORN-A|  Affluent Achievers|\n|        1|    ACORN-B|  Affluent Achievers|\n|        1|    ACORN-C|  Affluent Achievers|\n|        2|    ACORN-D|   Rising Prosperity|\n|        2|    ACORN-E|   Rising Prosperity|\n|        3|    ACORN-F|Comfortable Comun...|\n|        3|    ACORN-G|Comfortable Comun...|\n|        3|    ACORN-H|Comfortable Comun...|\n|        3|    ACORN-I|Comfortable Comun...|\n|        3|    ACORN-J|Comfortable Comun...|\n|        4|    ACORN-K|Financially Stret...|\n|        4|    ACORN-L|Financially Stret...|\n|        4|    ACORN-M|Financially Stret...|\n|        4|    ACORN-N|Financially Stret...|\n|        5|    ACORN-O|     Urban Adversity|\n|        5|    ACORN-P|     Urban Adversity|\n|        5|    ACORN-Q|     Urban Adversity|\n+---------+-----------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1543432169093_-1816437028","id":"20181128-130929_879004947","dateCreated":"2018-11-28T13:09:29-0600","dateStarted":"2019-01-30T14:14:15-0600","dateFinished":"2019-01-30T14:14:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%md\n### information_households dataframe\n\nInformation about each client (meter) ACORN classification\n\n- METER_ID: Meter ID for each client\n- STD_TOU: Indicates weather a client is participating in Standard or TimeOfUse tariff\n- ACORN_GROUP: Household group\n- ACORN_GROUP_NANME: Household group name\n- FILE: block file where information about client is located\n","user":"hduser","dateUpdated":"2019-01-30T14:14:18-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>information_households dataframe</h3>\n<p>Information about each client (meter) ACORN classification</p>\n<ul>\n  <li>METER_ID: Meter ID for each client</li>\n  <li>STD_TOU: Indicates weather a client is participating in Standard or TimeOfUse tariff</li>\n  <li>ACORN_GROUP: Household group</li>\n  <li>ACORN_GROUP_NANME: Household group name</li>\n  <li>FILE: block file where information about client is located</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1543425992555_1877194396","id":"20181128-112632_1248648912","dateCreated":"2018-11-28T11:26:32-0600","dateStarted":"2019-01-30T14:14:18-0600","dateFinished":"2019-01-30T14:14:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"informations_households.csv\"\nsubdir=\"\"\ninformation_households=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('METER_ID', StringType(), True),\n                        StructField('STD_TOU', StringType(), True),\n                        StructField('ACORN_GROUP', StringType(), True),\n                        StructField('ACORN_GROUP_NAME', StringType(), True),\n                        StructField('FILE', StringType(), True)]))  \ninformation_households.collect()\nmes_et(startTimeQuery)\ninformation_households.show(5)                        ","user":"hduser","dateUpdated":"2019-01-30T14:14:18-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.305782794952 seconds\n+---------+-------+-----------+----------------+-------+\n| METER_ID|STD_TOU|ACORN_GROUP|ACORN_GROUP_NAME|   FILE|\n+---------+-------+-----------+----------------+-------+\n|MAC005492|    ToU|     ACORN-|          ACORN-|block_0|\n|MAC001074|    ToU|     ACORN-|          ACORN-|block_0|\n|MAC000002|    Std|    ACORN-A|        Affluent|block_0|\n|MAC003613|    Std|    ACORN-A|        Affluent|block_0|\n|MAC003597|    Std|    ACORN-A|        Affluent|block_0|\n+---------+-------+-----------+----------------+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541619462217_1958897389","id":"20181107-133427_257021912","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:14:18-0600","dateFinished":"2019-01-30T14:14:19-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%md\n### weather_daily_darksky dataframe\n\nWeather information for each day. Details for each column available at [Dark Sky API](https://darksky.net/dev/docs#response-format)\n","user":"hduser","dateUpdated":"2019-01-30T14:14:19-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>weather_daily_darksky dataframe</h3>\n<p>Weather information for each day. Details for each column available at <a href=\"https://darksky.net/dev/docs#response-format\">Dark Sky API</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1543426444708_-1091806319","id":"20181128-113404_380933627","dateCreated":"2018-11-28T11:34:04-0600","dateStarted":"2019-01-30T14:14:19-0600","dateFinished":"2019-01-30T14:14:19-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"weather_daily_darksky.csv\"\nsubdir=\"\"\nweather_daily_darksky=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('TEMP_MAX', DoubleType(), True),\n                        StructField('TEMP_MAX_TIME', StringType(), True),\n                        StructField('WIND_BEARING', IntegerType(), True),\n                        StructField('ICON', StringType(), True),\n                        StructField('DEWPOINT', DoubleType(), True),\n                        StructField('TEMP_MIN_TIME', StringType(), True),\n                        StructField('CLOUD_COVER', DoubleType(), True),\n                        StructField('WIND_SPEED', DoubleType(), True),\n                        StructField('PRESSURE', DoubleType(), True),\n                        StructField('APAR_TEMP_MIN_TIME', StringType(), True),\n                        StructField('APAR_TEMP_HI', DoubleType(), True),\n                        StructField('PRECIP_TYPE', StringType(), True),\n                        StructField('VISIBILITY', DoubleType(), True),\n                        StructField('HUMIDITY', DoubleType(), True),\n                        StructField('APAR_TEMP_HI_TIME', StringType(), True),\n                        StructField('APAR_TEMP_LO', DoubleType(), True),\n                        StructField('APAR_TEMP_MAX', DoubleType(), True),\n                        StructField('UV_INDEX', StringType(), True),\n                        StructField('TIME', StringType(), True),\n                        StructField('SUNSET_TIME', StringType(), True),\n                        StructField('TEMP_LO', DoubleType(), True),\n                        StructField('TEMP_MIN', DoubleType(), True),\n                        StructField('TEMP_HI', DoubleType(), True),\n                        StructField('SUNRISE_TIME', StringType(), True),\n                        StructField('TEMP_HI_TIME', StringType(), True),\n                        StructField('UV_INDEX_TIME', StringType(), True),\n                        StructField('SUMMARY', StringType(), True),\n                        StructField('TEMP_LO_TIME', StringType(), True),\n                        StructField('APAR_TEMP_MIN', DoubleType(), True),\n                        StructField('APAR_TEMP_MAX_TIME', StringType(), True),\n                        StructField('APAR_TEMP_LO_TIME', StringType(), True),\n                        StructField('MOONPHASE', DoubleType(), True)]))\nweather_daily_darksky.collect()\nmes_et(startTimeQuery)\nweather_daily_darksky.show(5)                        \n","user":"hduser","dateUpdated":"2019-01-30T14:14:19-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 3.32285714149 seconds\n+--------+-------------------+------------+-------------------+--------+-------------------+-----------+----------+--------+-------------------+------------+-----------+----------+--------+-------------------+------------+-------------+--------+-------------------+-------------------+-------+--------+-------+-------------------+-------------------+-------------------+--------------------+-------------------+-------------+-------------------+-------------------+---------+\n|TEMP_MAX|      TEMP_MAX_TIME|WIND_BEARING|               ICON|DEWPOINT|      TEMP_MIN_TIME|CLOUD_COVER|WIND_SPEED|PRESSURE| APAR_TEMP_MIN_TIME|APAR_TEMP_HI|PRECIP_TYPE|VISIBILITY|HUMIDITY|  APAR_TEMP_HI_TIME|APAR_TEMP_LO|APAR_TEMP_MAX|UV_INDEX|               TIME|        SUNSET_TIME|TEMP_LO|TEMP_MIN|TEMP_HI|       SUNRISE_TIME|       TEMP_HI_TIME|      UV_INDEX_TIME|             SUMMARY|       TEMP_LO_TIME|APAR_TEMP_MIN| APAR_TEMP_MAX_TIME|  APAR_TEMP_LO_TIME|MOONPHASE|\n+--------+-------------------+------------+-------------------+--------+-------------------+-----------+----------+--------+-------------------+------------+-----------+----------+--------+-------------------+------------+-------------+--------+-------------------+-------------------+-------+--------+-------+-------------------+-------------------+-------------------+--------------------+-------------------+-------------+-------------------+-------------------+---------+\n|   11.96|2011-11-11 23:00:00|         123|                fog|     9.4|2011-11-11 07:00:00|       0.79|      3.88| 1016.08|2011-11-11 07:00:00|       10.87|       rain|       3.3|    0.95|2011-11-11 19:00:00|       10.87|        11.96|     1.0|2011-11-11 00:00:00|2011-11-11 16:19:21|  10.87|    8.85|  10.87|2011-11-11 07:12:14|2011-11-11 19:00:00|2011-11-11 11:00:00|Foggy until after...|2011-11-11 19:00:00|         6.48|2011-11-11 23:00:00|2011-11-11 19:00:00|     0.52|\n|    8.59|2011-12-11 14:00:00|         198|  partly-cloudy-day|    4.49|2011-12-11 01:00:00|       0.56|      3.94| 1007.71|2011-12-11 02:00:00|        5.62|       rain|     12.09|    0.88|2011-12-11 19:00:00|       -0.64|         5.72|     1.0|2011-12-11 00:00:00|2011-12-11 15:52:53|   3.09|    2.48|   8.59|2011-12-11 07:57:02|2011-12-11 14:00:00|2011-12-11 12:00:00|Partly cloudy thr...|2011-12-12 07:00:00|         0.11|2011-12-11 20:00:00|2011-12-12 08:00:00|     0.53|\n|   10.33|2011-12-27 02:00:00|         225|  partly-cloudy-day|    5.47|2011-12-27 23:00:00|       0.85|      3.54| 1032.76|2011-12-27 22:00:00|       10.33|       rain|     13.39|    0.74|2011-12-27 14:00:00|        5.52|        10.33|     0.0|2011-12-27 00:00:00|2011-12-27 15:57:56|   8.03|    8.03|  10.33|2011-12-27 08:07:06|2011-12-27 14:00:00|2011-12-27 00:00:00|Mostly cloudy thr...|2011-12-27 23:00:00|         5.59|2011-12-27 02:00:00|2011-12-28 00:00:00|      0.1|\n|    8.07|2011-12-02 23:00:00|         232|               wind|    3.69|2011-12-02 07:00:00|       0.32|       3.0| 1012.12|2011-12-02 07:00:00|        5.33|       rain|     11.89|    0.87|2011-12-02 12:00:00|        3.26|         5.33|     1.0|2011-12-02 00:00:00|2011-12-02 15:56:17|   6.33|    2.56|   7.36|2011-12-02 07:46:09|2011-12-02 12:00:00|2011-12-02 10:00:00|Partly cloudy thr...|2011-12-02 19:00:00|         0.46|2011-12-02 12:00:00|2011-12-02 19:00:00|     0.25|\n|    8.22|2011-12-24 23:00:00|         252|partly-cloudy-night|    2.79|2011-12-24 07:00:00|       0.37|      4.46| 1028.17|2011-12-24 07:00:00|        5.02|       rain|     13.16|     0.8|2011-12-24 15:00:00|        4.37|         5.32|     1.0|2011-12-24 00:00:00|2011-12-24 15:55:55|   7.45|    3.17|   7.93|2011-12-24 08:06:15|2011-12-24 15:00:00|2011-12-24 13:00:00|Mostly cloudy thr...|2011-12-24 19:00:00|        -0.51|2011-12-24 23:00:00|2011-12-24 20:00:00|     0.99|\n+--------+-------------------+------------+-------------------+--------+-------------------+-----------+----------+--------+-------------------+------------+-----------+----------+--------+-------------------+------------+-------------+--------+-------------------+-------------------+-------+--------+-------+-------------------+-------------------+-------------------+--------------------+-------------------+-------------+-------------------+-------------------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541619462219_-1368204292","id":"20181105-162311_1635293860","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:14:19-0600","dateFinished":"2019-01-30T14:14:26-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%md\n### weather_hourly_darksky dataframe\n\nInformation about weather for each hour of a day. Details for each column available at [Dark Sky API](https://darksky.net/dev/docs#response-format)","user":"hduser","dateUpdated":"2019-01-30T14:14:26-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>weather_hourly_darksky dataframe</h3>\n<p>Information about weather for each hour of a day. Details for each column available at <a href=\"https://darksky.net/dev/docs#response-format\">Dark Sky API</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1543426529095_343497787","id":"20181128-113529_1190932437","dateCreated":"2018-11-28T11:35:29-0600","dateStarted":"2019-01-30T14:14:26-0600","dateFinished":"2019-01-30T14:14:26-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%pyspark\nstartTimeQuery = time.time()\nfile=\"weather_hourly_darksky.csv\"\nsubdir=\"\"\nweather_hourly_darksky=spark.read.csv(server+dir_in+subdir+file, header=True, schema = StructType([\n                        StructField('VISIBILITY', DoubleType(), True),\n                        StructField('WIND_BEARING', IntegerType(), True),\n                        StructField('TEMPERATURE', DoubleType(), True),\n                        StructField('TIME', StringType(), True),\n                        StructField('DEWPOINT', DoubleType(), True),\n                        StructField('PRESSURE', DoubleType(), True),\n                        StructField('APAR_TEMP', DoubleType(), True),\n                        StructField('WIND_SPEED', DoubleType(), True),\n                        StructField('PRECIP_TYPE', StringType(), True),\n                        StructField('ICON', StringType(), True),\n                        StructField('HUMIDITY', DoubleType(), True),\n                        StructField('SUMMARY', StringType(), True)])) \n\nweather_hourly_darksky.collect()\nmes_et(startTimeQuery)\nweather_hourly_darksky.show(5)","user":"hduser","dateUpdated":"2019-01-30T14:14:26-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 3.26521801949 seconds\n+----------+------------+-----------+-------------------+--------+--------+---------+----------+-----------+-------------------+--------+-------------+\n|VISIBILITY|WIND_BEARING|TEMPERATURE|               TIME|DEWPOINT|PRESSURE|APAR_TEMP|WIND_SPEED|PRECIP_TYPE|               ICON|HUMIDITY|      SUMMARY|\n+----------+------------+-----------+-------------------+--------+--------+---------+----------+-----------+-------------------+--------+-------------+\n|      5.97|         104|      10.24|2011-11-11 00:00:00|    8.86| 1016.76|    10.24|      2.77|       rain|partly-cloudy-night|    0.91|Partly Cloudy|\n|      4.88|          99|       9.76|2011-11-11 01:00:00|    8.83| 1016.63|     8.24|      2.95|       rain|partly-cloudy-night|    0.94|Partly Cloudy|\n|       3.7|          98|       9.46|2011-11-11 02:00:00|    8.79| 1016.36|     7.76|      3.17|       rain|partly-cloudy-night|    0.96|Partly Cloudy|\n|      3.12|          99|       9.23|2011-11-11 03:00:00|    8.63| 1016.28|     7.44|      3.25|       rain|                fog|    0.96|        Foggy|\n|      1.85|         111|       9.26|2011-11-11 04:00:00|    9.21| 1015.98|     7.24|       3.7|       rain|                fog|     1.0|        Foggy|\n+----------+------------+-----------+-------------------+--------+--------+---------+----------+-----------+-------------------+--------+-------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541619462223_1946064336","id":"20181107-083814_273178083","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:14:26-0600","dateFinished":"2019-01-30T14:14:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%md\n### half_block (0-111) dataframes\n\nInformation about energy consumption for each client, each half hour.\n\n- METER_ID:  Meter ID for each client\n- TIMESTAMP: Measurement date and time\n- ENERGY: Total energy consumptiion for each day","user":"hduser","dateUpdated":"2019-01-30T14:14:30-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>half_block (0-111) dataframes</h3>\n<p>Information about energy consumption for each client, each half hour.</p>\n<ul>\n  <li>METER_ID: Meter ID for each client</li>\n  <li>TIMESTAMP: Measurement date and time</li>\n  <li>ENERGY: Total energy consumptiion for each day</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1544561621511_-709122683","id":"20181211-145341_1556870693","dateCreated":"2018-12-11T14:53:41-0600","dateStarted":"2019-01-30T14:14:30-0600","dateFinished":"2019-01-30T14:14:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%pyspark\n\nstartTimeQuery = time.time()\nsubdir=\"halfhourly_dataset/\"\nargs = \"hdfs dfs -ls \"+dir_in+subdir+\" | awk '{print $8}'\"\nproc = subprocess.Popen(args, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)\ns_output, s_err = proc.communicate()\nblock_list = s_output.split()\n\n#iterate through all files in directory to generate a dataframe for each file \nfor i in range(len(block_list)):\n    block=\"block_\"+`i`\n    block_name=\"half_\"+block\n    block_path=server+dir_in+subdir+block+\".csv\"\n    df=spark.read.csv(block_path, header=True, schema = StructType([\n                        StructField('METER_ID', StringType(), True),\n                        StructField('TIMESTAMP', StringType(), True),\n                        StructField('ENERGY', DoubleType(), True)])) \n    gbl[block_name]= df\n    \nmes_et(startTimeQuery)\nhalf_block_111.show(5)","user":"hduser","dateUpdated":"2019-01-30T14:14:30-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 2.14020299911 seconds\n+---------+--------------------+------+\n| METER_ID|           TIMESTAMP|ENERGY|\n+---------+--------------------+------+\n|MAC000023|2011-12-07 10:30:...|  0.54|\n|MAC000023|2011-12-07 11:00:...| 0.863|\n|MAC000023|2011-12-07 11:30:...| 0.475|\n|MAC000023|2011-12-07 12:00:...| 0.495|\n|MAC000023|2011-12-07 12:30:...| 0.341|\n+---------+--------------------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1544561673248_1514292425","id":"20181211-145433_960393859","dateCreated":"2018-12-11T14:54:33-0600","dateStarted":"2019-01-30T14:14:30-0600","dateFinished":"2019-01-30T14:14:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%md\n### hh_block (0-111) dataframes\n\nInformation about energy consumption for each client, each half hour.\n\n- METER_ID:  Meter ID for each client\n- DATE: Measurement date\n- HH_X: Energy measurement for each 30 minutes. From HH_0 = 00:00 to HH_47=23:30","user":"hduser","dateUpdated":"2019-01-30T14:14:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>hh_block (0-111) dataframes</h3>\n<p>Information about energy consumption for each client, each half hour.</p>\n<ul>\n  <li>METER_ID: Meter ID for each client</li>\n  <li>DATE: Measurement date</li>\n  <li>HH_X: Energy measurement for each 30 minutes. From HH_0 = 00:00 to HH_47=23:30</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1543427020953_1012625572","id":"20181128-114340_564504965","dateCreated":"2018-11-28T11:43:40-0600","dateStarted":"2019-01-30T14:14:32-0600","dateFinished":"2019-01-30T14:14:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"text":"%pyspark\nstartTimeQuery = time.time()\nsubdir=\"hhblock_dataset/\"\nargs = \"hdfs dfs -ls \"+dir_in+subdir+\" | awk '{print $8}'\"\nproc = subprocess.Popen(args, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)\ns_output, s_err = proc.communicate()\nblock_list = s_output.split()\n\n#iterate through all files in directory to generate a dataframe for each file \nfor i in range(len(block_list)):\n    block=\"block_\"+`i`\n    block_name=\"hh_\"+block\n    block_path=server+dir_in+subdir+block+\".csv\"\n    hh_block=spark.read.csv(block_path, header=True, schema = StructType([\n                        StructField('METER_ID', StringType(), True),\n                        StructField('DATE', StringType(), True),\n                        StructField('HH0', DoubleType(), True),\n                        StructField('HH1', DoubleType(), True),\n                        StructField('HH2', DoubleType(), True),\n                        StructField('HH3', DoubleType(), True),\n                        StructField('HH4', DoubleType(), True),\n                        StructField('HH5', DoubleType(), True),\n                        StructField('HH6', DoubleType(), True),\n                        StructField('HH7', DoubleType(), True),\n                        StructField('HH8', DoubleType(), True),\n                        StructField('HH9', DoubleType(), True),\n                        StructField('HH10', DoubleType(), True),\n                        StructField('HH11', DoubleType(), True),\n                        StructField('HH12', DoubleType(), True),\n                        StructField('HH13', DoubleType(), True),\n                        StructField('HH14', DoubleType(), True),\n                        StructField('HH15', DoubleType(), True),\n                        StructField('HH16', DoubleType(), True),\n                        StructField('HH17', DoubleType(), True),\n                        StructField('HH18', DoubleType(), True),\n                        StructField('HH19', DoubleType(), True),\n                        StructField('HH20', DoubleType(), True),\n                        StructField('HH21', DoubleType(), True),\n                        StructField('HH22', DoubleType(), True),\n                        StructField('HH23', DoubleType(), True),\n                        StructField('HH24', DoubleType(), True),\n                        StructField('HH25', DoubleType(), True),\n                        StructField('HH26', DoubleType(), True),\n                        StructField('HH27', DoubleType(), True),\n                        StructField('HH28', DoubleType(), True),\n                        StructField('HH29', DoubleType(), True),\n                        StructField('HH30', DoubleType(), True),\n                        StructField('HH31', DoubleType(), True),\n                        StructField('HH32', DoubleType(), True),\n                        StructField('HH33', DoubleType(), True),\n                        StructField('HH34', DoubleType(), True),\n                        StructField('HH35', DoubleType(), True),\n                        StructField('HH36', DoubleType(), True),\n                        StructField('HH37', DoubleType(), True),\n                        StructField('HH38', DoubleType(), True),\n                        StructField('HH39', DoubleType(), True),\n                        StructField('HH40', DoubleType(), True),\n                        StructField('HH41', DoubleType(), True),\n                        StructField('HH42', DoubleType(), True),\n                        StructField('HH43', DoubleType(), True),\n                        StructField('HH44', DoubleType(), True),\n                        StructField('HH45', DoubleType(), True),\n                        StructField('HH46', DoubleType(), True),\n                        StructField('HH47', DoubleType(), True)])) \n    gbl[block_name]= hh_block\n\nmes_et(startTimeQuery)\nhh_block_110.show(5)","user":"hduser","dateUpdated":"2019-01-30T14:14:32-0600","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 2.30333614349 seconds\n+---------+----------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+-----+-------------------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+-------------------+------------------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+---------+------------------+------------------+-----+------------------+---------+---------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+\n| METER_ID|      DATE|                HH0|                HH1|                HH2|                HH3|                HH4|  HH5|  HH6|                HH7|                HH8|                HH9| HH10|               HH11|               HH12|               HH13|               HH14|              HH15|              HH16|              HH17|               HH18|               HH19|               HH20|               HH21|               HH22|               HH23|              HH24|               HH25|               HH26|               HH27|               HH28|               HH29|               HH30|               HH31|               HH32|               HH33| HH34|     HH35|              HH36|              HH37| HH38|              HH39|     HH40|     HH41|               HH42|               HH43| HH44|               HH45|               HH46|               HH47|\n+---------+----------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+-----+-------------------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+-------------------+------------------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+---------+------------------+------------------+-----+------------------+---------+---------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+\n|MAC000031|2011-12-08|0.17800000000000002|              0.183|              0.187|              0.185|              0.195|0.187|0.196|0.18600000000000003|              0.183|0.19899999999999998|0.196|              0.195|0.17800000000000002|              0.162|              0.157|              0.79|0.7120000000000001|             1.089|              0.433|               0.84|0.12300000000000001|              0.134|              0.139|              0.249|              0.22|0.20199999999999999|              0.265|              0.213|              0.195|0.19899999999999998|              0.138|              0.145|               0.28|              0.331|0.185|    0.611|         1.3890001|             1.013|0.865|             0.545|    0.649|    0.626|              0.596|              0.513|0.503|              0.531|               0.44|              0.154|\n|MAC000031|2011-12-09|              0.155|              0.231|              0.212|              0.225|              0.195|0.179|0.171|               0.17|0.16699999999999998|0.16399999999999998|0.162|0.14300000000000002|              0.141|              0.147|0.14800000000000002|              0.75|              1.27|             1.159|0.32899999999999996|               0.14|              0.136|0.11199999999999999|0.11800000000000001|0.14300000000000002|             0.154|               0.12|              0.092|0.10400000000000001|               0.19|              0.171|               0.17|               0.15|0.20600000000000002|          1.1210001|1.551|    1.091|0.7909999999999999|             0.736|0.775|0.7979999999999999|2.3469999|1.5190001| 1.6369999999999998|              0.541|0.877|              0.564|              0.865|              0.158|\n|MAC000031|2011-12-10|0.17800000000000002|0.17800000000000002|0.16899999999999998|               0.17|              0.175| 0.18|0.244|0.21899999999999997|              0.221|              0.157|0.136|0.14300000000000002|              0.177|0.27399999999999997|0.47100000000000003|             0.494|               0.6|             0.513|              0.977|0.35600000000000004|              0.354|              0.405|              0.177|              1.311|             1.092|              0.747|0.28300000000000003|              0.177|              0.132|              0.131|              0.155|               0.22|              1.288|              1.765| 1.95|    0.862|             0.722|              0.62|0.649|0.7390000000000001|    0.775|    0.912| 1.4569999999999999|              0.976|1.079|              0.415|              0.177|0.18600000000000003|\n|MAC000031|2011-12-11|              0.182|              0.183|0.18100000000000002|              0.166|0.18100000000000002| 0.18|0.175|              0.152|              0.138|              0.174|0.218|              0.201|0.17300000000000001|              0.157|              0.155|             0.155|             0.155|             0.204|              0.882| 0.5539999999999999|              0.523| 1.6980000000000002|              1.114|              1.484|2.5989999999999998|               1.54|               1.27|              1.666|               1.37|              0.816|              0.527|0.17300000000000001|0.18100000000000002|0.17600000000000002|0.214|    1.857|1.9340000000000002|1.3419999999999999|0.986|         1.8329999|2.0309999|    1.965|              1.239| 1.4669999999999999|0.733|               0.73|               0.66|0.49200000000000005|\n|MAC000031|2011-12-12|              0.166|0.17600000000000002|               0.17|0.17300000000000001|              0.174| 0.17|0.161|              0.165|              0.174|               0.17|0.141|               0.14|              0.172|0.14400000000000002|0.20600000000000002|0.8240000000000001|             1.368|0.8029999999999999| 1.2990000000000002|              1.199|              0.695|              0.852|0.21899999999999997|              0.192|             0.193|0.23399999999999999|              0.361|              0.221|0.18600000000000003|0.17600000000000002|0.27399999999999997|0.18100000000000002|0.23399999999999999|              1.112|1.385|1.3380001|1.5130000000000001|             1.867|0.599|             0.643|    0.794|    1.089|0.18100000000000002|0.19699999999999998|0.426|0.45299999999999996|0.47200000000000003|0.45899999999999996|\n+---------+----------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+-----+-------------------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+-------------------+------------------+------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-------------------+-----+---------+------------------+------------------+-----+------------------+---------+---------+-------------------+-------------------+-----+-------------------+-------------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1541619462231_-963371944","id":"20181107-130448_655374845","dateCreated":"2018-11-07T13:37:42-0600","dateStarted":"2019-01-30T14:14:32-0600","dateFinished":"2019-01-30T14:14:35-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%md\n### tariff dataframe\n\nInformation about tariff for ToU users. Tariff codes are:\n\n- 0: Normal tariff, 11.76 p/kWh\n- 1: High tariff, 67.20 p/kWh\n- 2: Low tariff, 3.99 p/kWh\n\nColumns are:\n\n- Date: Tariff date\n- HHX: tariff code for each half hour","user":"hduser","dateUpdated":"2019-01-30T14:14:35-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>tariff dataframe</h3>\n<p>Information about tariff for ToU users. Tariff codes are:</p>\n<ul>\n  <li>0: Normal tariff, 11.76 p/kWh</li>\n  <li>1: High tariff, 67.20 p/kWh</li>\n  <li>2: Low tariff, 3.99 p/kWh</li>\n</ul>\n<p>Columns are:</p>\n<ul>\n  <li>Date: Tariff date</li>\n  <li>HHX: tariff code for each half hour</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1543507617986_2032045952","id":"20181129-100657_311041600","dateCreated":"2018-11-29T10:06:57-0600","dateStarted":"2019-01-30T14:14:35-0600","dateFinished":"2019-01-30T14:14:35-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"text":"%pyspark\nstartTimeQuery = time.time()\n\nfile=\"tariff_matrix.csv\"\nsubdir=\"\"\ntariff = spark.read.csv(server+dir_in+subdir+file,header=True)\ntariff=tariff.toDF(*hh_block.columns[1::])\ntariff.collect()\nmes_et(startTimeQuery)\ntariff.printSchema()","user":"hduser","dateUpdated":"2019-01-30T14:14:35-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.760398864746 seconds\nroot\n |-- DATE: string (nullable = true)\n |-- HH0: string (nullable = true)\n |-- HH1: string (nullable = true)\n |-- HH2: string (nullable = true)\n |-- HH3: string (nullable = true)\n |-- HH4: string (nullable = true)\n |-- HH5: string (nullable = true)\n |-- HH6: string (nullable = true)\n |-- HH7: string (nullable = true)\n |-- HH8: string (nullable = true)\n |-- HH9: string (nullable = true)\n |-- HH10: string (nullable = true)\n |-- HH11: string (nullable = true)\n |-- HH12: string (nullable = true)\n |-- HH13: string (nullable = true)\n |-- HH14: string (nullable = true)\n |-- HH15: string (nullable = true)\n |-- HH16: string (nullable = true)\n |-- HH17: string (nullable = true)\n |-- HH18: string (nullable = true)\n |-- HH19: string (nullable = true)\n |-- HH20: string (nullable = true)\n |-- HH21: string (nullable = true)\n |-- HH22: string (nullable = true)\n |-- HH23: string (nullable = true)\n |-- HH24: string (nullable = true)\n |-- HH25: string (nullable = true)\n |-- HH26: string (nullable = true)\n |-- HH27: string (nullable = true)\n |-- HH28: string (nullable = true)\n |-- HH29: string (nullable = true)\n |-- HH30: string (nullable = true)\n |-- HH31: string (nullable = true)\n |-- HH32: string (nullable = true)\n |-- HH33: string (nullable = true)\n |-- HH34: string (nullable = true)\n |-- HH35: string (nullable = true)\n |-- HH36: string (nullable = true)\n |-- HH37: string (nullable = true)\n |-- HH38: string (nullable = true)\n |-- HH39: string (nullable = true)\n |-- HH40: string (nullable = true)\n |-- HH41: string (nullable = true)\n |-- HH42: string (nullable = true)\n |-- HH43: string (nullable = true)\n |-- HH44: string (nullable = true)\n |-- HH45: string (nullable = true)\n |-- HH46: string (nullable = true)\n |-- HH47: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1542912640308_514862728","id":"20181122-125040_985738079","dateCreated":"2018-11-22T12:50:40-0600","dateStarted":"2019-01-30T14:14:35-0600","dateFinished":"2019-01-30T14:14:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%md\n### tariff timeseries dataframe\n\nInformation about tariff for ToU users. Tariff codes are:\n\n- Normal tariff, 11.76 p/kWh\n- High tariff, 67.20 p/kWh\n- Low tariff, 3.99 p/kWh\n\nColumns are:\n\n- Date: Tariff date\n- Tarif: tariff code for each half hour\n","user":"hduser","dateUpdated":"2019-01-30T14:14:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>tariff timeseries dataframe</h3>\n<p>Information about tariff for ToU users. Tariff codes are:</p>\n<ul>\n  <li>Normal tariff, 11.76 p/kWh</li>\n  <li>High tariff, 67.20 p/kWh</li>\n  <li>Low tariff, 3.99 p/kWh</li>\n</ul>\n<p>Columns are:</p>\n<ul>\n  <li>Date: Tariff date</li>\n  <li>Tarif: tariff code for each half hour</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1543609735415_-1464415517","id":"20181130-142855_1326033857","dateCreated":"2018-11-30T14:28:55-0600","dateStarted":"2019-01-30T14:14:36-0600","dateFinished":"2019-01-30T14:14:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"%pyspark\nstartTimeQuery = time.time()\n\nfile=\"tariff_ts.csv\"\nsubdir=\"\"\ntariff_ts = spark.read.csv(server+dir_in+subdir+file,header=True)\nmes_et(startTimeQuery)\ntariff_ts.show(2)\ntariff_ts.printSchema()","user":"hduser","dateUpdated":"2019-01-30T14:14:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ELAPSED TIME: 0.112038850784 seconds\n+----------------+------+\n|  TariffDateTime|Tariff|\n+----------------+------+\n|01/01/2013 00:00|Normal|\n|01/01/2013 00:30|Normal|\n+----------------+------+\nonly showing top 2 rows\n\nroot\n |-- TariffDateTime: string (nullable = true)\n |-- Tariff: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1544567040714_-87717616","id":"20181211-162400_1542027768","dateCreated":"2018-12-11T16:24:00-0600","dateStarted":"2019-01-30T14:14:36-0600","dateFinished":"2019-01-30T14:14:48-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%pyspark\n","user":"hduser","dateUpdated":"2019-01-30T14:14:48-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544567052096_1834509638","id":"20181211-162412_1923203036","dateCreated":"2018-12-11T16:24:12-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:78"}],"name":"JSGP/london/ETL-E","id":"2DUXFQPGZ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}